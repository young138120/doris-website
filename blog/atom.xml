<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://doris.apache.org/blog</id>
    <title>Apache Doris Blog</title>
    <updated>2024-12-02T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://doris.apache.org/blog"/>
    <subtitle>Apache Doris Blog</subtitle>
    <icon>https://doris.apache.org/images/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Apache Doris 3.0.3 just released]]></title>
        <id>https://doris.apache.org/blog/release-note-3.0.3</id>
        <link href="https://doris.apache.org/blog/release-note-3.0.3"/>
        <updated>2024-12-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Dear community members, the Apache Doris 3.0.3 version was officially released on December 02, 2024, this version further enhances the performance and stability of the system.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Release Notes</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Apache Doris 3.0.3 just released</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-12-02T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">December 2, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Dear community members, the Apache Doris 3.0.3 version was officially released on December 02, 2024, this version further enhances the performance and stability of the system.</p>
<p><strong>Quick Download:</strong> <a href="https://doris.apache.org/download/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/download/</a></p>
<p><strong>GitHub Release:</strong> <a href="https://github.com/apache/doris/releases" target="_blank" rel="noopener noreferrer">https://github.com/apache/doris/releases</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="behavioral-changes">Behavioral Changes<a href="https://doris.apache.org/blog/release-note-3.0.3#behavioral-changes" class="hash-link" aria-label="Direct link to Behavioral Changes" title="Direct link to Behavioral Changes">&#x200B;</a></h2>
<ul>
<li>Prohibited column updates on MOW tables with synchronous materialized views. <a href="https://github.com/apache/doris/pull/40190" target="_blank" rel="noopener noreferrer">#40190</a></li>
<li>Adjusted the default parameters of RoutineLoad to improve import efficiency. <a href="https://github.com/apache/doris/pull/42968" target="_blank" rel="noopener noreferrer">#42968</a></li>
<li>When StreamLoad fails, the return value of LoadedRows is adjusted to 0. <a href="https://github.com/apache/doris/pull/41946" target="_blank" rel="noopener noreferrer">#41946</a> <a href="https://github.com/apache/doris/pull/42291" target="_blank" rel="noopener noreferrer">#42291</a></li>
<li>Adjusted the default memory limit of Segment cache to 5%. <a href="https://github.com/apache/doris/pull/42308" target="_blank" rel="noopener noreferrer">#42308</a> <a href="https://github.com/apache/doris/pull/42436" target="_blank" rel="noopener noreferrer">#42436</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-features">New Features<a href="https://doris.apache.org/blog/release-note-3.0.3#new-features" class="hash-link" aria-label="Direct link to New Features" title="Direct link to New Features">&#x200B;</a></h2>
<ul>
<li>
<p>Introduced the session variable <code>enable_cooldown_replica_affinity</code> to control the affinity of cold and hot tiered replicas. <a href="https://github.com/apache/doris/pull/42677" target="_blank" rel="noopener noreferrer">#42677</a></p>
</li>
<li>
<p>Added <code>table$partition</code> syntax for querying partition information of Hive tables. <a href="https://github.com/apache/doris/pull/40774" target="_blank" rel="noopener noreferrer">#40774</a></p>
<ul>
<li><a href="https://doris.apache.org/docs/3.0/lakehouse/datalake-analytics/hive" target="_blank" rel="noopener noreferrer">View Documentation</a></li>
</ul>
</li>
<li>
<p>Supported creation of Hive tables in Text format. <a href="https://github.com/apache/doris/pull/41860" target="_blank" rel="noopener noreferrer">#41860</a> <a href="https://github.com/apache/doris/pull/42175" target="_blank" rel="noopener noreferrer">#42175</a></p>
<ul>
<li><a href="https://doris.apache.org/zh-CN/docs/3.0/lakehouse/datalake-building/hive-build#table" target="_blank" rel="noopener noreferrer">View Documentation</a></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-materialized-views">Asynchronous Materialized Views<a href="https://doris.apache.org/blog/release-note-3.0.3#asynchronous-materialized-views" class="hash-link" aria-label="Direct link to Asynchronous Materialized Views" title="Direct link to Asynchronous Materialized Views">&#x200B;</a></h3>
<ul>
<li>Introduced new materialized view attribute <code>use_for_rewrite</code>. When <code>use_for_rewrite</code> is set to false, the materialized view does not participate in transparent rewriting. <a href="https://github.com/apache/doris/pull/40332" target="_blank" rel="noopener noreferrer">#40332</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer">Query Optimizer<a href="https://doris.apache.org/blog/release-note-3.0.3#query-optimizer" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>Supported correlated non-aggregate subqueries. <a href="https://github.com/apache/doris/pull/42236" target="_blank" rel="noopener noreferrer">#42236</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution">Query Execution<a href="https://doris.apache.org/blog/release-note-3.0.3#query-execution" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>Added functions <code>ngram_search</code>, <code>normal_cdf</code>, <code>to_iso8601</code>, <code>from_iso8601_date</code>, <code>SESSION_USER()</code>, <code>last_query_id</code>. <a href="https://github.com/apache/doris/pull/38226" target="_blank" rel="noopener noreferrer">#38226</a> <a href="https://github.com/apache/doris/pull/40695" target="_blank" rel="noopener noreferrer">#40695</a> <a href="https://github.com/apache/doris/pull/41075" target="_blank" rel="noopener noreferrer">#41075</a> <a href="https://github.com/apache/doris/pull/41600" target="_blank" rel="noopener noreferrer">#41600</a> <a href="https://github.com/apache/doris/pull/39575" target="_blank" rel="noopener noreferrer">#39575</a> <a href="https://github.com/apache/doris/pull/40739" target="_blank" rel="noopener noreferrer">#40739</a></li>
<li>The <code>aes_encrypt</code> and <code>aes_decrypt</code> functions support GCM mode. <a href="https://github.com/apache/doris/pull/40004" target="_blank" rel="noopener noreferrer">#40004</a></li>
<li>Profile outputs the changed session variable values. <a href="https://github.com/apache/doris/pull/41016" target="_blank" rel="noopener noreferrer">#41016</a> <a href="https://github.com/apache/doris/pull/41318" target="_blank" rel="noopener noreferrer">#41318</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semi-structured-data-management">Semi-structured Data Management<a href="https://doris.apache.org/blog/release-note-3.0.3#semi-structured-data-management" class="hash-link" aria-label="Direct link to Semi-structured Data Management" title="Direct link to Semi-structured Data Management">&#x200B;</a></h3>
<ul>
<li>Added array functions <code>array_match_all</code> and <code>array_match_any</code>. <a href="https://github.com/apache/doris/pull/40605" target="_blank" rel="noopener noreferrer">#40605</a> <a href="https://github.com/apache/doris/pull/43514" target="_blank" rel="noopener noreferrer">#43514</a></li>
<li>The array function <code>array_agg</code> supports nesting ARRAY/MAP/STRUCT within ARRAY. <a href="https://github.com/apache/doris/pull/42009" target="_blank" rel="noopener noreferrer">#42009</a></li>
<li>Added approximate aggregate statistical functions <code>approx_top_k</code> and <code>approx_top_sum</code>. <a href="https://github.com/apache/doris/pull/44082" target="_blank" rel="noopener noreferrer">#44082</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="https://doris.apache.org/blog/release-note-3.0.3#improvements" class="hash-link" aria-label="Direct link to Improvements" title="Direct link to Improvements">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage">Storage<a href="https://doris.apache.org/blog/release-note-3.0.3#storage" class="hash-link" aria-label="Direct link to Storage" title="Direct link to Storage">&#x200B;</a></h3>
<ul>
<li>Supported <code>bitmap_empty</code> as the default value. <a href="https://github.com/apache/doris/pull/40364" target="_blank" rel="noopener noreferrer">#40364</a></li>
<li>Introduced the session variable <code>insert_timeout</code> to control the timeout of DELETE statements. <a href="https://github.com/apache/doris/pull/41063" target="_blank" rel="noopener noreferrer">#41063</a></li>
<li>Improved some error message prompts. <a href="https://github.com/apache/doris/pull/41048" target="_blank" rel="noopener noreferrer">#41048</a> <a href="https://github.com/apache/doris/pull/39631" target="_blank" rel="noopener noreferrer">#39631</a></li>
<li>Improved the priority scheduling of replica repair. <a href="https://github.com/apache/doris/pull/41076" target="_blank" rel="noopener noreferrer">#41076</a></li>
<li>Enhanced the robustness of timezone handling when creating tables. <a href="https://github.com/apache/doris/pull/41926" target="_blank" rel="noopener noreferrer">#41926</a> <a href="https://github.com/apache/doris/pull/42389" target="_blank" rel="noopener noreferrer">#42389</a></li>
<li>Checked the validity of partition expressions when creating tables. <a href="https://github.com/apache/doris/pull/40158" target="_blank" rel="noopener noreferrer">#40158</a></li>
<li>Supported Unicode-encoded column names in DELETE operations. <a href="https://github.com/apache/doris/pull/39381" target="_blank" rel="noopener noreferrer">#39381</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compute-storage-decoupled">Compute-Storage Decoupled<a href="https://doris.apache.org/blog/release-note-3.0.3#compute-storage-decoupled" class="hash-link" aria-label="Direct link to Compute-Storage Decoupled" title="Direct link to Compute-Storage Decoupled">&#x200B;</a></h3>
<ul>
<li>Supported ARM architecture deployment in storage and compute separation mode. <a href="https://github.com/apache/doris/pull/42467" target="_blank" rel="noopener noreferrer">#42467</a> <a href="https://github.com/apache/doris/pull/43377" target="_blank" rel="noopener noreferrer">#43377</a></li>
<li>Optimized the eviction strategy and lock competition of file cache, improving hit rate and high concurrency point query performance. <a href="https://github.com/apache/doris/pull/42451" target="_blank" rel="noopener noreferrer">#42451</a> <a href="https://github.com/apache/doris/pull/43201" target="_blank" rel="noopener noreferrer">#43201</a> <a href="https://github.com/apache/doris/pull/41818" target="_blank" rel="noopener noreferrer">#41818</a> <a href="https://github.com/apache/doris/pull/43401" target="_blank" rel="noopener noreferrer">#43401</a></li>
<li>S3 storage vault supported <code>use_path_style</code>, solving the problem of using custom domain names for object storage. <a href="https://github.com/apache/doris/pull/43060" target="_blank" rel="noopener noreferrer">#43060</a> <a href="https://github.com/apache/doris/pull/43343" target="_blank" rel="noopener noreferrer">#43343</a> <a href="https://github.com/apache/doris/pull/43330" target="_blank" rel="noopener noreferrer">#43330</a></li>
<li>Optimized storage and compute separation configuration and deployment, preventing misoperations in different modes. <a href="https://github.com/apache/doris/pull/43381" target="_blank" rel="noopener noreferrer">#43381</a> <a href="https://github.com/apache/doris/pull/43522" target="_blank" rel="noopener noreferrer">#43522</a> <a href="https://github.com/apache/doris/pull/43434" target="_blank" rel="noopener noreferrer">#43434</a> <a href="https://github.com/apache/doris/pull/40764" target="_blank" rel="noopener noreferrer">#40764</a> <a href="https://github.com/apache/doris/pull/43891" target="_blank" rel="noopener noreferrer">#43891</a></li>
<li>Optimized observability and provided an interface for deleting specified segment file cache. <a href="https://github.com/apache/doris/pull/38489" target="_blank" rel="noopener noreferrer">#38489</a> <a href="https://github.com/apache/doris/pull/42896" target="_blank" rel="noopener noreferrer">#42896</a> <a href="https://github.com/apache/doris/pull/41037" target="_blank" rel="noopener noreferrer">#41037</a> <a href="https://github.com/apache/doris/pull/43412" target="_blank" rel="noopener noreferrer">#43412</a></li>
<li>Optimized Meta-service operation and maintenance interface: RPC rate limiting and tablet metadata correction. <a href="https://github.com/apache/doris/pull/42413" target="_blank" rel="noopener noreferrer">#42413</a> <a href="https://github.com/apache/doris/pull/43884" target="_blank" rel="noopener noreferrer">#43884</a> <a href="https://github.com/apache/doris/pull/41782" target="_blank" rel="noopener noreferrer">#41782</a> <a href="https://github.com/apache/doris/pull/43460" target="_blank" rel="noopener noreferrer">#43460</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse">Lakehouse<a href="https://doris.apache.org/blog/release-note-3.0.3#lakehouse" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>
<p>Paimon Catalog supported Alibaba Cloud DLF and OSS-HDFS storage. <a href="https://github.com/apache/doris/pull/41247" target="_blank" rel="noopener noreferrer">#41247</a> <a href="https://github.com/apache/doris/pull/42585" target="_blank" rel="noopener noreferrer">#42585</a></p>
<ul>
<li>View <a href="https://doris.apache.org/docs/3.0/lakehouse/datalake-analytics/paimon" target="_blank" rel="noopener noreferrer">Documentation</a></li>
</ul>
</li>
<li>
<p>Supported reading of Hive tables in OpenCSV format. <a href="https://github.com/apache/doris/pull/42257" target="_blank" rel="noopener noreferrer">#42257</a> <a href="https://github.com/apache/doris/pull/42942" target="_blank" rel="noopener noreferrer">#42942</a></p>
</li>
<li>
<p>Optimized the performance of accessing the <code>information_schema.columns</code> table in External Catalog. <a href="https://github.com/apache/doris/pull/41659" target="_blank" rel="noopener noreferrer">#41659</a> <a href="https://github.com/apache/doris/pull/41962" target="_blank" rel="noopener noreferrer">#41962</a></p>
</li>
<li>
<p>Used the new Max Compute open storage API to access Max Compute data sources. <a href="https://github.com/apache/doris/pull/41614" target="_blank" rel="noopener noreferrer">#41614</a></p>
</li>
<li>
<p>Optimized the scheduling policy of the JNI part of Paimon tables, making scan tasks more balanced. <a href="https://github.com/apache/doris/pull/43310" target="_blank" rel="noopener noreferrer">#43310</a></p>
</li>
<li>
<p>Optimized the read performance of small ORC files. <a href="https://github.com/apache/doris/pull/42004" target="_blank" rel="noopener noreferrer">#42004</a> <a href="https://github.com/apache/doris/pull/43467" target="_blank" rel="noopener noreferrer">#43467</a></p>
</li>
<li>
<p>Supported reading of parquet files in brotli compressed format. <a href="https://github.com/apache/doris/pull/42177" target="_blank" rel="noopener noreferrer">#42177</a></p>
</li>
<li>
<p>Added <code>file_cache_statistics</code> table under the <code>information_schema</code> library to view metadata cache statistics. <a href="https://github.com/apache/doris/pull/42160" target="_blank" rel="noopener noreferrer">#42160</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer-1">Query Optimizer<a href="https://doris.apache.org/blog/release-note-3.0.3#query-optimizer-1" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>Optimization: When queries only differ in comments, the same SQL Cache can be reused. <a href="https://github.com/apache/doris/pull/40049" target="_blank" rel="noopener noreferrer">#40049</a></li>
<li>Optimization: Improved the stability of statistical information when data is frequently updated. <a href="https://github.com/apache/doris/pull/43865" target="_blank" rel="noopener noreferrer">#43865</a> <a href="https://github.com/apache/doris/pull/39788" target="_blank" rel="noopener noreferrer">#39788</a> <a href="https://github.com/apache/doris/pull/43009" target="_blank" rel="noopener noreferrer">#43009</a> <a href="https://github.com/apache/doris/pull/40457" target="_blank" rel="noopener noreferrer">#40457</a> <a href="https://github.com/apache/doris/pull/42409" target="_blank" rel="noopener noreferrer">#42409</a> <a href="https://github.com/apache/doris/pull/41894" target="_blank" rel="noopener noreferrer">#41894</a></li>
<li>Optimization: Enhanced the stability of constant folding. <a href="https://github.com/apache/doris/pull/42910" target="_blank" rel="noopener noreferrer">#42910</a> <a href="https://github.com/apache/doris/pull/41164" target="_blank" rel="noopener noreferrer">#41164</a> <a href="https://github.com/apache/doris/pull/39723" target="_blank" rel="noopener noreferrer">#39723</a> <a href="https://github.com/apache/doris/pull/41394" target="_blank" rel="noopener noreferrer">#41394</a> <a href="https://github.com/apache/doris/pull/42256" target="_blank" rel="noopener noreferrer">#42256</a> <a href="https://github.com/apache/doris/pull/40441" target="_blank" rel="noopener noreferrer">#40441</a></li>
<li>Optimization: Column pruning can generate better execution plans. <a href="https://github.com/apache/doris/pull/41719" target="_blank" rel="noopener noreferrer">#41719</a> <a href="https://github.com/apache/doris/pull/41548" target="_blank" rel="noopener noreferrer">#41548</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution-1">Query Execution<a href="https://doris.apache.org/blog/release-note-3.0.3#query-execution-1" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>Optimized the memory usage of the sort operator. <a href="https://github.com/apache/doris/pull/39306" target="_blank" rel="noopener noreferrer">#39306</a></li>
<li>Optimized the performance of computations on ARM. <a href="https://github.com/apache/doris/pull/38888" target="_blank" rel="noopener noreferrer">#38888</a> <a href="https://github.com/apache/doris/pull/38759" target="_blank" rel="noopener noreferrer">#38759</a></li>
<li>Optimized the computational performance of a series of functions. <a href="https://github.com/apache/doris/pull/40366" target="_blank" rel="noopener noreferrer">#40366</a> <a href="https://github.com/apache/doris/pull/40821" target="_blank" rel="noopener noreferrer">#40821</a> <a href="https://github.com/apache/doris/pull/40670" target="_blank" rel="noopener noreferrer">#40670</a> <a href="https://github.com/apache/doris/pull/41206" target="_blank" rel="noopener noreferrer">#41206</a> <a href="https://github.com/apache/doris/pull/40162" target="_blank" rel="noopener noreferrer">#40162</a></li>
<li>Used SSE instructions to optimize the performance of the <code>match_ipv6_subnet</code> function. <a href="https://github.com/apache/doris/pull/38755" target="_blank" rel="noopener noreferrer">#38755</a></li>
<li>Supported automatic creation of new partitions during insert overwrite. <a href="https://github.com/apache/doris/pull/38628" target="_blank" rel="noopener noreferrer">#38628</a> <a href="https://github.com/apache/doris/pull/42645" target="_blank" rel="noopener noreferrer">#42645</a></li>
<li>Added the status of each PipelineTask in Profile. <a href="https://github.com/apache/doris/pull/42981" target="_blank" rel="noopener noreferrer">#42981</a></li>
<li>IP type supported runtime filter. <a href="https://github.com/apache/doris/pull/39985" target="_blank" rel="noopener noreferrer">#39985</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semi-structured-data-management-1">Semi-structured Data Management<a href="https://doris.apache.org/blog/release-note-3.0.3#semi-structured-data-management-1" class="hash-link" aria-label="Direct link to Semi-structured Data Management" title="Direct link to Semi-structured Data Management">&#x200B;</a></h3>
<ul>
<li>Output the real SQL of prepared statements in audit logs. <a href="https://github.com/apache/doris/pull/43321" target="_blank" rel="noopener noreferrer">#43321</a></li>
<li>The filebeat doris output plugin supports fault tolerance and progress reporting. <a href="https://github.com/apache/doris/pull/36355" target="_blank" rel="noopener noreferrer">#36355</a></li>
<li>Optimized the performance of inverted index queries. <a href="https://github.com/apache/doris/pull/41547" target="_blank" rel="noopener noreferrer">#41547</a> <a href="https://github.com/apache/doris/pull/41585" target="_blank" rel="noopener noreferrer">#41585</a> <a href="https://github.com/apache/doris/pull/41567" target="_blank" rel="noopener noreferrer">#41567</a> <a href="https://github.com/apache/doris/pull/41577" target="_blank" rel="noopener noreferrer">#41577</a> <a href="https://github.com/apache/doris/pull/42060" target="_blank" rel="noopener noreferrer">#42060</a> <a href="https://github.com/apache/doris/pull/42372" target="_blank" rel="noopener noreferrer">#42372</a></li>
<li>The array function <code>array overlaps</code> supports acceleration using inverted indexes. <a href="https://github.com/apache/doris/pull/41571" target="_blank" rel="noopener noreferrer">#41571</a></li>
<li>The IP function <code>is_ip_address_in_range</code> supports acceleration using inverted indexes. <a href="https://github.com/apache/doris/pull/41571" target="_blank" rel="noopener noreferrer">#41571</a></li>
<li>Optimized the CAST performance of the VARIANT data type. <a href="https://github.com/apache/doris/pull/41775" target="_blank" rel="noopener noreferrer">#41775</a> <a href="https://github.com/apache/doris/pull/42438" target="_blank" rel="noopener noreferrer">#42438</a> <a href="https://github.com/apache/doris/pull/43320" target="_blank" rel="noopener noreferrer">#43320</a></li>
<li>Optimized the CPU resource consumption of the Variant data type. <a href="https://github.com/apache/doris/pull/42856" target="_blank" rel="noopener noreferrer">#42856</a> <a href="https://github.com/apache/doris/pull/43062" target="_blank" rel="noopener noreferrer">#43062</a> <a href="https://github.com/apache/doris/pull/43634" target="_blank" rel="noopener noreferrer">#43634</a></li>
<li>Optimized the metadata and execution memory resource consumption of the Variant data type. <a href="https://github.com/apache/doris/pull/42448" target="_blank" rel="noopener noreferrer">#42448</a> <a href="https://github.com/apache/doris/pull/43326" target="_blank" rel="noopener noreferrer">#43326</a> <a href="https://github.com/apache/doris/pull/41482" target="_blank" rel="noopener noreferrer">#41482</a> <a href="https://github.com/apache/doris/pull/43093" target="_blank" rel="noopener noreferrer">#43093</a> <a href="https://github.com/apache/doris/pull/43567" target="_blank" rel="noopener noreferrer">#43567</a> <a href="https://github.com/apache/doris/pull/43620" target="_blank" rel="noopener noreferrer">#43620</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="permissions">Permissions<a href="https://doris.apache.org/blog/release-note-3.0.3#permissions" class="hash-link" aria-label="Direct link to Permissions" title="Direct link to Permissions">&#x200B;</a></h3>
<ul>
<li>Added a new configuration item <code>ldap_group_filter</code> in LDAP for custom group filtering. <a href="https://github.com/apache/doris/pull/43292" target="_blank" rel="noopener noreferrer">#43292</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other">Other<a href="https://doris.apache.org/blog/release-note-3.0.3#other" class="hash-link" aria-label="Direct link to Other" title="Direct link to Other">&#x200B;</a></h3>
<ul>
<li>Supported displaying connection count information by user in FE monitoring items. <a href="https://github.com/apache/doris/pull/39200" target="_blank" rel="noopener noreferrer">#39200</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug Fixes<a href="https://doris.apache.org/blog/release-note-3.0.3#bug-fixes" class="hash-link" aria-label="Direct link to Bug Fixes" title="Direct link to Bug Fixes">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-1">Storage<a href="https://doris.apache.org/blog/release-note-3.0.3#storage-1" class="hash-link" aria-label="Direct link to Storage" title="Direct link to Storage">&#x200B;</a></h3>
<ul>
<li>Fixed the issue with using IPv6 hostnames. <a href="https://github.com/apache/doris/pull/40074" target="_blank" rel="noopener noreferrer">#40074</a></li>
<li>Fixed the inaccurate display of broker/s3 load progress. <a href="https://github.com/apache/doris/pull/43535" target="_blank" rel="noopener noreferrer">#43535</a></li>
<li>Fixed the issue where queries might hang from FE. <a href="https://github.com/apache/doris/pull/41303" target="_blank" rel="noopener noreferrer">#41303</a> <a href="https://github.com/apache/doris/pull/42382" target="_blank" rel="noopener noreferrer">#42382</a></li>
<li>Fixed the issue of duplicate auto-increment IDs under exceptional circumstances. <a href="https://github.com/apache/doris/pull/43774" target="_blank" rel="noopener noreferrer">#43774</a>  <a href="https://github.com/apache/doris/pull/43983" target="_blank" rel="noopener noreferrer">#43983</a></li>
<li>Fixed occasional NPE issues with groupcommit. <a href="https://github.com/apache/doris/pull/43635" target="_blank" rel="noopener noreferrer">#43635</a></li>
<li>Fixed the inaccurate calculation of auto bucket. <a href="https://github.com/apache/doris/pull/41675" target="_blank" rel="noopener noreferrer">#41675</a> <a href="https://github.com/apache/doris/pull/41835" target="_blank" rel="noopener noreferrer">#41835</a></li>
<li>Fixed the issue where FE might not correctly plan multi-table flows after restart. <a href="https://github.com/apache/doris/pull/41677" target="_blank" rel="noopener noreferrer">#41677</a> <a href="https://github.com/apache/doris/pull/42290" target="_blank" rel="noopener noreferrer">#42290</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compute-storage-decoupled-1">Compute-Storage Decoupled<a href="https://doris.apache.org/blog/release-note-3.0.3#compute-storage-decoupled-1" class="hash-link" aria-label="Direct link to Compute-Storage Decoupled" title="Direct link to Compute-Storage Decoupled">&#x200B;</a></h3>
<ul>
<li>Fixed the issue that MOW primary key tables with large delete bitmaps might cause coredump. <a href="https://github.com/apache/doris/pull/43088" target="_blank" rel="noopener noreferrer">#43088</a> <a href="https://github.com/apache/doris/pull/43457" target="_blank" rel="noopener noreferrer">#43457</a> <a href="https://github.com/apache/doris/pull/43479" target="_blank" rel="noopener noreferrer">#43479</a> <a href="https://github.com/apache/doris/pull/43407" target="_blank" rel="noopener noreferrer">#43407</a> <a href="https://github.com/apache/doris/pull/43297" target="_blank" rel="noopener noreferrer">#43297</a> <a href="https://github.com/apache/doris/pull/43613" target="_blank" rel="noopener noreferrer">#43613</a> <a href="https://github.com/apache/doris/pull/43615" target="_blank" rel="noopener noreferrer">#43615</a> <a href="https://github.com/apache/doris/pull/43854" target="_blank" rel="noopener noreferrer">#43854</a> <a href="https://github.com/apache/doris/pull/43968" target="_blank" rel="noopener noreferrer">#43968</a> <a href="https://github.com/apache/doris/pull/44074" target="_blank" rel="noopener noreferrer">#44074</a> <a href="https://github.com/apache/doris/pull/41793" target="_blank" rel="noopener noreferrer">#41793</a> <a href="https://github.com/apache/doris/pull/42142" target="_blank" rel="noopener noreferrer">#42142</a></li>
<li>Fixed the issue that segment files, when being a multiple of 5MB, would fail to upload objects. <a href="https://github.com/apache/doris/pull/43254" target="_blank" rel="noopener noreferrer">#43254</a></li>
<li>Fixed the issue that the default retry policy of aws sdk did not take effect. <a href="https://github.com/apache/doris/pull/43575" target="_blank" rel="noopener noreferrer">#43575</a> <a href="https://github.com/apache/doris/pull/43648" target="_blank" rel="noopener noreferrer">#43648</a></li>
<li>Fixed the issue that altering storage vault could continue execution even when the wrong type was specified. <a href="https://github.com/apache/doris/pull/43489" target="_blank" rel="noopener noreferrer">#43489</a> <a href="https://github.com/apache/doris/pull/43352" target="_blank" rel="noopener noreferrer">#43352</a> <a href="https://github.com/apache/doris/pull/43495" target="_blank" rel="noopener noreferrer">#43495</a></li>
<li>Fixed the issue that tablet_id might be 0 during the delayed commit process of large transactions. <a href="https://github.com/apache/doris/pull/42043" target="_blank" rel="noopener noreferrer">#42043</a> <a href="https://github.com/apache/doris/pull/42905" target="_blank" rel="noopener noreferrer">#42905</a></li>
<li>Fixed the issue that constant folding RCP and FE forwarding SQL might not be executed in the expected computation group. <a href="https://github.com/apache/doris/pull/43110" target="_blank" rel="noopener noreferrer">#43110</a> <a href="https://github.com/apache/doris/pull/41819" target="_blank" rel="noopener noreferrer">#41819</a> <a href="https://github.com/apache/doris/pull/41846" target="_blank" rel="noopener noreferrer">#41846</a></li>
<li>Fixed the issue that meta-service did not strictly check instance_id upon receiving RPC. <a href="https://github.com/apache/doris/pull/43253" target="_blank" rel="noopener noreferrer">#43253</a> <a href="https://github.com/apache/doris/pull/43832" target="_blank" rel="noopener noreferrer">#43832</a></li>
<li>Fixed the issue that FE follower information_schema version did not update in time. <a href="https://github.com/apache/doris/pull/43496" target="_blank" rel="noopener noreferrer">#43496</a></li>
<li>Fixed the issue of atomicity in file cache rename and inaccurate metrics. <a href="https://github.com/apache/doris/pull/42869" target="_blank" rel="noopener noreferrer">#42869</a> <a href="https://github.com/apache/doris/pull/43504" target="_blank" rel="noopener noreferrer">#43504</a> <a href="https://github.com/apache/doris/pull/43220" target="_blank" rel="noopener noreferrer">#43220</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse-1">Lakehouse<a href="https://doris.apache.org/blog/release-note-3.0.3#lakehouse-1" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>Prohibited implicit conversion predicates from being pushed down to JDBC data sources to avoid inconsistent query results. <a href="https://github.com/apache/doris/pull/42102" target="_blank" rel="noopener noreferrer">#42102</a></li>
<li>Fixed some read issues with high-version Hive transactional tables. <a href="https://github.com/apache/doris/pull/42226" target="_blank" rel="noopener noreferrer">#42226</a></li>
<li>Fixed the issue that the Export command might cause deadlocks. <a href="https://github.com/apache/doris/pull/43083" target="_blank" rel="noopener noreferrer">#43083</a> <a href="https://github.com/apache/doris/pull/43402" target="_blank" rel="noopener noreferrer">#43402</a></li>
<li>Fixed the issue of being unable to query Hive views created by Spark. <a href="https://github.com/apache/doris/pull/43552" target="_blank" rel="noopener noreferrer">#43552</a></li>
<li>Fixed the issue that Hive partition paths containing special characters led to incorrect partition pruning. <a href="https://github.com/apache/doris/pull/42906" target="_blank" rel="noopener noreferrer">#42906</a></li>
<li>Fixed the issue that Iceberg Catalog could not use AWS Glue. <a href="https://github.com/apache/doris/pull/41084" target="_blank" rel="noopener noreferrer">#41084</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-materialized-views-1">Asynchronous Materialized Views<a href="https://doris.apache.org/blog/release-note-3.0.3#asynchronous-materialized-views-1" class="hash-link" aria-label="Direct link to Asynchronous Materialized Views" title="Direct link to Asynchronous Materialized Views">&#x200B;</a></h3>
<ul>
<li>Fixed the issue that asynchronous materialized views might not refresh after the base table is rebuilt. <a href="https://github.com/apache/doris/pull/41762" target="_blank" rel="noopener noreferrer">#41762</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer-2">Query Optimizer<a href="https://doris.apache.org/blog/release-note-3.0.3#query-optimizer-2" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>Fixed the issue that partition pruning results might be incorrect when using multi-column range partitioning. <a href="https://github.com/apache/doris/pull/43332" target="_blank" rel="noopener noreferrer">#43332</a></li>
<li>Fixed the issue of incorrect calculation results in some limit offset scenarios. <a href="https://github.com/apache/doris/pull/42576" target="_blank" rel="noopener noreferrer">#42576</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution-2">Query Execution<a href="https://doris.apache.org/blog/release-note-3.0.3#query-execution-2" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>Fixed the issue that hash join with array types larger than 4G could cause BE Core. <a href="https://github.com/apache/doris/pull/43861" target="_blank" rel="noopener noreferrer">#43861</a></li>
<li>Fixed the issue that is null predicate operations might yield incorrect results in some scenarios. <a href="https://github.com/apache/doris/pull/43619" target="_blank" rel="noopener noreferrer">#43619</a></li>
<li>Fixed the issue that bitmap types might produce incorrect output results in hash join. <a href="https://github.com/apache/doris/pull/43718" target="_blank" rel="noopener noreferrer">#43718</a></li>
<li>Fixed some issues where function results were calculated incorrectly. <a href="https://github.com/apache/doris/pull/40710" target="_blank" rel="noopener noreferrer">#40710</a> <a href="https://github.com/apache/doris/pull/39358" target="_blank" rel="noopener noreferrer">#39358</a> <a href="https://github.com/apache/doris/pull/40929" target="_blank" rel="noopener noreferrer">#40929</a> <a href="https://github.com/apache/doris/pull/40869" target="_blank" rel="noopener noreferrer">#40869</a> <a href="https://github.com/apache/doris/pull/40285" target="_blank" rel="noopener noreferrer">#40285</a> <a href="https://github.com/apache/doris/pull/39891" target="_blank" rel="noopener noreferrer">#39891</a> <a href="https://github.com/apache/doris/pull/40530" target="_blank" rel="noopener noreferrer">#40530</a> <a href="https://github.com/apache/doris/pull/41948" target="_blank" rel="noopener noreferrer">#41948</a> <a href="https://github.com/apache/doris/pull/43588" target="_blank" rel="noopener noreferrer">#43588</a></li>
<li>Fixed some issues with JSON type parsing. <a href="https://github.com/apache/doris/pull/39937" target="_blank" rel="noopener noreferrer">#39937</a></li>
<li>Fixed issues with varchar and char types in runtime filter operations. <a href="https://github.com/apache/doris/pull/43758" target="_blank" rel="noopener noreferrer">#43758</a> <a href="https://github.com/apache/doris/pull/43919" target="_blank" rel="noopener noreferrer">#43919</a></li>
<li>Fixed some issues with the use of decimal256 in scalar and aggregate functions. <a href="https://github.com/apache/doris/pull/42136" target="_blank" rel="noopener noreferrer">#42136</a> <a href="https://github.com/apache/doris/pull/42356" target="_blank" rel="noopener noreferrer">#42356</a></li>
<li>Fixed the issue that arrow flight reported <code>Reach limit of connections</code> errors upon connection. <a href="https://github.com/apache/doris/pull/39127" target="_blank" rel="noopener noreferrer">#39127</a></li>
<li>Fixed the issue of incorrect memory usage statistics for BE in k8s environments. <a href="https://github.com/apache/doris/pull/41123" target="_blank" rel="noopener noreferrer">#41123</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semi-structured-data-management-2">Semi-structured Data Management<a href="https://doris.apache.org/blog/release-note-3.0.3#semi-structured-data-management-2" class="hash-link" aria-label="Direct link to Semi-structured Data Management" title="Direct link to Semi-structured Data Management">&#x200B;</a></h3>
<ul>
<li>Adjusted the default values of <code>segment_cache_fd_percentage</code> and <code>inverted_index_fd_number_limit_percent</code>. <a href="https://github.com/apache/doris/pull/42224" target="_blank" rel="noopener noreferrer">#42224</a></li>
<li>logstash now supports group_commit. <a href="https://github.com/apache/doris/pull/40450" target="_blank" rel="noopener noreferrer">#40450</a></li>
<li>Fixed the issue of coredump when building index. <a href="https://github.com/apache/doris/pull/43246" target="_blank" rel="noopener noreferrer">#43246</a> <a href="https://github.com/apache/doris/pull/43298" target="_blank" rel="noopener noreferrer">#43298</a></li>
<li>Fixed issues with variant index. <a href="https://github.com/apache/doris/pull/43375" target="_blank" rel="noopener noreferrer">#43375</a> <a href="https://github.com/apache/doris/pull/43773" target="_blank" rel="noopener noreferrer">#43773</a></li>
<li>Fixed potential fd and memory leaks under abnormal compaction circumstances. <a href="https://github.com/apache/doris/pull/42374" target="_blank" rel="noopener noreferrer">#42374</a></li>
<li>Inverted index match null now correctly returns null instead of false. <a href="https://github.com/apache/doris/pull/41786" target="_blank" rel="noopener noreferrer">#41786</a></li>
<li>Fixed the issue of coredump when ngram bloomfilter index bf_size is set to 65536. <a href="https://github.com/apache/doris/pull/43645" target="_blank" rel="noopener noreferrer">#43645</a></li>
<li>Fixed the issue of potential coredump during complex data type JOINs. <a href="https://github.com/apache/doris/pull/40398" target="_blank" rel="noopener noreferrer">#40398</a></li>
<li>Fixed the issue of coredump with TVF JSON data. <a href="https://github.com/apache/doris/pull/43187" target="_blank" rel="noopener noreferrer">#43187</a></li>
<li>Fixed the precision issue of bloom filter calculations for dates and times. <a href="https://github.com/apache/doris/pull/43612" target="_blank" rel="noopener noreferrer">#43612</a></li>
<li>Fixed the issue of coredump with IPv6 type storage. <a href="https://github.com/apache/doris/pull/43251" target="_blank" rel="noopener noreferrer">#43251</a></li>
<li>Fixed the issue of coredump when using VARIANT type with light_schema_change disabled. <a href="https://github.com/apache/doris/pull/40908" target="_blank" rel="noopener noreferrer">#40908</a></li>
<li>Improved cache performance for high-concurrency point queries. <a href="https://github.com/apache/doris/pull/44077" target="_blank" rel="noopener noreferrer">#44077</a></li>
<li>Fixed the issue that bloom filter indexes were not synchronized when columns were deleted. <a href="https://github.com/apache/doris/pull/43378" target="_blank" rel="noopener noreferrer">#43378</a></li>
<li>Fixed instability issues with es catalog under special circumstances such as mixed array and scalar data. <a href="https://github.com/apache/doris/pull/40314" target="_blank" rel="noopener noreferrer">#40314</a> <a href="https://github.com/apache/doris/pull/40385" target="_blank" rel="noopener noreferrer">#40385</a> <a href="https://github.com/apache/doris/pull/43399" target="_blank" rel="noopener noreferrer">#43399</a> <a href="https://github.com/apache/doris/pull/40614" target="_blank" rel="noopener noreferrer">#40614</a></li>
<li>Fixed coredump issues caused by abnormal regular pattern matching. <a href="https://github.com/apache/doris/pull/43394" target="_blank" rel="noopener noreferrer">#43394</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="permissions-1">Permissions<a href="https://doris.apache.org/blog/release-note-3.0.3#permissions-1" class="hash-link" aria-label="Direct link to Permissions" title="Direct link to Permissions">&#x200B;</a></h3>
<ul>
<li>Fixed several issues where permissions were not properly restricted after authorization. <a href="https://github.com/apache/doris/pull/43193" target="_blank" rel="noopener noreferrer">#43193</a> <a href="https://github.com/apache/doris/pull/41723" target="_blank" rel="noopener noreferrer">#41723</a> <a href="https://github.com/apache/doris/pull/42107" target="_blank" rel="noopener noreferrer">#42107</a> <a href="https://github.com/apache/doris/pull/43306" target="_blank" rel="noopener noreferrer">#43306</a></li>
<li>Enhanced several permission checks. <a href="https://github.com/apache/doris/pull/40688" target="_blank" rel="noopener noreferrer">#40688</a> <a href="https://github.com/apache/doris/pull/40533" target="_blank" rel="noopener noreferrer">#40533</a> <a href="https://github.com/apache/doris/pull/41791" target="_blank" rel="noopener noreferrer">#41791</a> <a href="https://github.com/apache/doris/pull/42106" target="_blank" rel="noopener noreferrer">#42106</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-1">Other<a href="https://doris.apache.org/blog/release-note-3.0.3#other-1" class="hash-link" aria-label="Direct link to Other" title="Direct link to Other">&#x200B;</a></h3>
<ul>
<li>
<p>Supplemented missing audit log fields in audit log tables and files. <a href="https://github.com/apache/doris/pull/43303" target="_blank" rel="noopener noreferrer">#43303</a></p>
<ul>
<li><a href="https://doris.apache.org/docs/3.0/admin-manual/system-tables/internal_schema/audit_log" target="_blank" rel="noopener noreferrer">View Documentation</a></li>
</ul>
</li>
</ul></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Release Notes" term="Release Notes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Scaling Bitcoin data to billions of records with Apache Doris: our journey to auto-partitioning]]></title>
        <id>https://doris.apache.org/blog/ortege-studio-1-scaling-bitcoin-data-to-billions-of-records</id>
        <link href="https://doris.apache.org/blog/ortege-studio-1-scaling-bitcoin-data-to-billions-of-records"/>
        <updated>2024-11-20T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[To power lightning-fast queries and ensure the Deep Dive dashboards deliver real-time insights, Ortege relies on Apache Doris. A crucial feature they embrace is Auto Partition.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Best Practice</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Scaling Bitcoin data to billions of records with Apache Doris: our journey to auto-partitioning</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Justin Trollip</span></span><time datetime="2024-11-20T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">November 20, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><div class="theme-admonition theme-admonition-info admonition_Gfwi alert alert--info"><div class="admonitionHeading_f1Ed">Special Thanks</div><div class="admonitionContent_UjKb"><p>The Apache Doris community shares our deep appreciation for <a href="https://www.linkedin.com/in/justintrollip/" target="_blank" rel="noopener noreferrer">Justin Trollip</a>, Founder of <a href="https://www.ortege.ai/" target="_blank" rel="noopener noreferrer">Ortege AI</a>, for providing his hands-on experience in applying Auto Partition of Apache Doris to manage massive blockchain data. Justin is a passionate and visionary technologist and entrepreneur, and we are glad to have him join the Apache Doris user community and share his insights with us.</p></div></div>
<p>At Ortege, we&apos;re building the ultimate blockchain data platform, providing comprehensive and accessible insights to empower the crypto community. One of our biggest challenges is managing the sheer volume of data, especially for Bitcoin. Our bitcoin.outputs table alone contains over <strong>3 billion records</strong> and it&apos;s growing every day!</p>
<p>To power our lightning-fast queries and ensure Ortege Studio&apos;s Deep Dive dashboards deliver real-time insights, we rely on Apache Doris, a high-performance analytical database. A crucial feature we&apos;ve embraced is <strong>Doris&apos; auto-partitioning</strong>.</p>
<p><strong>From manual to automated:</strong></p>
<p>Initially, we manually defined partitions for our Bitcoin tables, meticulously crafting ranges based on block height. While this worked well for Bitcoin&apos;s relatively predictable growth, it became cumbersome for newer chains like Stacks, where data patterns are more dynamic.</p>
<p><strong>Enter Doris auto-partitioning:</strong></p>
<p>Doris&apos; auto-partitioning changed the game. It automatically creates partitions based on the data being ingested, eliminating the need for manual intervention. We can now define partition rules (e.g., partition by month based on the block timestamp) and let Doris handle the rest. This is a game-changer for:</p>
<ul>
<li><strong>Scalability:</strong> Effortlessly accommodate massive data growth without manual schema updates.</li>
<li><strong>Performance:</strong> Optimize query speed by ensuring data is distributed efficiently across partitions.</li>
<li><strong>Flexibility:</strong> Easily adapt to changing data patterns, especially for newer chains with less predictable growth.</li>
</ul>
<p><strong>A tailored approach:</strong></p>
<p>While auto-partitioning is perfect for many scenarios, we&apos;ve found that a hybrid approach works best for Bitcoin. We use auto-partitioning for recent data while manually managing partitions for historical data, balancing automation with fine-grained control.</p>
<p><strong>Lessons learned:</strong></p>
<p>Our experience with Doris auto-partitioning has taught us that:</p>
<ul>
<li><strong>Flexibility is key:</strong> Choose a data platform that can adapt to your specific needs and data characteristics.</li>
<li><strong>Automation is powerful:</strong> Leverage automation to streamline data management and focus on extracting insights.</li>
<li><strong>Performance matters:</strong> A high-performance database like Apache Doris is essential for handling the scale of blockchain data.</li>
</ul>
<p><strong>We&apos;re committed to providing the most comprehensive and accessible blockchain data platform, and Apache Doris&apos; auto-partitioning is a crucial part of that journey. Stay tuned as we continue to innovate and empower the crypto community with data-driven insights.</strong></p>
<p>This article was written by Justin Trollip and originally posted on <a href="https://www.linkedin.com/pulse/scaling-bitcoin-data-billions-records-apache-doris-our-journey-diknc/?trackingId=pSs7z3aeSguCbWyxTcew6w%3D%3D" target="_blank" rel="noopener noreferrer">Linkedin</a>.</p></div>]]></content>
        <author>
            <name>Justin Trollip</name>
        </author>
        <category label="Best Practice" term="Best Practice"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Fine-tuning Apache Doris for maximum performance and resilience: a deep dive into fe.conf]]></title>
        <id>https://doris.apache.org/blog/ortege-studio-2-fine-tuning-apache-doris-for-maximum-performance-and-resilience</id>
        <link href="https://doris.apache.org/blog/ortege-studio-2-fine-tuning-apache-doris-for-maximum-performance-and-resilience"/>
        <updated>2024-11-20T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Ortege handles massive volumes of blockchain data to power its analytics platform, Ortege Studio. Apache Doris forms the backbone of its Lakehouse v2, enabling it to process billions of records and deliver real-time insights.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Best Practice</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Fine-tuning Apache Doris for maximum performance and resilience: a deep dive into fe.conf</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Justin Trollip</span></span><time datetime="2024-11-20T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">November 20, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><div class="theme-admonition theme-admonition-info admonition_Gfwi alert alert--info"><div class="admonitionHeading_f1Ed">Special Thanks</div><div class="admonitionContent_UjKb"><p>This is the second contribution from Justin Trollip. He introduces the fe.conf setting optimization for higher performance and resilience in his case. He uses Apache Doris as the backbone of Ortege&apos;s lakehouse, which handles massive volumes of blockchain data. Previously, he also shared his experience in using Auto Partition of Doris.</p></div></div>
<p><strong><a href="https://www.linkedin.com/company/doris-apache/" target="_blank" rel="noopener noreferrer">Apache Doris</a></strong> is renowned for its speed and scalability as an MPP analytical database. But to unlock its full potential, especially in demanding blockchain data environments, careful configuration is key. Today, we&apos;ll explore the critical settings in Doris&apos; fe.conf file that directly impact performance and resilience, using our own configuration at Ortege as a real-world case study.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="orteges-lakehouse-v2-powered-by-doris">Ortege&apos;s Lakehouse v2: Powered by Doris<a href="https://doris.apache.org/blog/ortege-studio-2-fine-tuning-apache-doris-for-maximum-performance-and-resilience#orteges-lakehouse-v2-powered-by-doris" class="hash-link" aria-label="Direct link to Ortege&apos;s Lakehouse v2: Powered by Doris" title="Direct link to Ortege&apos;s Lakehouse v2: Powered by Doris">&#x200B;</a></h2>
<p>At Ortege, we handle massive volumes of blockchain data to power our analytics platform, <strong><a href="https://app.ortege.ai/dashboard/list" target="_blank" rel="noopener noreferrer">Ortege Studio</a></strong>. Apache Doris forms the backbone of our <strong><a href="https://docs.ortege.ai/ortege-documentation/ortege-guides/ortege-lakehouse" target="_blank" rel="noopener noreferrer">Lakehouse v2</a></strong>, enabling us to process <strong>billions</strong> of records and deliver real-time insights. Our journey has involved continuous optimization and fine-tuning of Doris, and fe.conf plays a central role.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-areas-for-performance-and-resilience">Key Areas for Performance and Resilience:<a href="https://doris.apache.org/blog/ortege-studio-2-fine-tuning-apache-doris-for-maximum-performance-and-resilience#key-areas-for-performance-and-resilience" class="hash-link" aria-label="Direct link to Key Areas for Performance and Resilience:" title="Direct link to Key Areas for Performance and Resilience:">&#x200B;</a></h2>
<p>Here are the crucial fe.conf settings we&apos;ve prioritized, along with areas where we&apos;re actively experimenting for further improvement:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-engine-optimization">Query Engine Optimization<a href="https://doris.apache.org/blog/ortege-studio-2-fine-tuning-apache-doris-for-maximum-performance-and-resilience#query-engine-optimization" class="hash-link" aria-label="Direct link to Query Engine Optimization" title="Direct link to Query Engine Optimization">&#x200B;</a></h3>
<ul>
<li><code>default_max_query_instances</code>: This setting controls the maximum number of query instances allowed per user. We currently have it set to the default (-1 for unlimited), but we&apos;re considering setting a reasonable limit to prevent resource exhaustion from runaway queries, especially in multi-tenant scenarios.</li>
<li><code>max_query_retry_time</code> (Default: 3): While the default retry attempts provide some fault tolerance, increasing this value could improve query resilience in unstable network environments, but we need to carefully consider the potential impact on overall query latency.</li>
<li><code>enable_local_replica_selection</code> <strong>(set to <code>true</code>):</strong>  We have now enabled this feature to optimize query performance. In our deployment, FE and BE nodes are co-located, so this should reduce network overhead by preferentially using local replicas for queries.</li>
<li><code>rewrite_count_distinct_to_bitmap_hll</code> <strong>(Default: true):</strong> We&apos;ve kept this enabled to leverage bitmap and HLL optimizations for COUNT(DISTINCT) queries, which are common in our analytical workloads.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="load-and-export-management">Load and Export Management<a href="https://doris.apache.org/blog/ortege-studio-2-fine-tuning-apache-doris-for-maximum-performance-and-resilience#load-and-export-management" class="hash-link" aria-label="Direct link to Load and Export Management" title="Direct link to Load and Export Management">&#x200B;</a></h3>
<ul>
<li><code>enable_pipeline_load</code> <strong>(Default: true),</strong> <code>enable_vectorized_load</code> <strong>(Default: true),</strong> <code>enable_new_load_scan_node</code> <strong>(Default: true):</strong> We&apos;ve enabled these settings to leverage the latest performance enhancements in Doris&apos; load process. Pipeline execution, vectorized loading, and the new scan node contribute to faster data ingestion.</li>
<li><code>max_running_txn_num_per_db</code> <strong>(Default: 1000):</strong> While the default concurrency limit is sufficient for our current needs, we&apos;re monitoring this closely as our data volume and user base grow. We might need to increase this limit to accommodate more concurrent load jobs without causing contention.</li>
<li><code>max_stream_load_timeout_second</code> <strong>(Default: 3 days):</strong> The default timeout is very generous. We&apos;re evaluating if a shorter timeout, balanced with potential retry mechanisms, could improve resource utilization and prevent long-running, potentially problematic stream loads.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="metadata-and-cluster-management">Metadata and Cluster Management<a href="https://doris.apache.org/blog/ortege-studio-2-fine-tuning-apache-doris-for-maximum-performance-and-resilience#metadata-and-cluster-management" class="hash-link" aria-label="Direct link to Metadata and Cluster Management" title="Direct link to Metadata and Cluster Management">&#x200B;</a></h3>
<ul>
<li><code>meta_delay_toleration_second</code> <strong>(Default: 5 minutes):</strong> This setting controls how long non-master FE nodes tolerate metadata delays from the master. We might need to adjust this based on our network latency and the frequency of metadata updates.</li>
<li><code>disable_colocate_balance</code> <strong>(Default: false):</strong> We haven&apos;t disabled colocation balance, as it&apos;s crucial for maintaining optimal data distribution and query performance. However, we&apos;re exploring the implications of temporarily disabling it during specific maintenance operations or upgrades.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-optimization">Storage Optimization<a href="https://doris.apache.org/blog/ortege-studio-2-fine-tuning-apache-doris-for-maximum-performance-and-resilience#storage-optimization" class="hash-link" aria-label="Direct link to Storage Optimization" title="Direct link to Storage Optimization">&#x200B;</a></h3>
<ul>
<li><code>storage_flood_stage_usage_percent</code> <strong>(Default: 95%)</strong>, storage_flood_stage_left_capacity_bytes <strong>(Default: 1GB):</strong> These settings control the thresholds at which Doris rejects write operations to prevent storage exhaustion. We&apos;re continuously monitoring disk space usage and adjusting these thresholds as needed to avoid disruptions.</li>
<li><code>storage_high_watermark_usage_percent</code> <strong>(Default: 85%)</strong>, storage_min_left_capacity_bytes <strong>(Default: 2GB):</strong> These parameters govern how Doris selects storage paths for data balancing. We&apos;re actively experimenting with these thresholds to find the optimal balance between data distribution and avoiding disk space issues.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-caching">Query Caching<a href="https://doris.apache.org/blog/ortege-studio-2-fine-tuning-apache-doris-for-maximum-performance-and-resilience#query-caching" class="hash-link" aria-label="Direct link to Query Caching" title="Direct link to Query Caching">&#x200B;</a></h3>
<ul>
<li><code>cache_enable_sql_mode</code> <strong>(set to</strong> <code>true</code><strong>):</strong> We&apos;ve enabled query caching to significantly speed up query responses, especially for our frequently accessed Deep Dive dashboards.</li>
<li><code>cache_result_max_row_count</code> <strong>(set to</strong> <code>20000</code><strong>):</strong> We increased the maximum number of rows that can be cached to accommodate the typical result set sizes of our dashboard queries.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="continuous-improvement"><strong>Continuous Improvement</strong><a href="https://doris.apache.org/blog/ortege-studio-2-fine-tuning-apache-doris-for-maximum-performance-and-resilience#continuous-improvement" class="hash-link" aria-label="Direct link to continuous-improvement" title="Direct link to continuous-improvement">&#x200B;</a></h2>
<p>Fine-tuning Doris is an ongoing process, and we&apos;re constantly exploring new configuration options and optimization strategies. By sharing our fe.conf learnings and areas for improvement, we hope to help others get the most out of this powerful analytical database.</p>
<p>This article was written by Justin Trollip and originally posted on <a href="https://www.linkedin.com/pulse/fine-tuning-apache-doris-maximum-performance-resilience-deep-dive-jiwac/?trackingId=jJ%2FO3s%2FHRGee3mxQ9LTnxQ%3D%3D" target="_blank" rel="noopener noreferrer">Linkedin</a>.</p></div>]]></content>
        <author>
            <name>Justin Trollip</name>
        </author>
        <category label="Best Practice" term="Best Practice"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Apache Doris 2.1.7 just released]]></title>
        <id>https://doris.apache.org/blog/release-note-2.1.7</id>
        <link href="https://doris.apache.org/blog/release-note-2.1.7"/>
        <updated>2024-11-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[This version brings continuous upgrades and improvements. Additionally, several fixes have been implemented in areas such as the  to the Lakehouse, Async Materialized Views, and Semi-Structured Data Management, Query Optimizer and Permission Management.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Release Notes</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Apache Doris 2.1.7 just released</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-11-10T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">November 10, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Dear community, <strong>Apache Doris version 2.1.7 was officially released on November 10, 2024.</strong> This version brings continuous upgrades and improvements. Additionally, several fixes have been implemented in areas such as the  to the Lakehouse, Async Materialized Views, and Semi-Structured Data Management, Query Optimizer and Permission Management.</p>
<p><strong>Quick Download:</strong> <a href="https://doris.apache.org/download/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/download/</a></p>
<p><strong>GitHub Release:</strong> <a href="https://github.com/apache/doris/releases" target="_blank" rel="noopener noreferrer">https://github.com/apache/doris/releases</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="behavior-changes">Behavior changes<a href="https://doris.apache.org/blog/release-note-2.1.7#behavior-changes" class="hash-link" aria-label="Direct link to Behavior changes" title="Direct link to Behavior changes">&#x200B;</a></h2>
<ul>
<li>The following global variables will be forcibly set to the following default values:
<ul>
<li>enable_nereids_dml: true</li>
<li>enable_nereids_dml_with_pipeline: true</li>
<li>enable_nereids_planner: true</li>
<li>enable_fallback_to_original_planner: true</li>
<li>enable_pipeline_x_engine: true</li>
</ul>
</li>
<li>New columns have been added to the audit log. <a href="https://github.com/apache/doris/pull/42262" target="_blank" rel="noopener noreferrer">#42262</a>
<ul>
<li>For more information, please  refer to <a href="https://doris.apache.org/docs/admin-manual/audit-plugin/" target="_blank" rel="noopener noreferrer">docs</a></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-features">New features<a href="https://doris.apache.org/blog/release-note-2.1.7#new-features" class="hash-link" aria-label="Direct link to New features" title="Direct link to New features">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="async-materialized-view">Async Materialized View<a href="https://doris.apache.org/blog/release-note-2.1.7#async-materialized-view" class="hash-link" aria-label="Direct link to Async Materialized View" title="Direct link to Async Materialized View">&#x200B;</a></h3>
<ul>
<li>An asynchronous materialized view has added a property called <code>use_for_rewrite</code> to control whether it participates in transparent rewriting. <a href="https://github.com/apache/doris/pull/40332" target="_blank" rel="noopener noreferrer">#40332</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution">Query Execution<a href="https://doris.apache.org/blog/release-note-2.1.7#query-execution" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>The list of changed session variables is now output in the Profile. <a href="https://github.com/apache/doris/pull/41016" target="_blank" rel="noopener noreferrer">#41016</a></li>
<li>Support for <code>trim_in</code>, <code>ltrim_in</code>, and <code>rtrim_in</code> functions has been added. <a href="https://github.com/apache/doris/pull/42641" target="_blank" rel="noopener noreferrer">#42641</a> (Note: This is a duplicate mention, but I&apos;m including it as per your original list.)</li>
<li>Support for several URL functions (top_level_domain, first_significant_subdomain, cut_to_first_significant_subdomain) has been added. <a href="https://github.com/apache/doris/pull/42916" target="_blank" rel="noopener noreferrer">#42916</a></li>
<li>The <code>bit_set</code> function has been added. <a href="https://github.com/apache/doris/pull/42099" target="_blank" rel="noopener noreferrer">#42916</a></li>
<li>The <code>count_substrings</code> function has been added. <a href="https://github.com/apache/doris/pull/42055" target="_blank" rel="noopener noreferrer">#42055</a></li>
<li>The <code>translate</code> and <code>url_encode</code> functions have been added. <a href="https://github.com/apache/doris/pull/41051" target="_blank" rel="noopener noreferrer">#41051</a></li>
<li>The <code>normal_cdf</code>, <code>to_iso8601</code>, and <code>from_iso8601_date</code> functions have been added. <a href="https://github.com/apache/doris/pull/40695" target="_blank" rel="noopener noreferrer">#40695</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-management">Storage Management<a href="https://doris.apache.org/blog/release-note-2.1.7#storage-management" class="hash-link" aria-label="Direct link to Storage Management" title="Direct link to Storage Management">&#x200B;</a></h3>
<ul>
<li>The <code>information_schema.table_options</code> and <code>table_properties</code> system tables have been added, supporting the querying of attributes set during table creation. <a href="https://github.com/apache/doris/pull/34384" target="_blank" rel="noopener noreferrer">#34384</a></li>
<li>Support for <code>bitmap_empty</code> as a default value has been implemented. <a href="https://github.com/apache/doris/pull/40364" target="_blank" rel="noopener noreferrer">#40364</a></li>
<li>A new session variable <code>require_sequence_in_insert</code> has been introduced to control whether a sequence column must be provided when performing <code>INSERT INTO SELECT</code> writes to a unique key table. <a href="https://github.com/apache/doris/pull/41655" target="_blank" rel="noopener noreferrer">#41655</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="others">Others<a href="https://doris.apache.org/blog/release-note-2.1.7#others" class="hash-link" aria-label="Direct link to Others" title="Direct link to Others">&#x200B;</a></h3>
<ul>
<li>Allow for generating flame graphs on the BE WebUI page.<a href="https://github.com/apache/doris/pull/41044" target="_blank" rel="noopener noreferrer">#41044</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="https://doris.apache.org/blog/release-note-2.1.7#improvements" class="hash-link" aria-label="Direct link to Improvements" title="Direct link to Improvements">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse">Lakehouse<a href="https://doris.apache.org/blog/release-note-2.1.7#lakehouse" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>Support for writing data to Hive text format tables. <a href="https://github.com/apache/doris/pull/40537" target="_blank" rel="noopener noreferrer">#40537</a>
<ul>
<li>For more information, please  refer to <a href="https://doris.apache.org/docs/lakehouse/datalake-building/hive-build" target="_blank" rel="noopener noreferrer">docs</a></li>
</ul>
</li>
<li>Access MaxCompute data using MaxCompute Open Storage API. <a href="https://github.com/apache/doris/pull/41610" target="_blank" rel="noopener noreferrer">#41610</a>
<ul>
<li>For more information, please  refer to <a href="https://doris.apache.org/docs/lakehouse/database/max-compute" target="_blank" rel="noopener noreferrer">docs</a></li>
</ul>
</li>
<li>Support for Paimon DLF Catalog. <a href="https://github.com/apache/doris/pull/41694" target="_blank" rel="noopener noreferrer">#41694</a>
<ul>
<li>For more information, please  refer to <a href="https://doris.apache.org/docs/lakehouse/datalake-analytics/paimon" target="_blank" rel="noopener noreferrer">docs</a></li>
</ul>
</li>
<li>Added <code>table$partitions</code> syntax to directly query Hive partition information.<a href="https://github.com/apache/doris/pull/41230" target="_blank" rel="noopener noreferrer">#41230</a>
<ul>
<li>For more information, please  refer to <a href="https://doris.apache.org/docs/lakehouse/datalake-analytics/hive" target="_blank" rel="noopener noreferrer">docs</a></li>
</ul>
</li>
<li>Support for reading Parquet files in brotli compression format.<a href="https://github.com/apache/doris/pull/42162" target="_blank" rel="noopener noreferrer">#42162</a></li>
<li>Support for reading DECIMAL 256 types in Parquet files. <a href="https://github.com/apache/doris/pull/42241" target="_blank" rel="noopener noreferrer">#42241</a></li>
<li>Support for reading Hive tables in OpenCsvSerde format.<a href="https://github.com/apache/doris/pull/42939" target="_blank" rel="noopener noreferrer">#42939</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="async-materialized-view-1">Async Materialized View<a href="https://doris.apache.org/blog/release-note-2.1.7#async-materialized-view-1" class="hash-link" aria-label="Direct link to Async Materialized View" title="Direct link to Async Materialized View">&#x200B;</a></h3>
<ul>
<li>Refined the granularity of lock holding during the build process for asynchronous materialized views. <a href="https://github.com/apache/doris/pull/40402" target="_blank" rel="noopener noreferrer">#40402</a> <a href="https://github.com/apache/doris/pull/41010" target="_blank" rel="noopener noreferrer">#41010</a>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer">Query optimizer<a href="https://doris.apache.org/blog/release-note-2.1.7#query-optimizer" class="hash-link" aria-label="Direct link to Query optimizer" title="Direct link to Query optimizer">&#x200B;</a></h3>
<ul>
<li>Improved the accuracy of statistic information collection and usage in extreme cases to enhance planning stability. <a href="https://github.com/apache/doris/pull/40457" target="_blank" rel="noopener noreferrer">#40457</a></li>
<li>Runtime filters can now be generated in more scenarios to improve query performance. <a href="https://github.com/apache/doris/pull/40815" target="_blank" rel="noopener noreferrer">#40815</a></li>
<li>Enhanced constant folding capabilities for numerical, date, and string functions to boost query performance.  <a href="https://github.com/apache/doris/pull/40820" target="_blank" rel="noopener noreferrer">#40820</a></li>
<li>Optimized the column pruning algorithm to enhance query performance. <a href="https://github.com/apache/doris/pull/41548" target="_blank" rel="noopener noreferrer">#41548</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution-1">Query Execution<a href="https://doris.apache.org/blog/release-note-2.1.7#query-execution-1" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>Supported parallel preparation to reduce the time consumed by short queries. <a href="https://github.com/apache/doris/pull/40270" target="_blank" rel="noopener noreferrer">#40270</a></li>
<li>Corrected the names of some counters in the profile to match the audit logs. <a href="https://github.com/apache/doris/pull/41993" target="_blank" rel="noopener noreferrer">#41993</a></li>
<li>Added new local shuffle rules to speed up certain queries. <a href="https://github.com/apache/doris/pull/40637" target="_blank" rel="noopener noreferrer">#40637</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-management-1">Storage Management<a href="https://doris.apache.org/blog/release-note-2.1.7#storage-management-1" class="hash-link" aria-label="Direct link to Storage Management" title="Direct link to Storage Management">&#x200B;</a></h3>
<ul>
<li>The <code>SHOW PARTITIONS</code> command now supports displaying the commit version. <a href="https://github.com/apache/doris/pull/28274" target="_blank" rel="noopener noreferrer">#28274</a></li>
<li>Checked for unreasonable partition expressions when creating tables. <a href="https://github.com/apache/doris/pull/40158" target="_blank" rel="noopener noreferrer">#40158</a></li>
<li>Optimized the scheduling logic when encountering EOF in Routine Load. <a href="https://github.com/apache/doris/pull/40509" target="_blank" rel="noopener noreferrer">#40509</a></li>
<li>Made Routine Load aware of schema changes. <a href="https://github.com/apache/doris/pull/40508" target="_blank" rel="noopener noreferrer">#40508</a></li>
<li>Improved the timeout logic for Routine Load tasks. <a href="https://github.com/apache/doris/pull/41135" target="_blank" rel="noopener noreferrer">#41135</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="others-1">Others<a href="https://doris.apache.org/blog/release-note-2.1.7#others-1" class="hash-link" aria-label="Direct link to Others" title="Direct link to Others">&#x200B;</a></h3>
<ul>
<li>Allowed closing the built-in service port of BRPC via BE configuration. <a href="https://github.com/apache/doris/pull/41047" target="_blank" rel="noopener noreferrer">#41047</a></li>
<li>Fixed issues with missing fields and duplicate records in audit logs. <a href="https://github.com/apache/doris/pull/43015" target="_blank" rel="noopener noreferrer">#43015</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="https://doris.apache.org/blog/release-note-2.1.7#bug-fixes" class="hash-link" aria-label="Direct link to Bug fixes" title="Direct link to Bug fixes">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse-1">Lakehouse<a href="https://doris.apache.org/blog/release-note-2.1.7#lakehouse-1" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>Fixed the inconsistency in the behavior of INSERT OVERWRITE with Hive. <a href="https://github.com/apache/doris/pull/39840" target="_blank" rel="noopener noreferrer">#39840</a></li>
<li>Cleaned up temporarily created folders to address the issue of too many empty folders on HDFS.  <a href="https://github.com/apache/doris/pull/40424" target="_blank" rel="noopener noreferrer">#40424</a></li>
<li>Resolved memory leaks in FE caused by using the JDBC Catalog in some cases. <a href="https://github.com/apache/doris/pull/40923" target="_blank" rel="noopener noreferrer">#40923</a></li>
<li>Resolved memory leaks in BE caused by using the JDBC Catalog in some cases. <a href="https://github.com/apache/doris/pull/41266" target="_blank" rel="noopener noreferrer">#41266</a></li>
<li>Fixed errors in reading Snappy compressed formats in certain scenarios. <a href="https://github.com/apache/doris/pull/40862" target="_blank" rel="noopener noreferrer">#40862</a></li>
<li>Addressed potential FileSystem leaks on the FE side in certain scenarios. <a href="https://github.com/apache/doris/pull/41108" target="_blank" rel="noopener noreferrer">#41108</a></li>
<li>Resolved issues where using EXPLAIN VERBOSE to view external table execution plans could cause null pointer exceptions in some cases. [#41231] (<a href="https://github.com/apache/doris/pull/41231" target="_blank" rel="noopener noreferrer">https://github.com/apache/doris/pull/41231</a>)</li>
<li>Fixed the inability to read tables in Paimon parquet format. <a href="https://github.com/apache/doris/pull/41487" target="_blank" rel="noopener noreferrer">#41487</a></li>
<li>Addressed performance issues introduced by compatibility changes in the JDBC Oracle Catalog.  <a href="https://github.com/apache/doris/pull/41407" target="_blank" rel="noopener noreferrer">#41407</a></li>
<li>Disabled predicate pushing down after implicit conversion to resolve incorrect query results in some cases with JDBC Catalog. <a href="https://github.com/apache/doris/pull/42242" target="_blank" rel="noopener noreferrer">#42242</a></li>
<li>Fixed issues with case-sensitive access to table names in the External Catalog. <a href="https://github.com/apache/doris/pull/42261" target="_blank" rel="noopener noreferrer">#42261</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="async-materialized-view-2">Async Materialized View<a href="https://doris.apache.org/blog/release-note-2.1.7#async-materialized-view-2" class="hash-link" aria-label="Direct link to Async Materialized View" title="Direct link to Async Materialized View">&#x200B;</a></h3>
<ul>
<li>Fixed the issue where user-specified start times were not effective. <a href="https://github.com/apache/doris/pull/39573" target="_blank" rel="noopener noreferrer">#39573</a></li>
<li>Resolved the issue of nested materialized views not refreshing. <a href="https://github.com/apache/doris/pull/40433" target="_blank" rel="noopener noreferrer">#40433</a></li>
<li>Fixed the issue where materialized views might not refresh after the base table was deleted and recreated.  <a href="https://github.com/apache/doris/pull/41762" target="_blank" rel="noopener noreferrer">#41762</a></li>
<li>Addressed issues where partition compensation rewrites could lead to incorrect results. <a href="https://github.com/apache/doris/pull/40803" target="_blank" rel="noopener noreferrer">#40803</a></li>
<li>Fixed potential errors in rewrite results when <code>sql_select_limit</code> was set. <a href="https://github.com/apache/doris/pull/40106" target="_blank" rel="noopener noreferrer">#40106</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semi-structured-data-management">Semi-Structured Data Management<a href="https://doris.apache.org/blog/release-note-2.1.7#semi-structured-data-management" class="hash-link" aria-label="Direct link to Semi-Structured Data Management" title="Direct link to Semi-Structured Data Management">&#x200B;</a></h3>
<ul>
<li>Fixed the issue of index file handle leaks. <a href="https://github.com/apache/doris/pull/41915" target="_blank" rel="noopener noreferrer">#41915</a></li>
<li>Addressed inaccuracies in the <code>count()</code> function of inverted indexes in special cases. (#41127)[<a href="https://github.com/apache/doris/pull/41127" target="_blank" rel="noopener noreferrer">https://github.com/apache/doris/pull/41127</a>]</li>
<li>Fixed exceptions with variant when light schema change was not enabled. <a href="https://github.com/apache/doris/pull/40908" target="_blank" rel="noopener noreferrer">#40908</a></li>
<li>Resolved memory leaks when variant returns arrays. <a href="https://github.com/apache/doris/pull/41339" target="_blank" rel="noopener noreferrer">#41339</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer-1">Query optimizer<a href="https://doris.apache.org/blog/release-note-2.1.7#query-optimizer-1" class="hash-link" aria-label="Direct link to Query optimizer" title="Direct link to Query optimizer">&#x200B;</a></h3>
<ul>
<li>Corrected potential errors in nullable calculations for filter conditions during external table queries, leading to execution exceptions. <a href="https://github.com/apache/doris/pull/41014" target="_blank" rel="noopener noreferrer">#41014</a></li>
<li>Fixed potential errors in optimizing range comparison expressions. <a href="https://github.com/apache/doris/pull/41356" target="_blank" rel="noopener noreferrer">#41356</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution-2">Query Execution<a href="https://doris.apache.org/blog/release-note-2.1.7#query-execution-2" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>The match_regexp function could not correctly handle empty strings. <a href="https://github.com/apache/doris/pull/39503" target="_blank" rel="noopener noreferrer">#39503</a></li>
<li>Resolved issues where the scanner thread pool could become stuck in high-concurrency scenarios. <a href="https://github.com/apache/doris/pull/40495" target="_blank" rel="noopener noreferrer">#40495</a></li>
<li>Fixed errors in the results of the <code>data_floor</code> function. <a href="https://github.com/apache/doris/pull/41948" target="_blank" rel="noopener noreferrer">#41948</a></li>
<li>Addressed incorrect cancel messages in some scenarios. <a href="https://github.com/apache/doris/pull/41798" target="_blank" rel="noopener noreferrer">#41798</a></li>
<li>Fixed issues with excessive warning logs printed by arrow flight. <a href="https://github.com/apache/doris/pull/41770" target="_blank" rel="noopener noreferrer">#41770</a></li>
<li>Resolved issues where runtime filters failed to send in some scenarios. <a href="https://github.com/apache/doris/pull/41698" target="_blank" rel="noopener noreferrer">#41698</a></li>
<li>Fixed problems where some system table queries could not end normally or became stuck. <a href="https://github.com/apache/doris/pull/41592" target="_blank" rel="noopener noreferrer">#41592</a></li>
<li>Addressed incorrect results from window functions. ]<a href="https://github.com/apache/doris/pull/40761" target="_blank" rel="noopener noreferrer">#40761</a></li>
<li>Fixed issues where the encrypt and decrypt functions caused BE cores. <a href="https://github.com/apache/doris/pull/40726" target="_blank" rel="noopener noreferrer">#40726</a></li>
<li>Resolved errors in the results of the conv function. <a href="https://github.com/apache/doris/pull/40530" target="_blank" rel="noopener noreferrer">#40530</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-management-2">Storage Management<a href="https://doris.apache.org/blog/release-note-2.1.7#storage-management-2" class="hash-link" aria-label="Direct link to Storage Management" title="Direct link to Storage Management">&#x200B;</a></h3>
<ul>
<li>Fixed import failures when Memtable migration was used in multi-replica scenarios with machine crashes.  <a href="https://github.com/apache/doris/pull/38003" target="_blank" rel="noopener noreferrer">#38003</a></li>
<li>Addressed inaccurate memory statistics during the Memtable flush phase during imports. <a href="https://github.com/apache/doris/pull/39536" target="_blank" rel="noopener noreferrer">#39536</a></li>
<li>Fixed fault tolerance issues with Memtable migration in multi-replica scenarios. <a href="https://github.com/apache/doris/pull/40477" target="_blank" rel="noopener noreferrer">#40477</a></li>
<li>Resolved inaccurate bvar statistics with Memtable migration. <a href="https://github.com/apache/doris/pull/40985" target="_blank" rel="noopener noreferrer">#40985</a></li>
<li>Fixed inaccurate progress reporting for S3 loads. <a href="https://github.com/apache/doris/pull/40987" target="_blank" rel="noopener noreferrer">#40987</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="permissions">Permissions<a href="https://doris.apache.org/blog/release-note-2.1.7#permissions" class="hash-link" aria-label="Direct link to Permissions" title="Direct link to Permissions">&#x200B;</a></h3>
<ul>
<li>Fixed permission issues related to show columns, show sync, and show data from db.table. <a href="https://github.com/apache/doris/pull/39726" target="_blank" rel="noopener noreferrer">#39726</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="others-2">Others<a href="https://doris.apache.org/blog/release-note-2.1.7#others-2" class="hash-link" aria-label="Direct link to Others" title="Direct link to Others">&#x200B;</a></h3>
<ul>
<li>Fixed the issue where the audit log plugin for version 2.0 could not be used in version 2.1. <a href="https://github.com/apache/doris/pull/41400" target="_blank" rel="noopener noreferrer">#41400</a></li>
</ul></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Release Notes" term="Release Notes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[New milestone: Apache Doris 3.0 has been released]]></title>
        <id>https://doris.apache.org/blog/release-note-3.0.0</id>
        <link href="https://doris.apache.org/blog/release-note-3.0.0"/>
        <updated>2024-10-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Starting from version 3.X, Apache Doris supports a compute-storage decoupled mode inaddition to the compute-storage mode for cluster deployment. ]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Release Notes</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">New milestone: Apache Doris 3.0 has been released</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-10-15T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">October 15, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>We are excited to announce the release of Apache Doris 3.0!</p>
<p><strong>Starting from version 3.X, Apache Doris supports a compute-storage decoupled mode in addition to the compute-storage coupled mode for cluster deployment. With the cloud-native architecture that decouples the computation and storage layers, users can achieve physical isolation between query loads across multiple compute clusters, as well as isolation between read and write loads. Additionally, users can take advantage of low-cost shared storage systems such as object storage or HDFS to significantly reduce storage costs.</strong></p>
<p>Version 3.0 marks a milestone in the evolution of Apache Doris towards a unified data lake and data warehouse architecture. This version introduces the ability to write data back to data lakes, allowing users to perform data analysis, sharing, processing, and storage operations across multiple data sources within Apache Doris. With capabilities such as asynchronous materialized views, Apache Doris can serve as a unified data processing engine for enterprises, helping users better manage data across lakes, warehouses, and databases. Also, Apache Doris 3.0 introduces the Trino Connector. It allows users to quickly connect or adapt to more data sources, and leverage the high-performance compute engine of Doris to deliver faster query results than Trino.</p>
<p>Version 3.0 also enhances support for ETL batch processing scenarios, adding explicit transaction support for operations like <code>insert into select</code>, <code>delete</code> and <code>update</code>. The observability of query execution has also been improved.</p>
<p>In terms of performance, we have improved the framework capabilities, infrastructure, and rules of the query optimizer in version 3.0. This provides optimized performance, which has been proven by blind testing in more complex and diverse business scenarios.</p>
<p>The adaptive Runtime Filter computation method now accurately estimates filters based on data size during execution, delivering better performance under large data volumes and high loads. Additionally, asynchronous materialized view has been more stable and user-friendly in query acceleration and data modeling.</p>
<p><strong>During the development of version 3.0, over 200 contributors submitted nearly 5,000 optimizations</strong> and fixes to Apache Doris. Contributors from companies such as VeloDB, Baidu, Meituan, ByteDance, Tencent, Alibaba, Kwai, Huawei, and Tianyi Cloud actively collaborated with the community, contributing test cases from real-world use cases to help us improve Apache Doris. We extend our heartfelt thanks to all the contributors involved in the development, testing, and feedback process for this release.</p>
<ul>
<li>
<p><strong>GitHub</strong>: <a href="https://github.com/apache/doris/releases" target="_blank" rel="noopener noreferrer">https://github.com/apache/doris/releases</a></p>
</li>
<li>
<p><strong>Website</strong>: <a href="https://doris.apache.org/download" target="_blank" rel="noopener noreferrer">https://doris.apache.org/download</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-compute-storage-decoupled-mode">1. Compute-storage decoupled mode<a href="https://doris.apache.org/blog/release-note-3.0.0#1-compute-storage-decoupled-mode" class="hash-link" aria-label="Direct link to 1. Compute-storage decoupled mode" title="Direct link to 1. Compute-storage decoupled mode">&#x200B;</a></h2>
<p>Since V3.0, Apache Doris supports the compute-storage decoupled mode. Users can choose between it and the compute-storage coupled mode during cluster deployment.</p>
<p>In the compute-storage decoupled mode, the BE nodes no longer store the data, but instead, a shared storage layer (HDFS and object storage) is introduced as the shared data storage layer. The computing and storage resources can be scaled independently, bringing multiple benefits to users:</p>
<ul>
<li>
<p><strong>Workload isolation</strong>: Multiple compute clusters can share the same data, allowing users to isolate different business workloads or offline loads using separate compute clusters.</p>
</li>
<li>
<p><strong>Reduced storage costs</strong>: The full dataset is stored in the more cost-effective and highly reliable shared storage, with only hot data cached locally. Compared to the compute-storage coupled mode with three data replicas, the storage cost can be reduced by up to 90%.</p>
</li>
<li>
<p><strong>Elastic computing resources</strong>: Since no data is stored on the BE nodes, the computing resources can be scaled flexibly based on the load requirements. Users can scale in or out an individual compute cluster or increase/decrease the number of compute clusters. This also leads to cost savings.</p>
</li>
<li>
<p><strong>Improved system robustness</strong>: By storing the data in shared storage, Doris no longer needs to handle the complex logic of multi-replica consistency, thus simplifying distributed storage complexity and improving the overall system robustness.</p>
</li>
<li>
<p><strong>Flexible data sharing and cloning</strong>: The flexibility of the compute-storage decoupled mode extends beyond a single Doris cluster. Tables from one Doris cluster can be easily cloned to another Doris cluster, with just metadata replication.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-1-from-coupled-to-decoupled">1-1. From coupled to decoupled<a href="https://doris.apache.org/blog/release-note-3.0.0#1-1-from-coupled-to-decoupled" class="hash-link" aria-label="Direct link to 1-1. From coupled to decoupled" title="Direct link to 1-1. From coupled to decoupled">&#x200B;</a></h3>
<p>In the compute-storage coupled mode, the Apache Doris architecture consists of two main process types: Frontend (FE) and Backend (BE). The FE is primarily responsible for user request access, query parsing and planning, metadata management, and node management. The BE is responsible for data storage and query plan execution.</p>
<p>The BE nodes employ an MPP (Massively Parallel Processing) distributed computing architecture, leveraging a multi-replica consistency protocol to ensure high service availability and high data reliability.</p>
<p><img decoding="async" loading="lazy" alt="From coupled to decoupled" src="https://cdnd.selectdb.com/assets/images/storage-compute-decoupled-0c53e0b9a7c24a42e2dd2517680b0f5e.PNG" width="1280" height="612" class="img_ev3q"></p>
<p>The maturation of emerging cloud computing infrastructure, including public clouds, private clouds, and Kubernetes-based container platforms, has driven the need for cloud-native capabilities. Increasingly, users are seeking deeper integration between Apache Doris and cloud computing infrastructure to provide more elasticity.</p>
<p><strong>To address this need, the VeloDB team has designed and implemented a cloud-native version of Apache Doris that decouples compute and storage, known as VeloDB Cloud.  After extensive production testing and refinement across hundreds of enterprises over a long time, this cloud-native solution has now been contributed to the Apache Doris community, manifesting as the Apache Doris 3.0 in the compute-storage decoupled mode.</strong></p>
<p>In the compute-storage decoupled mode, the Apache Doris architecture consists of three layers:</p>
<ul>
<li><strong>Meta data layer</strong>: A new Meta Service module has been introduced to provide meta data services, such as processing database and table information, schemas, rowset meta, and transactions. The Meta Service is stateless and horizontally scalable. In V3.0, all of the BE&apos;s meta data and parts of the FE&apos;s meta data have been migrated to the Meta Service. We will finish the migration of the remains in future versions.</li>
<li><strong>Computation layer</strong>: The stateless BE nodes execute query plans and cache a portion of the data and tablet meta data locally to improve query performance. Multiple stateless BE nodes can be organized into a computing resource pool (i.e., compute cluster), and multiple compute clusters can share the same data and metadata service. The compute clusters can be elastically scaled by adding or removing nodes as needed.</li>
<li><strong>Shared storage layer</strong>: Data is persisted to the shared storage layer, which currently supports HDFS as well as various cloud-based object storage systems that are compatible with the S3 protocol, such as S3, OSS, GCS, Azure Blob, COS, BOS, and MinIO.</li>
</ul>
<p><img decoding="async" loading="lazy" alt="From coupled to decoupled-2" src="https://cdnd.selectdb.com/assets/images/storage-compute-decoupled-2-82623382fce78f63315a2a07bb0e327a.JPEG" width="1280" height="692" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-2-design-highlight">1-2 Design highlight<a href="https://doris.apache.org/blog/release-note-3.0.0#1-2-design-highlight" class="hash-link" aria-label="Direct link to 1-2 Design highlight" title="Direct link to 1-2 Design highlight">&#x200B;</a></h3>
<p>The design of the compute-storage decoupled mode of Apache Doris highlights the transformation of the FE&apos;s in-memory metadata model into a shared metadata service. This approach offers a globally consistent state view, allowing any node to directly submit writes without needing to go through the FE for publishing. During write operations, data is stored in shared storage, while metadata is managed by the metadata service. <strong>This effectively controls the number of small files in shared storage. Meanwhile, the real-time write performance for individual tables is nearly on par with that in the compute-storage coupled mode. The system&apos;s overall write capacity is no longer limited by the processing power of a single FE node.</strong></p>
<p><img decoding="async" loading="lazy" alt="Design highlight" src="https://cdnd.selectdb.com/assets/images/design-hightlight-c14acd87500c4ada3740cb8fddfca025.PNG" width="1280" height="545" class="img_ev3q"></p>
<p>Based on the globally consistent state view, for data garbage collection, we have adopted a design approach for data deletion that is easier to prove correct and more efficient.</p>
<p>Specifically, data in the shared storage is incorporated into the globally consistent view offered by the shared meta data service. Whenever data is generated, we bind it to a separate, independent transaction. Similarly, for a meta data deletion operation, we also bind it to a separate, independent transaction. The purpose of this approach is to ensure that deletion and write operations cannot succeed together. The view records which data needs to be deleted, and the asynchronous deletion process can simply perform a forward deletion of the data based on the transaction records, without the need for reverse garbage collection.</p>
<p>As the tablet-related meta data in the FE is gradually migrated to the shared meta data service, the scalability of the Doris cluster will no longer be constrained by the memory capacity of a single FE node. Building upon the shared meta data service and the forward data deletion technique, we can conveniently expand functionality such as data sharing and lightweight cloning.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-3-comparison-with-alternative-solutions">1-3 Comparison with alternative solutions<a href="https://doris.apache.org/blog/release-note-3.0.0#1-3-comparison-with-alternative-solutions" class="hash-link" aria-label="Direct link to 1-3 Comparison with alternative solutions" title="Direct link to 1-3 Comparison with alternative solutions">&#x200B;</a></h3>
<p>Another design of decoupling compute and storage in the industry is to store the data and BE node meta data in a shared object storage or HDFS. However, this approach brings the following problems:</p>
<ul>
<li>
<p><strong>Inability to support real-time writes</strong>: During data writes, the data is mapped to tablets based on the partitioning and bucketing rules, generating segment files and rowset meta data. During the write process, a two-phase commit (Publish) is performed through the FE. When a BE node receives the Publish request, it then sets the rowset as visible. The Publish operation must not fail. If the rowset meta data is stored in the shared storage, the total small file data during the real-time write process would triple the size of the actual data files - one replica of data files, one for rowset meta data, and another for rowset meta data changes during Publish. The Publish operation is driven by a single FE node, so the write capacity of a single table or even the entire system is limited by the FE node&apos;s capabilities.</p>
<p><img decoding="async" loading="lazy" alt="Comparison with alternative solutions" src="https://cdnd.selectdb.com/assets/images/comparison-with-alternative-solutions-0b9bb94e642a30c74325b50b7e4a0856.png" width="1280" height="491" class="img_ev3q"></p>
<p>We compared the real-time data write performance of Apache Doris 3.0 with the above-described solution. We simulated 500 concurrent tasks writing 10,000 data files with 500 rows each, and 50 concurrent tasks writing 250 data files with 20,000 rows each, using the same computational resources.</p>
<p><strong>The results showed that at 50 concurrent tasks, the micro-batch write performances of Apache Doris in both compute-storage coupled and decoupled modes were almost identical, while the industry solution lagged behind Apache Doris by a factor of 100.</strong></p>
<p>At 500 concurrent tasks, the performance of Apache Doris in the compute-storage decoupled mode showed slight degradation, but it still maintained an 11X advantage over the industry solution. To ensure a fair test, Apache Doris did not enable the Group Commit feature (which the industry solution lacks). Enabling Group Commit would further enhance real-time write performance.</p>
<p><img decoding="async" loading="lazy" alt="Comparison with alternative solutions" src="https://cdnd.selectdb.com/assets/images/real-time-write-performance.-e3ac58a309c1bb48d6e54669cbedb92c.png" width="1280" height="734" class="img_ev3q"></p>
<p>Additionally, the industry solution also faces stability and cost issues in terms of real-time data ingestion:</p>
<ul>
<li>
<p>Stability concerns: A large number of small files can put pressure on the shared storage, especially HDFS, and introduce stability risks.</p>
</li>
<li>
<p>High object storage request costs: Some public cloud object storage services charge 10 times more for Put and Delete operations compared to Get operations. A large number of small files can lead to a significant increase in object storage request costs, which can even exceed the storage costs.</p>
</li>
</ul>
</li>
<li>
<p><strong>Limited scalability</strong>: Use cases of the compute-storage decoupled model often handles larger data storage sizes, since the FE (Frontend) meta data is entirely in-memory, when the number of tablets reaches a certain high level (e.g. tens of millions), the FE&apos;s memory pressure can become a bottleneck that limits the overall write throughput of the system.</p>
</li>
<li>
<p><strong>Potential data deletion logic issues</strong>: In the compute-storage decoupled architecture, data is stored with one single replica. Therefore, the data deletion logic is critical for the system&apos;s reliability. The conventional approach of cross-system data deletion by comparing the differences can be challenging. During the write process, there is no way to completely avoid deletion and write from succeeding together, which can lead to data loss. Additionally, when the storage system experiences anomalies, the input used for difference calculation may be incorrect, which potentially leads to unintended data deletion.</p>
</li>
<li>
<p><strong>Data sharing and lightweight cloning</strong>: The flexibility of the decoupled storage-compute architecture can enable future data sharing and lightweight data cloning, reducing the burden of enterprise data management. However, if each cluster has a separate FE, after cloning data across clusters, it becomes difficult to accurately determine which data is no longer referenced and can be safely deleted, as calculating cross-cluster references can easily lead to unintended data deletion.</p>
</li>
</ul>
<p>By evolving the FE&apos;s full in-memory meta data model into a shared meta data service, Apache Doris 3.0 avoids all the aforementioned issues.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-4-query-performance-comparison">1-4 Query performance comparison<a href="https://doris.apache.org/blog/release-note-3.0.0#1-4-query-performance-comparison" class="hash-link" aria-label="Direct link to 1-4 Query performance comparison" title="Direct link to 1-4 Query performance comparison">&#x200B;</a></h3>
<p>In the compute-storage decoupled mode, data needs to be read from the remote shared storage system, the main bottleneck has become the network bandwidth instead of the disk I/O in the compute-storage coupled mode.</p>
<p>To accelerate data access, Apache Doris has implemented a high-speed caching mechanism based on local disks, and provides two cache management policies: LRU (Least Recently Used) and TTL (Time-To-Live). The newly imported data is asynchronously written to the cache to accelerate the first-time access to the latest data. If the data required by a query is not in the cache, the system will read the data from the remote storage into memory and synchronously write it to the cache for subsequent queries.</p>
<p>In use cases involving multiple compute clusters, Apache Doris provides a cache preheating function. When a new compute cluster is established, users can choose to preheat specific data (such as tables or partitions) to further improve query efficiency.</p>
<p>In this context, we have conducted performance tests with different caching strategies in both the compute-storage coupled and decoupled modes, using the TPC-DS 1TB test dataset. The results are concluded as follows:</p>
<ul>
<li>
<p>When the cache is fully hit (i.e., all the data required for the query is loaded into the cache), <strong>the query performance of the compute-storage decoupled mode is on par with that of the compute-storage coupled mode</strong>.</p>
</li>
<li>
<p>When the cache is partially hit (i.e., the cache is cleared before the test, and data is gradually loaded into the cache during the test, with performance continuously improving), the query performance of the compute-storage decoupled mode is about 10% lower than that of the compute-storage coupled mode. This test scenario is the most similar to the real-life use cases.</p>
</li>
<li>
<p>When the cache is completely missed (i.e., the cache is cleared before every SQL execution, simulating an extreme case), the performance loss is around 35%. <strong>Even so, Apache Doris in the compute-storage decoupled mode delivers much higher performance than its alternative solutions.</strong></p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Query performance comparison" src="https://cdnd.selectdb.com/assets/images/query-performance-comparison-796eaa4e76522d5b967b4117c8f71963.png" width="1280" height="717" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-5-write-speed-comparison">1-5 Write speed comparison<a href="https://doris.apache.org/blog/release-note-3.0.0#1-5-write-speed-comparison" class="hash-link" aria-label="Direct link to 1-5 Write speed comparison" title="Direct link to 1-5 Write speed comparison">&#x200B;</a></h3>
<p>In terms of write performance, we have simulated two test cases under the same computing resources: batch import and high-concurrency real-time import. The comparison of write performance between the compute-storage coupled mode and the compute-storage decoupled mode is as follows:</p>
<ul>
<li>
<p><strong>Batch import</strong>: When importing the 1TB TPC-H and 1TB TPC-DS test datasets, <strong>the write performance of the compute-storage decoupled mode is 20.05% and 27.98% higher than the compute-storage coupled mode</strong>, respectively, under the single-replica configuration. During batch import, the segment file size is generally in the range of tens to hundreds of MB. In the compute-storage decoupled mode, the segment files are split into smaller files and concurrently uploaded to the object storage, which can result in higher throughput compared to writing to local disks. In real-life deployments, the compute-storage coupled mode typically uses three replicas, which means the write speed advantage of the compute-storage decoupled mode will be even more pronounced.</p>
</li>
<li>
<p><strong>High-concurrency real-time import</strong>: as described in the &quot;Comparison with alternative solutions&quot; section.</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Write speed comparison" src="https://cdnd.selectdb.com/assets/images/write-speed-comparison-e450974dbcba7200a9afc3c7b48b7329.png" width="1280" height="772" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-6-tips-for-production-environment">1-6 Tips for production environment<a href="https://doris.apache.org/blog/release-note-3.0.0#1-6-tips-for-production-environment" class="hash-link" aria-label="Direct link to 1-6 Tips for production environment" title="Direct link to 1-6 Tips for production environment">&#x200B;</a></h3>
<ul>
<li>
<p><strong>Performance</strong>: For real-time data analysis, users can achieve query performance comparable to the compute-storage coupled mode by specifying a TTL (Time-To-Live) for the cache and writing newly ingested data into the cache. To prevent query jitter, users can cache the data generated by background tasks such as compaction and schema changes based on how frequently used the data is.</p>
</li>
<li>
<p><strong>Workload isolation</strong>: Users can achieve physical resource isolation for different business using multiple compute clusters. For workload isolation within a single compute cluster, users can utilize the Workload Group mechanism to limit and isolate resources for different queries.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-7-notes">1-7 Notes<a href="https://doris.apache.org/blog/release-note-3.0.0#1-7-notes" class="hash-link" aria-label="Direct link to 1-7 Notes" title="Direct link to 1-7 Notes">&#x200B;</a></h3>
<ul>
<li>
<p>Apache Doris 3.0 does not support the co-existence of the compute-storage coupled mode and the compute-storage decoupled mode. Users need to specify one of them during cluster deployment.</p>
</li>
<li>
<p>If users need the compute-storage coupled mode, following the <a href="https://doris.apache.org/docs/3.0/install/source-install/compilation-with-docker/" target="_blank" rel="noopener noreferrer">documentation</a> for its deployment and upgrade. We recommend using Doris Manager for quick deployment and cluster upgrades. However, the compute-storage decoupled mode does not yet support Doris Manager deployment and upgrade. We will continue iteration for better support in future versions.</p>
</li>
<li>
<p>Currently Apache Doris does not support in-place upgrade from V2.1 to the compute-storage decoupled mode of V3.0. For such purpose, users need to perform data migration using tools like X2Doris after deploying the compute-storage decoupled clusters. In the future, we will support migration without service interruption through the CCR (Change Data Capture) capability.</p>
</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_Gfwi alert alert--info"><div class="admonitionHeading_f1Ed">info</div><div class="admonitionContent_UjKb"><p>See doc:
<a href="https://doris.apache.org/docs/3.0/compute-storage-decoupled/overview/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/docs/3.0/compute-storage-decoupled/overview/</a></p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-data-lakehouse">2. Data lakehouse<a href="https://doris.apache.org/blog/release-note-3.0.0#2-data-lakehouse" class="hash-link" aria-label="Direct link to 2. Data lakehouse" title="Direct link to 2. Data lakehouse">&#x200B;</a></h2>
<p>Apache Doris is positioned as a real-time data warehouse, but it is much more than that. In previous versions, we have consistently pushed beyond the boundaries of traditional data warehouse capabilities, advancing towards a unified data lakehouse. Version 3.0 marks a milestone in this journey, with its capabilities in the lakehouse architecture becoming fully mature. We believe that a unified lakehouse is identified by <strong>boundaryless data</strong> and <strong>lakehouse fusion</strong>:</p>
<p><strong>Boundaryless data: Apache Doris serves as a unified query processing engine, breaking down data barriers across different systems. It provides a consistent and ultra-fast analysis experience across all data sources, including data warehouses, data lakes, data streams, and local data files.</strong></p>
<ul>
<li>
<p><strong>Lakehouse query acceleration</strong>: Without the need to migrate data to Apache Doris, users can leverage Doris&#x2019; efficient query engine to directly query data stored in data lakes such as Iceberg, Hudi, Paimon, and offline data warehouses like Hive, thereby accelerating query analysis.</p>
</li>
<li>
<p><strong>Federated analysis</strong>: By extending its catalog and storage plugins, Apache Doris enhances its federated analysis capabilities, allowing users to perform unified analysis across multiple heterogeneous data sources without physically centralizing the data in a single storage system. This enables external table queries and federated joins between internal and external tables, breaking down data silos and providing globally consistent data insights.</p>
</li>
<li>
<p><strong>Data lake construction</strong>: Apache Doris introduces write-back functionality for Hive and Iceberg, allowing users to directly create Hive and Iceberg tables through Doris and write data into them. This allows users to write internal table data back to the offline lakehouse or process offline lakehouse data using Doris and save the results back into the lakehouse, simplifying and streamlining the data lake construction process.</p>
</li>
</ul>
<p><strong>Lakehouse fusion: As data lake architectures become increasingly complex, the costs of technology selection and maintenance rise for users. Achieving consistent fine-grained access control across multiple systems also becomes challenging, and real-time performance suffers. To address this, Apache Doris integrates core features of the data lake, transforming itself into a lightweight, efficient, native real-time lakehouse.</strong></p>
<ul>
<li>
<p><strong>Real-time data updates</strong>: Starting with version 1.2, Apache Doris enhanced the primary key model by introducing Merge-on-Write, supporting real-time updates. This feature allows high-frequency, real-time data updates based on primary key changes from upstream data sources.</p>
</li>
<li>
<p><strong>Data science and</strong> <strong>AI</strong> <strong>computation support</strong>: From version 2.1, Apache Doris, using the efficient Arrow Flight protocol, increased the openness of its storage system and its support for various compute loads, enabling data science and AI computations.</p>
</li>
<li>
<p><strong>Enhancements for semi-structured and unstructured Data</strong>: Apache Doris has introduced support for data types like Array, Map, Struct, JSON, and Variant, with plans to support vector indexing in the future.</p>
</li>
<li>
<p><strong>Improved resource efficiency by decoupling storage and compute</strong>: With version 3.0, Apache Doris supports a decoupled storage and compute mode, further improving resource efficiency and scalability.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-1-faster-queries-in-the-data-lakehouse">2-1 Faster queries in the data lakehouse<a href="https://doris.apache.org/blog/release-note-3.0.0#2-1-faster-queries-in-the-data-lakehouse" class="hash-link" aria-label="Direct link to 2-1 Faster queries in the data lakehouse" title="Direct link to 2-1 Faster queries in the data lakehouse">&#x200B;</a></h3>
<p>TPC-H and TPC-DS benchmarking proves that Apache Doris achieves average query performance that is 3 to 5 times faster than Trino/Presto.</p>
<p>In V3.0, we have focused on optimizing query performance for production environments, including:</p>
<ul>
<li>
<p><strong>More granular task splitting strategy</strong>: By adjusting the consistent hashing algorithm and introducing a task sharding weighting mechanism, we ensure balanced query loads across all nodes.</p>
</li>
<li>
<p><strong>Scheduling optimizations for use cases with numerous partitions and files</strong>: For cases with a large number of files (over 1 million), we have largely reduced query latency (from 100 seconds to 10 seconds) and alleviated memory pressure on the Frontend (FE) by asynchronously and batch-fetching file shards.</p>
</li>
</ul>
<p>We will continue to specifically enhance query acceleration performance in real-world business scenarios, improve the actual user experience, and build an industry-leading lakehouse query acceleration engine.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-2-federated-analysis-more-data-connectors">2-2 Federated analysis: more data connectors<a href="https://doris.apache.org/blog/release-note-3.0.0#2-2-federated-analysis-more-data-connectors" class="hash-link" aria-label="Direct link to 2-2 Federated analysis: more data connectors" title="Direct link to 2-2 Federated analysis: more data connectors">&#x200B;</a></h3>
<p>Previous versions of Apache Doris support connectors for over 10 mainstream data lakehouses, warehouses, and relational databases. In V3.0, we have introduced the Trino Connector compatibility framework, which expands the range of data sources that Apache Doris can connect to. With this framework, users can easily adapt their existing setups to access corresponding data sources using Doris and leverage its high-speed computing engine for data analysis.</p>
<p>Currently, Doris has completed adaptations for Delta Lake, Kudu, BigQuery, Kafka, TPCH, and TPCDS. We also encourage contributions from developers to prolong this list.</p>
<div class="theme-admonition theme-admonition-info admonition_Gfwi alert alert--info"><div class="admonitionHeading_f1Ed">Note</div><div class="admonitionContent_UjKb"><p>See doc:</p><ul>
<li>
<p>Trino Connector: <a href="https://doris.apache.org/community/how-to-contribute/trino-connector-developer-guide/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/community/how-to-contribute/trino-connector-developer-guide/</a></p>
</li>
<li>
<p>TPC-H: <a href="https://doris.apache.org/docs/3.0/lakehouse/datalake-analytics/tpch/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/docs/3.0/lakehouse/datalake-analytics/tpch/</a></p>
</li>
<li>
<p>TPC-DS: <a href="https://doris.apache.org/docs/3.0/lakehouse/datalake-analytics/tpcds/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/docs/3.0/lakehouse/datalake-analytics/tpcds/</a></p>
</li>
<li>
<p>Delta Lake: <a href="https://doris.apache.org/docs/3.0/lakehouse/datalake-analytics/deltalake/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/docs/3.0/lakehouse/datalake-analytics/deltalake/</a></p>
</li>
<li>
<p>Kudu: <a href="https://doris.apache.org/docs/3.0/lakehouse/datalake-analytics/kudu/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/docs/3.0/lakehouse/datalake-analytics/kudu/</a></p>
</li>
<li>
<p>BigQuery: <a href="https://doris.apache.org/docs/3.0/lakehouse/datalake-analytics/bigquery/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/docs/3.0/lakehouse/datalake-analytics/bigquery/</a></p>
</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-3-data-lake-building">2-3 Data lake building<a href="https://doris.apache.org/blog/release-note-3.0.0#2-3-data-lake-building" class="hash-link" aria-label="Direct link to 2-3 Data lake building" title="Direct link to 2-3 Data lake building">&#x200B;</a></h3>
<p>In V3.0, we have introduced data writeback functionality for Hive and Iceberg. This allows users to create Hive and Iceberg tables directly through Doris and write data into these tables, and enables users to perform data analysis, sharing, processing, and storage operations across multiple data sources within Doris.</p>
<p>In future iterations, Apache Doris will further enhance support for data lake table formats and improve the openness of storage APIs.</p>
<div class="theme-admonition theme-admonition-info admonition_Gfwi alert alert--info"><div class="admonitionHeading_f1Ed">Note</div><div class="admonitionContent_UjKb"><p>See doc: <a href="https://doris.apache.org/docs/3.0/lakehouse/datalake-building/hive-build/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/docs/3.0/lakehouse/datalake-building/hive-build/</a></p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-upgraded-semi-structured-data-analysis-capabilities">3. Upgraded semi-structured data analysis capabilities<a href="https://doris.apache.org/blog/release-note-3.0.0#3-upgraded-semi-structured-data-analysis-capabilities" class="hash-link" aria-label="Direct link to 3. Upgraded semi-structured data analysis capabilities" title="Direct link to 3. Upgraded semi-structured data analysis capabilities">&#x200B;</a></h2>
<p>In versions 2.0 and 2.1, Apache Doris introduced some well-embraced features such as inverted index, NGram Bloom Filter, and Variant data type to support high-performance full-text search and multi-dimensional analysis. With them, the storage and processing of complex semi-structured data have been more flexible and efficient.</p>
<p>In V3.0, we have further enhanced the capabilities in this scenario.</p>
<p>After extensive testing in production environments, the Variant data type has gained sufficient stability and become the preferred choice for JSON data storage and analysis. In V3.0, we have made multiple optimizations to it:</p>
<ul>
<li>
<p>Support for indexing of the Variant data type to accelerate queries, including inverted index, Bloom Filter index, and the built-in ZoneMap index.</p>
</li>
<li>
<p>Support for flexible partial column updates for Unique Key tables containing the Variant data type.</p>
</li>
<li>
<p>Support for the use of the Variant data type in the compute-storage decoupled mode, with optimizations of its metadata storage.</p>
</li>
<li>
<p>Support for exporting the Variant data type to formats such as Parquet and CSV.</p>
</li>
</ul>
<p>The inverted index, introduced since V2.0, has reached a high level of maturity after more than a year of refinement and is now running in production environments of hundreds of enterprises. In V3.0, we have made multiple optimizations to the inverted index:</p>
<ul>
<li>
<p>After performance optimizations, including lock concurrency, Apache Doris outperforms Elasticsearch in key metrics such as query latency and concurrency in real-time reporting analysis.</p>
</li>
<li>
<p>Optimized index file in the compute-storage decoupled mode to reduce remote storage calls and decrease index query latency.</p>
</li>
<li>
<p>Support for the Array data type to accelerate the <code>array_contains</code> queries.</p>
</li>
<li>
<p>Enhanced the <code>match_phrase_*</code> functionality, including support for slop and phrase prefix matching <code>match_phrase_prefix</code>.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-enhanced-etl-capabilities">4. Enhanced ETL capabilities<a href="https://doris.apache.org/blog/release-note-3.0.0#4-enhanced-etl-capabilities" class="hash-link" aria-label="Direct link to 4. Enhanced ETL capabilities" title="Direct link to 4. Enhanced ETL capabilities">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-1-transaction-improvements">4-1. Transaction improvements<a href="https://doris.apache.org/blog/release-note-3.0.0#4-1-transaction-improvements" class="hash-link" aria-label="Direct link to 4-1. Transaction improvements" title="Direct link to 4-1. Transaction improvements">&#x200B;</a></h3>
<p>Data processing in data warehouses often involves multiple data changes that need to be handled as a single transaction. V3.0 provides explicit transaction support for <code>insert into select</code>, <code>delete</code>, and <code>update</code> operations. Example cases include:</p>
<ul>
<li>
<p><strong>Transactional requirements</strong>: For example, when updating data within a time range, the typical approach is to first delete the data in that time range, and then insert the new data. Considering that the data might already be in service, there is a need to ensure that queries visit either the old data or the new data. Thus, it can be achieved by executing the <code>delete</code> and <code>insert into select</code> operations in a transaction.</p>
<div class="language-Java language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token constant" style="color:rgb(189, 147, 249)">BEGIN</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token constant" style="color:rgb(189, 147, 249)">DELETE</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">FROM</span><span class="token plain"> table </span><span class="token constant" style="color:rgb(189, 147, 249)">WHERE</span><span class="token plain"> date </span><span class="token operator">&gt;=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2024-07-01&quot;</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">AND</span><span class="token plain"> date </span><span class="token operator">&lt;=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2024-07-31&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token constant" style="color:rgb(189, 147, 249)">INSERT</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">INTO</span><span class="token plain"> table </span><span class="token constant" style="color:rgb(189, 147, 249)">SELECT</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token class-name">FROM</span><span class="token plain"> stage_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token constant" style="color:rgb(189, 147, 249)">COMMIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Simplified the processing of failed tasks</strong>: For example, when two <code>insert into select</code> operations are executed within a single transaction, if any of the operations fail, it can be retried directly.</p>
<div class="language-Java language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token constant" style="color:rgb(189, 147, 249)">BEGIN</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">WITH</span><span class="token plain"> </span><span class="token class-name">LABEL</span><span class="token plain"> label_etl_1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token constant" style="color:rgb(189, 147, 249)">INTO</span><span class="token plain"> table1 </span><span class="token constant" style="color:rgb(189, 147, 249)">SELECT</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token class-name">FROM</span><span class="token plain"> stage_table1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token constant" style="color:rgb(189, 147, 249)">INSERT</span><span class="token plain"> </span><span class="token constant" style="color:rgb(189, 147, 249)">INTO</span><span class="token plain"> table </span><span class="token constant" style="color:rgb(189, 147, 249)">SELECT</span><span class="token plain"> </span><span class="token operator">*</span><span class="token plain"> </span><span class="token class-name">FROM</span><span class="token plain"> stage_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token constant" style="color:rgb(189, 147, 249)">COMMIT</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_Gfwi alert alert--info"><div class="admonitionHeading_f1Ed">Note</div><div class="admonitionContent_UjKb"><p>See doc: <a href="https://doris.apache.org/docs/3.0/data-operate/transaction/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/docs/3.0/data-operate/transaction/</a>
Currently, explicit transaction synchronization is not supported in Cross-Cluster Replication (CCR).</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-2-improved-observability">4-2. Improved observability<a href="https://doris.apache.org/blog/release-note-3.0.0#4-2-improved-observability" class="hash-link" aria-label="Direct link to 4-2. Improved observability" title="Direct link to 4-2. Improved observability">&#x200B;</a></h3>
<ul>
<li>
<p><strong>Real-time profile retrieval</strong>: In previous versions, due to issues with the execution plan or the data, some complex queries might have high computational requirements, so developers can only access the query profile for performance analysis after the completion of the query. This makes it hard to promptly identify issues in query execution to guarantee stability of the production environment. Now, with the ability to retrieve real-time profiles, V3.0 allows users to monitor query execution as the query is running. It also allows them to better monitor the progress of each ETL job.</p>
</li>
<li>
<p><strong><code>backend_active_tasks</code> system table</strong>: The <code>backend_active_tasks</code> system table provides real-time resource consumption information for each query on each BE node. Users can analyze this system table using SQL to obtain the resource usage of each query, which helps identify large queries or abnormal workloads.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-asynchronous-materialized-view">5. Asynchronous materialized view<a href="https://doris.apache.org/blog/release-note-3.0.0#5-asynchronous-materialized-view" class="hash-link" aria-label="Direct link to 5. Asynchronous materialized view" title="Direct link to 5. Asynchronous materialized view">&#x200B;</a></h2>
<p>In V3.0, asynchronous materialized view is faster and more stable. It is also more user-friendly for query acceleration and data modeling scenarios. We have restructured the logic for transparent rewrite and expanded its capabilities, making it 2X faster.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-1-refresh">5-1 Refresh<a href="https://doris.apache.org/blog/release-note-3.0.0#5-1-refresh" class="hash-link" aria-label="Direct link to 5-1 Refresh" title="Direct link to 5-1 Refresh">&#x200B;</a></h3>
<ul>
<li>
<p>Support for incremental update of materialized views by partitions and partition roll-ups on materialized views to allow refreshes at different granularities.</p>
</li>
<li>
<p>Support for nested materialized views, which is useful in data modeling scenarios.</p>
</li>
<li>
<p>Support for index creation and sort key specification in asynchronous materialized views, which will improve query performance after the materialized view is hit.</p>
</li>
<li>
<p>Higher usability of materialized view DDL with support for atomically replacing materialized views, allowing modifications to the materialized view definition SQL while keeping the materialized view available.</p>
</li>
<li>
<p>Support for non-deterministic functions in materialized views to better serve daily materialized view creation.</p>
</li>
<li>
<p>Support for trigger-based materialized view refresh, which ensures data consistency in data modeling with nested materialized views.</p>
</li>
<li>
<p>Support for a broader range of SQL patterns for building partitioned materialized views, making the incremental update capability available to more use cases.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-2-refresh-stability">5-2 Refresh stability<a href="https://doris.apache.org/blog/release-note-3.0.0#5-2-refresh-stability" class="hash-link" aria-label="Direct link to 5-2 Refresh stability" title="Direct link to 5-2 Refresh stability">&#x200B;</a></h3>
<ul>
<li>V3.0 supports specifying a Workload Group for building materialized views. This is to limit the resources used by the materialized view build process and ensure that sufficient resources remain available for ongoing queries.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-3-transparent-rewrite">5-3 Transparent rewrite<a href="https://doris.apache.org/blog/release-note-3.0.0#5-3-transparent-rewrite" class="hash-link" aria-label="Direct link to 5-3 Transparent rewrite" title="Direct link to 5-3 Transparent rewrite">&#x200B;</a></h3>
<ul>
<li>
<p>Support for transparent rewrite of more Join types, including derived Joins. Even when there is a mismatch of Join types between the query and materialized view, transparent rewrite can still be performed by compensating with additional predicates, as long as the materialized view can provide all the data needed for the query.</p>
</li>
<li>
<p>Support for more aggregate functions for roll-up as well as rewrite of multi-dimensional aggregations like GROUPING SETS, ROLLUP, and CUBE; support rewriting queries with aggregations when the materialized view does not contain aggregations, simplifying Join operations and expression computation.</p>
</li>
<li>
<p>Support for transparent rewrite of nested materialized views, enabling higher performance for complex queries.</p>
</li>
<li>
<p>For partially invalid partitioned materialized views, V3.0 supports <code>Union All</code> the base tables for data completion, expanding the applicability of partitioned materialized views.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-4-transparent-rewrite-performance">5-4 Transparent rewrite performance<a href="https://doris.apache.org/blog/release-note-3.0.0#5-4-transparent-rewrite-performance" class="hash-link" aria-label="Direct link to 5-4 Transparent rewrite performance" title="Direct link to 5-4 Transparent rewrite performance">&#x200B;</a></h3>
<ul>
<li>Continuous optimization has been done to improve the transparent rewrite performance, achieving 2X the speed compared to version 2.1.0.</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_Gfwi alert alert--info"><div class="admonitionHeading_f1Ed">Note</div><div class="admonitionContent_UjKb"><p>See doc:</p><p><a href="https://doris.apache.org/docs/3.0/query/view-materialized-view/query-async-materialized-view" target="_blank" rel="noopener noreferrer">https://doris.apache.org/docs/3.0/query/view-materialized-view/query-async-materialized-view</a></p><p><a href="https://doris.apache.org/docs/3.0/query/view-materialized-view/async-materialized-view/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/docs/3.0/query/view-materialized-view/async-materialized-view/</a></p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-performance-improvement">6. Performance improvement<a href="https://doris.apache.org/blog/release-note-3.0.0#6-performance-improvement" class="hash-link" aria-label="Direct link to 6. Performance improvement" title="Direct link to 6. Performance improvement">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-1-smarter-optimizer">6-1 Smarter optimizer<a href="https://doris.apache.org/blog/release-note-3.0.0#6-1-smarter-optimizer" class="hash-link" aria-label="Direct link to 6-1 Smarter optimizer" title="Direct link to 6-1 Smarter optimizer">&#x200B;</a></h3>
<p>In V3.0, the query optimizer has been enhanced in terms of framework capabilities, distributed plan support, optimizer infrastructure, and rule expansion. It provides better optimization capabilities for more complex and diverse business scenarios, with higher blind test performance for complex SQL:</p>
<ul>
<li>
<p><strong>Improved plan enumeration capability</strong>: The key structure Memo for plan enumeration has been restructured and normalized. This improves the efficiency of the Cascades framework in plan enumeration and the possibility of producing better plans. Additionally, it fixes incomplete column pruning during the Join Reorder process in older versions, which led to unnecessary overhead of the Join operator, thus improving the execution performance in the relevant scenarios.</p>
</li>
<li>
<p><strong>Improved distributed plan support</strong>: The distributed query plan has been enhanced to allow aggregation, join, and window function operations to more intelligently identify the data characteristics of intermediate computation results, avoiding ineffective data redistribution operations. Meanwhile, we have optimized the execution under the multi-replica continuous execution mode, making it more data cache-friendly.</p>
</li>
<li>
<p><strong>Improved optimizer infrastructure</strong>: V3 has fixed several issues in cost model and statistics information estimation. The fixes to the cost model are more adaptable to the evolution of the execution engine, making the execution plan more stable compared to previous versions.</p>
</li>
<li>
<p><strong>Enhanced Runtime Filter plan support</strong>: On the basis of Join Runtime Filter, V3.0 has expanded the capability of the TopN Runtime Filter to achieve better performance in use cases that involve a TopN operator.</p>
</li>
<li>
<p><strong>Enriched optimization rule library</strong>: Based on user feedback and internal testing results, we have introduced optimization rules such as Intersect Reorder to enrich the rule set of the optimizer.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-2-self-adaptive-runtime-filter">6-2 Self-adaptive Runtime Filter<a href="https://doris.apache.org/blog/release-note-3.0.0#6-2-self-adaptive-runtime-filter" class="hash-link" aria-label="Direct link to 6-2 Self-adaptive Runtime Filter" title="Direct link to 6-2 Self-adaptive Runtime Filter">&#x200B;</a></h3>
<p>In previous versions, the generation of Runtime Filter relies on manual setting by users based on statistical information. However, inaccurate settings in certain cases could lead to performance instability.</p>
<p>In V3.0, Doris implements a self-adaptive Runtime Filter calculation approach. It can estimate the Runtime Filter at runtime based on the data size with high accuracy, enabling better performance in use cases with large data volumes and high workloads.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-3-function-performance-optimization">6-3 Function performance optimization<a href="https://doris.apache.org/blog/release-note-3.0.0#6-3-function-performance-optimization" class="hash-link" aria-label="Direct link to 6-3 Function performance optimization" title="Direct link to 6-3 Function performance optimization">&#x200B;</a></h3>
<ul>
<li>V3.0 has improved the vectorized implementation of dozens of functions, enabling a performance improvement of over 50% for some commonly used functions.</li>
<li>V3.0 has also made extensive optimizations to the aggregation of nullable data types, enabling a 30% performance improvement.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-4-blind-test-performance-improvement">6-4 Blind test performance improvement<a href="https://doris.apache.org/blog/release-note-3.0.0#6-4-blind-test-performance-improvement" class="hash-link" aria-label="Direct link to 6-4 Blind test performance improvement" title="Direct link to 6-4 Blind test performance improvement">&#x200B;</a></h3>
<p>Our blind tests on V3.0 and V2.1 show that the new version is 7.3% and 6.2% faster in TPC-DS and TPC-H benchmark tests, respectively.</p>
<p><img decoding="async" loading="lazy" alt="Blind test performance improvement" src="https://cdnd.selectdb.com/assets/images/blind-test-performance-improvement-f09420ba8b50be53ab8eb1c410f3f3fd.png" width="1280" height="823" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-new-features">7. New features<a href="https://doris.apache.org/blog/release-note-3.0.0#7-new-features" class="hash-link" aria-label="Direct link to 7. New features" title="Direct link to 7. New features">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-1-java-udtf">7-1 Java UDTF<a href="https://doris.apache.org/blog/release-note-3.0.0#7-1-java-udtf" class="hash-link" aria-label="Direct link to 7-1 Java UDTF" title="Direct link to 7-1 Java UDTF">&#x200B;</a></h3>
<p>Version 3.0 has added support for Java UDTFs. The key operations are as follows:</p>
<ul>
<li>
<p>Implementing a UDTF: Similar to a UDF, a UDTF requires the user to implement an <code>evaluate</code> method. Note that the return value of a UDTF function must be of the <code>Array</code> data type.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token plain"> class UDTFStringTest {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token plain"> ArrayList</span><span class="token operator">&lt;</span><span class="token plain">String</span><span class="token operator">&gt;</span><span class="token plain"> evaluate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">String </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> String separator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">value</span><span class="token plain"> </span><span class="token operator">=</span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">null</span><span class="token plain"> </span><span class="token operator">||</span><span class="token plain"> separator </span><span class="token operator">=</span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token boolean">null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> new ArrayList</span><span class="token operator">&lt;&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Arrays</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">asList</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">split</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">separator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
</li>
<li>
<p>Creating a UDTF: By default, two corresponding functions will be created - <code>java-utdf</code>and <code>java-utdf_outer</code>. The <code>_outer</code> suffix adds a single row of <code>NULL</code> data when the table function generates 0 rows of output.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLES</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">FUNCTION</span><span class="token plain"> java</span><span class="token operator">-</span><span class="token plain">utdf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">RETURNS</span><span class="token plain"> array</span><span class="token operator">&lt;</span><span class="token plain">string</span><span class="token operator">&gt;</span><span class="token plain"> PROPERTIES </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;file&quot;</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;file:///pathTo/java-udaf.jar&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;symbol&quot;</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;org.apache.doris.udf.demo.UDTFStringTest&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;always_nullable&quot;</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;type&quot;</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;JAVA_UDF&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_Gfwi alert alert--info"><div class="admonitionHeading_f1Ed">info</div><div class="admonitionContent_UjKb"><p>See doc: <a href="https://doris.apache.org/docs/3.0/query/udf/java-user-defined-function/#udtf-1" target="_blank" rel="noopener noreferrer">https://doris.apache.org/docs/3.0/query/udf/java-user-defined-function/#udtf-1</a></p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-2-generated-column">7-2 Generated column<a href="https://doris.apache.org/blog/release-note-3.0.0#7-2-generated-column" class="hash-link" aria-label="Direct link to 7-2 Generated column" title="Direct link to 7-2 Generated column">&#x200B;</a></h3>
<p>A generated column is a special column whose value is calculated from the values of other columns rather than directly inserted or updated by the user. It supports pre-computing the results of expressions and storing them in the database, which is suitable for scenarios that require frequent queries or complex calculations.</p>
<p>Results can be automatically calculated based on predefined expressions when data is imported or updated, and then stored persistently. In this way, during subsequent queries, the system can directly access these calculated results without performing complex calculations, thereby improving query performance.</p>
<p>Generated columns are supported since V3.0. When creating a table, you can specify a column as generated column. A generated column automatically calculates values based on the defined expression when data is written. Generated columns allow for more complex expressions to be defined, but the value cannot be explicitly written or set.</p>
<div class="theme-admonition theme-admonition-info admonition_Gfwi alert alert--info"><div class="admonitionHeading_f1Ed">info</div><div class="admonitionContent_UjKb"><p>See doc: <a href="https://doris.apache.org/docs/3.0/sql-manual/sql-statements/Data-Definition-Statements/Create/CREATE-TABLE-AND-GENERATED-COLUMN/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/docs/3.0/sql-manual/sql-statements/Data-Definition-Statements/Create/CREATE-TABLE-AND-GENERATED-COLUMN/</a></p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-functional-improvements">8. Functional improvements<a href="https://doris.apache.org/blog/release-note-3.0.0#8-functional-improvements" class="hash-link" aria-label="Direct link to 8. Functional improvements" title="Direct link to 8. Functional improvements">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="8-1-materialized-view">8-1. Materialized view<a href="https://doris.apache.org/blog/release-note-3.0.0#8-1-materialized-view" class="hash-link" aria-label="Direct link to 8-1. Materialized view" title="Direct link to 8-1. Materialized view">&#x200B;</a></h3>
<p>We have refactored the selection logic for materialized views and migrated it from the rule-based optimizer (RBO) to the cost-based optimizer (CBO). This aligns the selection logic with that of asynchronous materialized views. This functionality is enabled by default. If any issues are encountered, you can revert to the RBO mode using <code>set global enable_sync_mv_cost_based_rewrite = false</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="8-2-routine-load">8-2. Routine Load<a href="https://doris.apache.org/blog/release-note-3.0.0#8-2-routine-load" class="hash-link" aria-label="Direct link to 8-2. Routine Load" title="Direct link to 8-2. Routine Load">&#x200B;</a></h3>
<p>In previous versions, the Routine Load functionality faced some usability challenges, such as uneven task scheduling across BE nodes, untimely task scheduling, complex configuration requirements (the need to change multiple FE and BE settings for optimization), insufficient overall stability (where restarts or upgrades could frequently pause Routine Load jobs, requiring manual user intervention to resume).</p>
<p>To address these issues, we have made extensive optimizations to the Routine Load feature:</p>
<ul>
<li>
<p><strong>Resource scheduling</strong>: We have improved the scheduling balance to make sure that tasks are more evenly distributed across BE nodes. Jobs that encounter unrepairable errors will be promptly paused to avoid wasting resources on futile scheduling attempts. Additionally, we have improved the timeliness of the scheduling process, which has enhanced the import performance of Routine Load.</p>
</li>
<li>
<p><strong>Parameter configuration</strong>: Users in most environments no longer need to modify FE and BE configurations for optimization. An automatic adjustment mechanism with timeout parameter has been introduced to prevent tasks from constantly retrying when cluster pressure increases.</p>
</li>
<li>
<p><strong>Stability</strong>: We have enhanced the robustness of Doris in various exceptional scenarios, such as FE failovers, BE rolling upgrades, and Kafka cluster anomalies, ensuring continuous stable operation. We have also optimized the Auto Resume mechanism, allowing Routine Load to automatically resume operation after faults are repaired, reducing the need for manual user intervention.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="9-behavior-changed">9. Behavior changed<a href="https://doris.apache.org/blog/release-note-3.0.0#9-behavior-changed" class="hash-link" aria-label="Direct link to 9. Behavior changed" title="Direct link to 9. Behavior changed">&#x200B;</a></h2>
<ul>
<li>
<p><code>cpu_resource_limit</code> will no longer be supported, and all types of resource isolation will be implemented through Workload Groups.</p>
</li>
<li>
<p>Please use JDK 17 for Apache Doris 3.0 and later versions. The recommended version being <code>jdk-17.0.10_linux-x64_bin.tar.gz</code>.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="try-apache-doris-30-now">Try Apache Doris 3.0 now!<a href="https://doris.apache.org/blog/release-note-3.0.0#try-apache-doris-30-now" class="hash-link" aria-label="Direct link to Try Apache Doris 3.0 now!" title="Direct link to Try Apache Doris 3.0 now!">&#x200B;</a></h2>
<p>Before the official release of version 3.0, the compute-storage decoupled mode of Apache Doris has undergone nearly two years of extensive testing and optimization in the production environments of hundreds of enterprises. Contributors from many tech giants have collaborated with the community to provide a significant number of test cases based on their real-world business needs. This has rigorously validated the usability and stability of version 3.0.</p>
<p>We highly recommend users with compute-storage decoupling needs to download version 3.0 and experience it firsthand.</p>
<p>Going forward, we will accelerate our release iteration cycle to deliver a more stable version experience for all users. Feel free to join us in the <a href="https://join.slack.com/t/apachedoriscommunity/shared_invite/zt-2gmq5o30h-455W226d79zP3L96ZhXIoQ" target="_blank" rel="noopener noreferrer">Apache Doris community</a> and engage directly with the core developers.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="credits">Credits<a href="https://doris.apache.org/blog/release-note-3.0.0#credits" class="hash-link" aria-label="Direct link to Credits" title="Direct link to Credits">&#x200B;</a></h2>
<p>Special thanks to the following contributors who participated in the development, testing, and provided feedback for this version:</p>
<p>@133tosakarin&#x3001;@390008457&#x3001;@924060929&#x3001;@AcKing-Sam&#x3001;@AshinGau&#x3001;@BePPPower&#x3001;@BiteTheDDDDt&#x3001;@ByteYue&#x3001;@CSTGluigi&#x3001;@CalvinKirs&#x3001;@Ceng23333&#x3001;@DarvenDuan&#x3001;@DongLiang-0&#x3001;@Doris-Extras&#x3001;@Dragonliu2018&#x3001;@Emor-nj&#x3001;@FreeOnePlus&#x3001;@Gabriel39&#x3001;@GoGoWen&#x3001;@HappenLee&#x3001;@HowardQin&#x3001;@Hyman-zhao&#x3001;@INNOCENT-BOY&#x3001;@JNSimba&#x3001;@JackDrogon&#x3001;@Jibing-Li&#x3001;@KassieZ&#x3001;@Lchangliang&#x3001;@LemonLiTree&#x3001;@LiBinfeng-01&#x3001;@LompleZ&#x3001;@M1saka2003&#x3001;@Mryange&#x3001;@Nitin-Kashyap&#x3001;@On-Work-Song&#x3001;@SWJTU-ZhangLei&#x3001;@StarryVerse&#x3001;@TangSiyang2001&#x3001;@Tech-Circle-48&#x3001;@Thearas&#x3001;@Vallishp&#x3001;@WinkerDu&#x3001;@XieJiann&#x3001;@XuJianxu&#x3001;@XuPengfei-1020&#x3001;@Yukang-Lian&#x3001;@Yulei-Yang&#x3001;@Z-SWEI&#x3001;@ZhongJinHacker&#x3001;@adonis0147&#x3001;@airborne12&#x3001;@allenhooo&#x3001;@amorynan&#x3001;@bingquanzhao&#x3001;@biohazard4321&#x3001;@bobhan1&#x3001;@caiconghui&#x3001;@cambyzju&#x3001;@caoliang-web&#x3001;@catpineapple&#x3001;@cjj2010&#x3001;@csun5285&#x3001;@dataroaring&#x3001;@deardeng&#x3001;@dongsilun&#x3001;@dutyu&#x3001;@echo-hhj&#x3001;@eldenmoon&#x3001;@elvestar&#x3001;@englefly&#x3001;@feelshana&#x3001;@feifeifeimoon&#x3001;@feiniaofeiafei&#x3001;@felixwluo&#x3001;@freemandealer&#x3001;@gavinchou&#x3001;@ghkang98&#x3001;@gnehil&#x3001;@hechao-ustc&#x3001;@hello-stephen&#x3001;@httpshirley&#x3001;@hubgeter&#x3001;@hust-hhb&#x3001;@iszhangpch&#x3001;@iwanttobepowerful&#x3001;@ixzc&#x3001;@jacktengg&#x3001;@jackwener&#x3001;@jeffreys-cat&#x3001;@kaijchen&#x3001;@kaka11chen&#x3001;@kindred77&#x3001;@koarz&#x3001;@kobe6th&#x3001;@kylinmac&#x3001;@larshelge&#x3001;@liaoxin01&#x3001;@lide-reed&#x3001;@liugddx&#x3001;@liujiwen-up&#x3001;@liutang123&#x3001;@lsy3993&#x3001;@luwei16&#x3001;@luzhijing&#x3001;@lxliyou001&#x3001;@mongo360&#x3001;@morningman&#x3001;@morrySnow&#x3001;@mrhhsg&#x3001;@my-vegetable-has-exploded&#x3001;@mymeiyi&#x3001;@nanfeng1999&#x3001;@nextdreamblue&#x3001;@pingchunzhang&#x3001;@platoneko&#x3001;@py023&#x3001;@qidaye&#x3001;@qzsee&#x3001;@raboof&#x3001;@rohitrs1983&#x3001;@rotkang&#x3001;@ryanzryu&#x3001;@seawinde&#x3001;@shoothzj&#x3001;@shuke987&#x3001;@sjyango&#x3001;@smallhibiscus&#x3001;@sollhui&#x3001;@sollhui&#x3001;@spaces-X&#x3001;@stalary&#x3001;@starocean999&#x3001;@superdiaodiao&#x3001;@suxiaogang223&#x3001;@taptao&#x3001;@vhwzx&#x3001;@vinlee19&#x3001;@w41ter&#x3001;@wangbo&#x3001;@wangshuo128&#x3001;@whutpencil&#x3001;@wsjz&#x3001;@wuwenchi&#x3001;@wyxxxcat&#x3001;@xiaokang&#x3001;@xiedeyantu&#x3001;@xiedeyantu&#x3001;@xingyingone&#x3001;@xinyiZzz&#x3001;@xy720&#x3001;@xzj7019&#x3001;@yagagagaga&#x3001;@yiguolei&#x3001;@yongjinhou&#x3001;@ytwp&#x3001;@yuanyuan8983&#x3001;@yujun777&#x3001;@yuxuan-luo&#x3001;@zclllyybb&#x3001;@zddr&#x3001;@zfr9527&#x3001;@zgxme&#x3001;@zhangbutao&#x3001;@zhangstar333&#x3001;@zhannngchen&#x3001;@zhiqiang-hhhh&#x3001;@ziyanTOP&#x3001;@zxealous&#x3001;@zy-kkk&#x3001;@zzzxl1993&#x3001;@zzzzzzzs</p></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Release Notes" term="Release Notes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Apache Doris 3.0.2 just released]]></title>
        <id>https://doris.apache.org/blog/release-note-3.0.2</id>
        <link href="https://doris.apache.org/blog/release-note-3.0.2"/>
        <updated>2024-10-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this version, Apache Doris has improvements in compute-storage decoupling, data storage, lakehouse, query optimizer, query execution and more.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Release Notes</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Apache Doris 3.0.2 just released</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-10-15T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">October 15, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Dear community members, the Apache Doris 3.0.2 version was officially released on October 15, 2024, featuring updates and improvements in compute-storage decoupling, data storage, lakehouse, query optimizer, query execution and more.</p>
<p><strong>Quick Download:</strong> <a href="https://doris.apache.org/download/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/download/</a></p>
<p><strong>GitHub Release:</strong> <a href="https://github.com/apache/doris/releases" target="_blank" rel="noopener noreferrer">https://github.com/apache/doris/releases</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="behavioral-changes">Behavioral Changes<a href="https://doris.apache.org/blog/release-note-3.0.2#behavioral-changes" class="hash-link" aria-label="Direct link to Behavioral Changes" title="Direct link to Behavioral Changes">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage">Storage<a href="https://doris.apache.org/blog/release-note-3.0.2#storage" class="hash-link" aria-label="Direct link to Storage" title="Direct link to Storage">&#x200B;</a></h3>
<ul>
<li>Limited the number of tablets in a single backup task to prevent FE memory overflow. <a href="https://github.com/apache/doris/pull/40518" target="_blank" rel="noopener noreferrer">#40518</a></li>
<li>The <code>SHOW PARTITIONS</code> command now displays the <code>CommittedVersion</code> of partitions. <a href="https://github.com/apache/doris/pull/28274" target="_blank" rel="noopener noreferrer">#28274</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other">Other<a href="https://doris.apache.org/blog/release-note-3.0.2#other" class="hash-link" aria-label="Direct link to Other" title="Direct link to Other">&#x200B;</a></h3>
<ul>
<li>The default printing mode (asynchronous) of <code>fe.log</code> now includes file line number information. If performance issues are encountered due to line number output, please switch to BRIEF mode. <a href="https://github.com/apache/doris/pull/39419" target="_blank" rel="noopener noreferrer">#39419</a></li>
<li>The default value of the session variable <code>ENABLE_PREPARED_STMT_AUDIT_LOG</code> has been changed from <code>true</code> to <code>false</code>, and the audit log of prepare statements will no longer be printed. <a href="https://github.com/apache/doris/pull/38865" target="_blank" rel="noopener noreferrer">#38865</a></li>
<li>The default value of the session variable <code>max_allowed_packet</code> has been adjusted from 1MB to 16MB to align with MySQL 8.4. <a href="https://github.com/apache/doris/pull/38697" target="_blank" rel="noopener noreferrer">#38697</a></li>
<li>The JVM of FE and BE defaults to using the UTF-8 character set. <a href="https://github.com/apache/doris/pull/39521" target="_blank" rel="noopener noreferrer">#39521</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-features">New Features<a href="https://doris.apache.org/blog/release-note-3.0.2#new-features" class="hash-link" aria-label="Direct link to New Features" title="Direct link to New Features">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-1">Storage<a href="https://doris.apache.org/blog/release-note-3.0.2#storage-1" class="hash-link" aria-label="Direct link to Storage" title="Direct link to Storage">&#x200B;</a></h3>
<ul>
<li>Backup and recovery now support clearing tables or partitions that are not in the backup. <a href="https://github.com/apache/doris/pull/39028" target="_blank" rel="noopener noreferrer">#39028</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compute-storage-decoupled">Compute-Storage Decoupled<a href="https://doris.apache.org/blog/release-note-3.0.2#compute-storage-decoupled" class="hash-link" aria-label="Direct link to Compute-Storage Decoupled" title="Direct link to Compute-Storage Decoupled">&#x200B;</a></h3>
<ul>
<li>Support for parallel recycling of expired data on multiple tablets. <a href="https://github.com/apache/doris/pull/37630" target="_blank" rel="noopener noreferrer">#37630</a></li>
<li>Support for changing storage vaults through <code>ALTER</code> statements. <a href="https://github.com/apache/doris/pull/38685" target="_blank" rel="noopener noreferrer">#38685</a>  <a href="https://github.com/apache/doris/pull/37606" target="_blank" rel="noopener noreferrer">#37606</a></li>
<li>Support for importing a large number of tablets (5000+) in a single transaction (experimental feature). <a href="https://github.com/apache/doris/pull/38243" target="_blank" rel="noopener noreferrer">#38243</a></li>
<li>Support for automatically aborting pending transactions caused by reasons such as node restarts, solving the issue of pending transactions blocking decommission or schema change. <a href="https://github.com/apache/doris/pull/37669" target="_blank" rel="noopener noreferrer">#37669</a></li>
<li>A new session variable <code>enable_segment_cache</code> has been added to control whether to use segment cache during queries (default is <code>true</code>). <a href="https://github.com/apache/doris/pull/37141" target="_blank" rel="noopener noreferrer">#37141</a></li>
<li>Resolved the issue of not being able to import a large amount of data during schema changes in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/39558" target="_blank" rel="noopener noreferrer">#39558</a></li>
<li>Support for adding multiple follower roles of FE in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/38388" target="_blank" rel="noopener noreferrer">#38388</a></li>
<li>Support for using memory as file cache to accelerate queries in environments with no disks or low-performance HDDs. <a href="https://github.com/apache/doris/pull/38811" target="_blank" rel="noopener noreferrer">#38811</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse">Lakehouse<a href="https://doris.apache.org/blog/release-note-3.0.2#lakehouse" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>New Lakesoul Catalog has been added. <a href="https://doris.apache.org/zh-CN/docs/dev/lakehouse/datalake-analytics/lakesoul" target="_blank" rel="noopener noreferrer">Apache Doris Docs</a></li>
<li>A new system table <code>catalog_meta_cache_statistics</code> has been added to view the usage of various metadata caches in external catalog. <a href="https://github.com/apache/doris/pull/40155" target="_blank" rel="noopener noreferrer">#40155</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer">Query Optimizer<a href="https://doris.apache.org/blog/release-note-3.0.2#query-optimizer" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>Support for <code>is [not] true/false</code> expressions. <a href="https://github.com/apache/doris/pull/38623" target="_blank" rel="noopener noreferrer">#38623</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution">Query Execution<a href="https://doris.apache.org/blog/release-note-3.0.2#query-execution" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>A new CRC32 function has been added. <a href="https://github.com/apache/doris/pull/38204" target="_blank" rel="noopener noreferrer">#38204</a></li>
<li>New aggregate functions skew and kurt have been added. <a href="https://github.com/apache/doris/pull/41277" target="_blank" rel="noopener noreferrer">#41277</a></li>
<li>Profiles are now persisted to the FE&apos;s disk to retain more profiles. <a href="https://github.com/apache/doris/pull/33690" target="_blank" rel="noopener noreferrer">#33690</a></li>
<li>A new system table <code>workload_group_privileges</code> has been added to view permission information related to workload groups. <a href="https://github.com/apache/doris/pull/38436" target="_blank" rel="noopener noreferrer">#38436</a></li>
<li>A new system table <code>workload_group_resource_usage</code> has been added to monitor resource statistics of workload groups. <a href="https://github.com/apache/doris/pull/39177" target="_blank" rel="noopener noreferrer">#39177</a></li>
<li>Workload groups now support limiting reads of local IO and remote IO. <a href="https://github.com/apache/doris/pull/39012" target="_blank" rel="noopener noreferrer">#39012</a></li>
<li>Workload groups now support cgroupv2 to limit CPU usage. <a href="https://github.com/apache/doris/pull/39374" target="_blank" rel="noopener noreferrer">#39374</a></li>
<li>A new system table <code>information_schema.partitions</code> has been added to view some table creation attributes. <a href="https://github.com/apache/doris/pull/40636" target="_blank" rel="noopener noreferrer">#40636</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-1">Other<a href="https://doris.apache.org/blog/release-note-3.0.2#other-1" class="hash-link" aria-label="Direct link to Other" title="Direct link to Other">&#x200B;</a></h3>
<ul>
<li>Support for using the <code>SHOW</code> statement to display BE&apos;s configuration information, such as <code>SHOW BACKEND CONFIG LIKE ${pattern}</code>. <a href="https://github.com/apache/doris/pull/36525" target="_blank" rel="noopener noreferrer">#36525</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="https://doris.apache.org/blog/release-note-3.0.2#improvements" class="hash-link" aria-label="Direct link to Improvements" title="Direct link to Improvements">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="load">Load<a href="https://doris.apache.org/blog/release-note-3.0.2#load" class="hash-link" aria-label="Direct link to Load" title="Direct link to Load">&#x200B;</a></h3>
<ul>
<li>Improved the import efficiency of routine load when encountering frequent EOFs from Kafka. <a href="https://github.com/apache/doris/pull/39975" target="_blank" rel="noopener noreferrer">#39975</a></li>
<li>The stream load result now includes the time taken to read HTTP data, <code>ReceiveDataTimeMs</code>, which can quickly determine slow stream load issues caused by network reasons. <a href="https://github.com/apache/doris/pull/40735" target="_blank" rel="noopener noreferrer">#40735</a></li>
<li>Optimized the routine load timeout logic to avoid frequent timeouts during inverted index and mow writes. <a href="https://github.com/apache/doris/pull/40818" target="_blank" rel="noopener noreferrer">#40818</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-2">Storage<a href="https://doris.apache.org/blog/release-note-3.0.2#storage-2" class="hash-link" aria-label="Direct link to Storage" title="Direct link to Storage">&#x200B;</a></h3>
<ul>
<li>Support for batch addition of partitions. <a href="https://github.com/apache/doris/pull/37114" target="_blank" rel="noopener noreferrer">#37114</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compute-storage-decoupled-1">Compute-Storage Decoupled<a href="https://doris.apache.org/blog/release-note-3.0.2#compute-storage-decoupled-1" class="hash-link" aria-label="Direct link to Compute-Storage Decoupled" title="Direct link to Compute-Storage Decoupled">&#x200B;</a></h3>
<ul>
<li>Added the meta-service HTTP interface <code>/MetaService/http/show_meta_ranges</code> to facilitate the statistics of KV distribution in FDB. <a href="https://github.com/apache/doris/pull/39208" target="_blank" rel="noopener noreferrer">#39208</a></li>
<li>The meta-service/recycler stop script ensures that the process fully exits before returning. <a href="https://github.com/apache/doris/pull/40218" target="_blank" rel="noopener noreferrer">#40218</a></li>
<li>Support for using the session variable <code>version_comment</code> (Cloud Mode) to display the current deployment mode as compute-storage decoupled. <a href="https://github.com/apache/doris/pull/38269" target="_blank" rel="noopener noreferrer">#38269</a></li>
<li>Fixed the detailed message returned when transaction submission fails. <a href="https://github.com/apache/doris/pull/40584" target="_blank" rel="noopener noreferrer">#40584</a></li>
<li>Support for using one meta-service process to provide both metadata services and data recycling services. <a href="https://github.com/apache/doris/pull/40223" target="_blank" rel="noopener noreferrer">#40223</a></li>
<li>Optimized the default configuration of file_cache to avoid potential issues when not set. <a href="https://github.com/apache/doris/pull/41421" target="_blank" rel="noopener noreferrer">#41421</a>  <a href="https://github.com/apache/doris/pull/41507" target="_blank" rel="noopener noreferrer">#41507</a></li>
<li>Improved query performance by batch retrieving the version of multiple partitions. <a href="https://github.com/apache/doris/pull/38949" target="_blank" rel="noopener noreferrer">#38949</a></li>
<li>Delayed the redistribution of tablets to avoid query performance issues caused by temporary network fluctuations. <a href="https://github.com/apache/doris/pull/40371" target="_blank" rel="noopener noreferrer">#40371</a></li>
<li>Optimized the read-write lock logic in the balance. <a href="https://github.com/apache/doris/pull/40633" target="_blank" rel="noopener noreferrer">#40633</a></li>
<li>Enhanced the robustness of file cache in handling TTL filenames during restarts/crashes. <a href="https://github.com/apache/doris/pull/40226" target="_blank" rel="noopener noreferrer">#40226</a></li>
<li>Added the BE HTTP interface <code>/api/file_cache?op=hash</code> to facilitate the calculation of the hash file names of segment files on disk. <a href="https://github.com/apache/doris/pull/40831" target="_blank" rel="noopener noreferrer">#40831</a></li>
<li>Optimized the unified naming to be compatible with using compute group to represent BE groups (original cloud cluster). <a href="https://github.com/apache/doris/pull/40767" target="_blank" rel="noopener noreferrer">#40767</a></li>
<li>Optimized the waiting time for obtaining locks when calculating delete bitmaps in primary key tables. <a href="https://github.com/apache/doris/pull/40341" target="_blank" rel="noopener noreferrer">#40341</a></li>
<li>When there are many delete bitmaps in primary key tables, optimized the high CPU consumption during queries by pre-merging multiple delete bitmaps. <a href="https://github.com/apache/doris/pull/40204" target="_blank" rel="noopener noreferrer">#40204</a></li>
<li>Support for managing FE/BE nodes in compute-storage decoupled mode through SQL statements, hiding the logic of direct interaction with meta-service when deploying in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/40264" target="_blank" rel="noopener noreferrer">#40264</a></li>
<li>Added a script for rapid deployment of FDB. <a href="https://github.com/apache/doris/pull/39803" target="_blank" rel="noopener noreferrer">#39803</a></li>
<li>Optimized the output of <code>SHOW CACHE HOTSPOT</code> to unify the column name style with other <code>SHOW</code> statements. <a href="https://github.com/apache/doris/pull/41322" target="_blank" rel="noopener noreferrer">#41322</a></li>
<li>When using a storage vault as the storage backend, disallowed the use of <code>latest_fs()</code> to avoid binding different storage backends to the same table. <a href="https://github.com/apache/doris/pull/40516" target="_blank" rel="noopener noreferrer">#40516</a></li>
<li>Optimized the timeout strategy for calculating delete bitmaps when importing mow tables. <a href="https://github.com/apache/doris/pull/40562" target="_blank" rel="noopener noreferrer">#40562</a>  <a href="https://github.com/apache/doris/pull/40333" target="_blank" rel="noopener noreferrer">#40333</a></li>
<li>The enable_file_cache in be.conf is now enabled by default in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/41502" target="_blank" rel="noopener noreferrer">#41502</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse-1">Lakehouse<a href="https://doris.apache.org/blog/release-note-3.0.2#lakehouse-1" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>When reading tables in CSV format, support for the session <code>keep_carriage_return</code> setting to control the reading behavior of the <code>\r</code> symbol. <a href="https://github.com/apache/doris/pull/39980" target="_blank" rel="noopener noreferrer">#39980</a></li>
<li>The default maximum memory of BE&apos;s JVM has been adjusted to 2GB (affecting only new deployments). <a href="https://github.com/apache/doris/pull/41403" target="_blank" rel="noopener noreferrer">#41403</a></li>
<li>Hive Catalog has added <code>hive.recursive_directories_table</code> and <code>hive.ignore_absent_partitions</code> properties to specify whether to recursively traverse data directories and whether to ignore missing partitions. <a href="https://github.com/apache/doris/pull/39494" target="_blank" rel="noopener noreferrer">#39494</a></li>
<li>Optimized the Catalog refresh logic to avoid generating a large number of connections during refresh. <a href="https://github.com/apache/doris/pull/39205" target="_blank" rel="noopener noreferrer">#39205</a></li>
<li><code>SHOW CREATE DATABASE</code> and <code>SHOW CREATE TABLE</code> for external data sources now display location information. <a href="https://github.com/apache/doris/pull/39179" target="_blank" rel="noopener noreferrer">#39179</a></li>
<li>The new optimizer supports inserting data into JDBC external tables using the <code>INSERT INTO</code> statement. <a href="https://github.com/apache/doris/pull/41511" target="_blank" rel="noopener noreferrer">#41511</a></li>
<li>MaxCompute Catalog now supports complex data types. <a href="https://github.com/apache/doris/pull/39259" target="_blank" rel="noopener noreferrer">#39259</a></li>
<li>Optimized the logic for reading and merging data shards of external tables. <a href="https://github.com/apache/doris/pull/38311" target="_blank" rel="noopener noreferrer">#38311</a></li>
<li>Optimized some refresh strategies for metadata caches of external tables. <a href="https://github.com/apache/doris/pull/38506" target="_blank" rel="noopener noreferrer">#38506</a></li>
<li>Paimon tables now support pushing down <code>IN/NOT IN</code> predicates. <a href="https://github.com/apache/doris/pull/38390" target="_blank" rel="noopener noreferrer">#38390</a></li>
<li>Compatible with tables created in Parquet format by Paimon version 0.9. <a href="https://github.com/apache/doris/pull/41020" target="_blank" rel="noopener noreferrer">#41020</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-materialized-views">Asynchronous Materialized Views<a href="https://doris.apache.org/blog/release-note-3.0.2#asynchronous-materialized-views" class="hash-link" aria-label="Direct link to Asynchronous Materialized Views" title="Direct link to Asynchronous Materialized Views">&#x200B;</a></h3>
<ul>
<li>Building asynchronous materialized views now supports the use of both immediate and starttime. <a href="https://github.com/apache/doris/pull/39573" target="_blank" rel="noopener noreferrer">#39573</a></li>
<li>Asynchronous materialized views based on external tables will refresh the metadata cache of the external tables before refreshing the materialized views, ensuring construction based on the latest external table data. <a href="https://github.com/apache/doris/pull/38212" target="_blank" rel="noopener noreferrer">#38212</a></li>
<li>Partition incremental construction now supports rolling up according to weekly and quarterly granularities. <a href="https://github.com/apache/doris/pull/39286" target="_blank" rel="noopener noreferrer">#39286</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer-1">Query Optimizer<a href="https://doris.apache.org/blog/release-note-3.0.2#query-optimizer-1" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>The aggregate function <code>GROUP_CONCAT</code> now supports the use of both <code>DISTINCT</code> and <code>ORDER BY</code>. <a href="https://github.com/apache/doris/pull/38080" target="_blank" rel="noopener noreferrer">#38080</a></li>
<li>Optimized the collection and use of statistical information, as well as the logic for estimating row counts and cost calculations, to generate more efficient and stable execution plans.</li>
<li>Window function partition data pre-filtering now supports cases containing multiple window functions. <a href="https://github.com/apache/doris/pull/38393" target="_blank" rel="noopener noreferrer">#38393</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution-1">Query Execution<a href="https://doris.apache.org/blog/release-note-3.0.2#query-execution-1" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>Reduced query latency by running prepare pipeline tasks in parallel. <a href="https://github.com/apache/doris/pull/40874" target="_blank" rel="noopener noreferrer">#40874</a></li>
<li>Display Catalog information in Profile. <a href="https://github.com/apache/doris/pull/38283" target="_blank" rel="noopener noreferrer">#38283</a></li>
<li>Optimized the computational performance of <code>IN</code> filtering conditions. <a href="https://github.com/apache/doris/pull/40917" target="_blank" rel="noopener noreferrer">#40917</a></li>
<li>Supported cgroupv2 in K8S to limit Doris&apos;s memory usage. <a href="https://github.com/apache/doris/pull/39256" target="_blank" rel="noopener noreferrer">#39256</a></li>
<li>Optimized the performance of converting strings to datetime types. <a href="https://github.com/apache/doris/pull/38385" target="_blank" rel="noopener noreferrer">#38385</a></li>
<li>When a <code>string</code> is a decimal number, support casting it to an <code>int</code>, which will be more compatible with certain behaviors of MySQL. <a href="https://github.com/apache/doris/pull/38847" target="_blank" rel="noopener noreferrer">#38847</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semi-structured-data-management">Semi-Structured Data Management<a href="https://doris.apache.org/blog/release-note-3.0.2#semi-structured-data-management" class="hash-link" aria-label="Direct link to Semi-Structured Data Management" title="Direct link to Semi-Structured Data Management">&#x200B;</a></h3>
<ul>
<li>Optimized the performance of inverted index matching. <a href="https://github.com/apache/doris/pull/41122" target="_blank" rel="noopener noreferrer">#41122</a></li>
<li>Temporarily prohibited the creation of inverted indexes with tokenization on arrays. <a href="https://github.com/apache/doris/pull/39062" target="_blank" rel="noopener noreferrer">#39062</a></li>
<li><code>explode_json_array</code> now supports binary JSON types. <a href="https://github.com/apache/doris/pull/37278" target="_blank" rel="noopener noreferrer">#37278</a></li>
<li>IP data types now support bloomfilter indexes. <a href="https://github.com/apache/doris/pull/39253" target="_blank" rel="noopener noreferrer">#39253</a></li>
<li>IP data types now support row storage. <a href="https://github.com/apache/doris/pull/39258" target="_blank" rel="noopener noreferrer">#39258</a></li>
<li>Nested data types such as ARRAY, MAP, and STRUCT now support schema changes. <a href="https://github.com/apache/doris/pull/39210" target="_blank" rel="noopener noreferrer">#39210</a></li>
<li>When creating MTMV, automatically truncate KEYs encountered in VARIANT data types. <a href="https://github.com/apache/doris/pull/39988" target="_blank" rel="noopener noreferrer">#39988</a></li>
<li>Lazy loading of inverted indexes during queries to improve performance. <a href="https://github.com/apache/doris/pull/38979" target="_blank" rel="noopener noreferrer">#38979</a></li>
<li><code>add inverted index file size for open file</code>. <a href="https://github.com/apache/doris/pull/37482" target="_blank" rel="noopener noreferrer">#37482</a></li>
<li>Reduced access to object storage interfaces during compaction to improve performance. <a href="https://github.com/apache/doris/pull/41079" target="_blank" rel="noopener noreferrer">#41079</a></li>
<li>Added three new query profile metrics related to inverted indexes. <a href="https://github.com/apache/doris/pull/36696" target="_blank" rel="noopener noreferrer">#36696</a></li>
<li>Reduced cache overhead for non-PreparedStatement SQL to improve performance. <a href="https://github.com/apache/doris/pull/40910" target="_blank" rel="noopener noreferrer">#40910</a></li>
<li>Pre-warming cache now supports inverted indexes. <a href="https://github.com/apache/doris/pull/38986" target="_blank" rel="noopener noreferrer">#38986</a></li>
<li>Inverted indexes are now cached immediately after writing. <a href="https://github.com/apache/doris/pull/39076" target="_blank" rel="noopener noreferrer">#39076</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compatibility">Compatibility<a href="https://doris.apache.org/blog/release-note-3.0.2#compatibility" class="hash-link" aria-label="Direct link to Compatibility" title="Direct link to Compatibility">&#x200B;</a></h3>
<ul>
<li>Fixed the issue of Thrift ID incompatibility on the master with branch-2.1. <a href="https://github.com/apache/doris/pull/41057" target="_blank" rel="noopener noreferrer">#41057</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-2">Other<a href="https://doris.apache.org/blog/release-note-3.0.2#other-2" class="hash-link" aria-label="Direct link to Other" title="Direct link to Other">&#x200B;</a></h3>
<ul>
<li>BE HTTP API now supports authentication; set config::enable_all_http_auth to true (default is false) when authentication is required. <a href="https://github.com/apache/doris/pull/39577" target="_blank" rel="noopener noreferrer">#39577</a></li>
<li>Optimized the user permissions required for the REFRESH operation. Permissions have been relaxed from ALTER to SHOW. <a href="https://github.com/apache/doris/pull/39008" target="_blank" rel="noopener noreferrer">#39008</a></li>
<li>Reduced the range of nextId when calling advanceNextId(). <a href="https://github.com/apache/doris/pull/40160" target="_blank" rel="noopener noreferrer">#40160</a></li>
<li>Optimized the caching mechanism for Java UDFs. <a href="https://github.com/apache/doris/pull/40404" target="_blank" rel="noopener noreferrer">#40404</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug Fixes<a href="https://doris.apache.org/blog/release-note-3.0.2#bug-fixes" class="hash-link" aria-label="Direct link to Bug Fixes" title="Direct link to Bug Fixes">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="load-1">Load<a href="https://doris.apache.org/blog/release-note-3.0.2#load-1" class="hash-link" aria-label="Direct link to Load" title="Direct link to Load">&#x200B;</a></h3>
<ul>
<li>Fixed the issue where <code>abortTransaction</code> did not handle return codes. <a href="https://github.com/apache/doris/pull/41275" target="_blank" rel="noopener noreferrer">#41275</a></li>
<li>Fixed the issue where transactions failed to commit or abort in compute-storage decoupled mode without calling <code>afterCommit/afterAbort</code>. <a href="https://github.com/apache/doris/pull/41267" target="_blank" rel="noopener noreferrer">#41267</a></li>
<li>Fixed the issue where Routine Load could not work properly when modifying consumer offsets in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/39159" target="_blank" rel="noopener noreferrer">#39159</a></li>
<li>Fixed the issue of repeatedly closing file handles when obtaining error log file paths. <a href="https://github.com/apache/doris/pull/41320" target="_blank" rel="noopener noreferrer">#41320</a></li>
<li>Fixed the issue of incorrect job progress caching for Routine Load in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/39313" target="_blank" rel="noopener noreferrer">#39313</a></li>
<li>Fixed the issue where Routine Load could get stuck when failing to commit transactions in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/40539" target="_blank" rel="noopener noreferrer">#40539</a></li>
<li>Fixed the issue where Routine Load kept reporting data quality check errors in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/39790" target="_blank" rel="noopener noreferrer">#39790</a></li>
<li>Fixed the issue where Routine Load did not check transactions before committing in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/39775" target="_blank" rel="noopener noreferrer">#39775</a></li>
<li>Fixed the issue where Routine Load did not check transactions before aborting in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/40463" target="_blank" rel="noopener noreferrer">#40463</a></li>
<li>Fixed the issue where cluster keys did not support certain data types. <a href="https://github.com/apache/doris/pull/38966" target="_blank" rel="noopener noreferrer">#38966</a></li>
<li>Fixed the issue of transactions being repeatedly committed. <a href="https://github.com/apache/doris/pull/39786" target="_blank" rel="noopener noreferrer">#39786</a></li>
<li>Fixed the issue of use after free with WAL when BE exits. <a href="https://github.com/apache/doris/pull/33131" target="_blank" rel="noopener noreferrer">#33131</a></li>
<li>Fixed the issue where WAL playback did not skip completed import transactions in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/41262" target="_blank" rel="noopener noreferrer">#41262</a></li>
<li>Fixed the logic for selecting BE in group commit in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/39986" target="_blank" rel="noopener noreferrer">#39986</a>  <a href="https://github.com/apache/doris/pull/38644" target="_blank" rel="noopener noreferrer">#38644</a></li>
<li>Fixed the issue where BE might crash when group commit was enabled for insert into. <a href="https://github.com/apache/doris/pull/39339" target="_blank" rel="noopener noreferrer">#39339</a></li>
<li>Fixed the issue where insert into with group commit enabled might get stuck. <a href="https://github.com/apache/doris/pull/39391" target="_blank" rel="noopener noreferrer">#39391</a></li>
<li>Fixed the issue where not enabling the group commit option during import might result in a table not found error. <a href="https://github.com/apache/doris/pull/39731" target="_blank" rel="noopener noreferrer">#39731</a></li>
<li>Fixed the issue of transaction submission timeouts due to too many tablets. <a href="https://github.com/apache/doris/pull/40031" target="_blank" rel="noopener noreferrer">#40031</a></li>
<li>Fixed the issue of concurrent opens with Auto Partition. <a href="https://github.com/apache/doris/pull/38605" target="_blank" rel="noopener noreferrer">#38605</a></li>
<li>Fixed the issue of import lock granularity being too large. <a href="https://github.com/apache/doris/pull/40134" target="_blank" rel="noopener noreferrer">#40134</a></li>
<li>Fixed the issue of coredumps caused by zero-length varchars. <a href="https://github.com/apache/doris/pull/40940" target="_blank" rel="noopener noreferrer">#40940</a></li>
<li>Fixed the issue of incorrect index Id values in log prints. <a href="https://github.com/apache/doris/pull/38790" target="_blank" rel="noopener noreferrer">#38790</a></li>
<li>Fixed the issue of memtable shifting not closing BRPC streaming. <a href="https://github.com/apache/doris/pull/40105" target="_blank" rel="noopener noreferrer">#40105</a></li>
<li>Fixed the issue of inaccurate bvar statistics during memtable shifting. <a href="https://github.com/apache/doris/pull/39075" target="_blank" rel="noopener noreferrer">#39075</a></li>
<li>Fixed the issue of multi-replication fault tolerance during memtable shifting. <a href="https://github.com/apache/doris/pull/38003" target="_blank" rel="noopener noreferrer">#38003</a></li>
<li>Fixed the issue of incorrect message length calculations for Routine Load with multiple tables in one stream. <a href="https://github.com/apache/doris/pull/40367" target="_blank" rel="noopener noreferrer">#40367</a></li>
<li>Fixed the issue of inaccurate progress reporting for Broker Load. <a href="https://github.com/apache/doris/pull/40325" target="_blank" rel="noopener noreferrer">#40325</a></li>
<li>Fixed the issue of inaccurate data scan volume reporting for Broker Load. <a href="https://github.com/apache/doris/pull/40694" target="_blank" rel="noopener noreferrer">#40694</a></li>
<li>Fixed the issue of concurrency with Routine Load in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/39242" target="_blank" rel="noopener noreferrer">#39242</a></li>
<li>Fixed the issue of Routine Load jobs being canceled in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/39514" target="_blank" rel="noopener noreferrer">#39514</a></li>
<li>Fixed the issue of progress not being reset when deleting Kafka topics. <a href="https://github.com/apache/doris/pull/38474" target="_blank" rel="noopener noreferrer">#38474</a></li>
<li>Fixed the issue of updating progress during transaction state transitions in Routine Load. <a href="https://github.com/apache/doris/pull/39311" target="_blank" rel="noopener noreferrer">#39311</a></li>
<li>Fixed the issue of Routine Load switching from a paused state to a paused state. <a href="https://github.com/apache/doris/pull/40728" target="_blank" rel="noopener noreferrer">#40728</a></li>
<li>Fixed the issue of Stream Load records being missed due to database deletion. <a href="https://github.com/apache/doris/pull/39360" target="_blank" rel="noopener noreferrer">#39360</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-3">Storage<a href="https://doris.apache.org/blog/release-note-3.0.2#storage-3" class="hash-link" aria-label="Direct link to Storage" title="Direct link to Storage">&#x200B;</a></h3>
<ul>
<li>Fixed the issue of missing storage policies. <a href="https://github.com/apache/doris/pull/38700" target="_blank" rel="noopener noreferrer">#38700</a></li>
<li>Fixed the issue of errors during cross-version backup and recovery. <a href="https://github.com/apache/doris/pull/38370" target="_blank" rel="noopener noreferrer">#38370</a></li>
<li>Fixed the NPE issue with ccr binlog. <a href="https://github.com/apache/doris/pull/39909" target="_blank" rel="noopener noreferrer">#39909</a></li>
<li>Fixed potential issues with duplicate keys in mow. <a href="https://github.com/apache/doris/pull/41309" target="_blank" rel="noopener noreferrer">#41309</a>  <a href="https://github.com/apache/doris/pull/39791" target="_blank" rel="noopener noreferrer">#39791</a>  <a href="https://github.com/apache/doris/pull/39958" target="_blank" rel="noopener noreferrer">#39958</a>  <a href="https://github.com/apache/doris/pull/38369" target="_blank" rel="noopener noreferrer">#38369</a>  <a href="https://github.com/apache/doris/pull/38331" target="_blank" rel="noopener noreferrer">#38331</a></li>
<li>Fixed the issue of not being able to write after backup and recovery in high-frequency write scenarios. <a href="https://github.com/apache/doris/pull/40118" target="_blank" rel="noopener noreferrer">#40118</a>  <a href="https://github.com/apache/doris/pull/38321" target="_blank" rel="noopener noreferrer">#38321</a></li>
<li>Fixed the issue of data errors potentially triggered by deleting empty strings and schema changes. <a href="https://github.com/apache/doris/pull/41064" target="_blank" rel="noopener noreferrer">#41064</a></li>
<li>Fixed the issue of incorrect statistics due to column updates. <a href="https://github.com/apache/doris/pull/40880" target="_blank" rel="noopener noreferrer">#40880</a></li>
<li>Limited the size of tablet meta pb to prevent BE crashes due to oversized meta. <a href="https://github.com/apache/doris/pull/39455" target="_blank" rel="noopener noreferrer">#39455</a></li>
<li>Fixed the potential column misalignment issue with the new optimizer in <code>begin; insert into values; commit</code>. <a href="https://github.com/apache/doris/pull/39295" target="_blank" rel="noopener noreferrer">#39295</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compute-storage-decoupled-2">Compute-Storage Decoupled<a href="https://doris.apache.org/blog/release-note-3.0.2#compute-storage-decoupled-2" class="hash-link" aria-label="Direct link to Compute-Storage Decoupled" title="Direct link to Compute-Storage Decoupled">&#x200B;</a></h3>
<ul>
<li>Fixed the issue where the tablet distribution might be inconsistent across multiple FEs in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/41458" target="_blank" rel="noopener noreferrer">#41458</a></li>
<li>Fixed the issue where TVF might not work in multi-computing group environments. <a href="https://github.com/apache/doris/pull/39249" target="_blank" rel="noopener noreferrer">#39249</a></li>
<li>Fixed the issue where compaction used resources that had already been released when BE exited in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/39302" target="_blank" rel="noopener noreferrer">#39302</a></li>
<li>Fixed the issue where automatic start-stop might cause FE replay to get stuck. <a href="https://github.com/apache/doris/pull/40027" target="_blank" rel="noopener noreferrer">#40027</a></li>
<li>Fixed the issue where the BE status and the stored status in meta-service were inconsistent. <a href="https://github.com/apache/doris/pull/40799" target="_blank" rel="noopener noreferrer">#40799</a></li>
<li>Fixed the issue where the FE-&gt;meta-service connection pool could not automatically expire and reconnect. <a href="https://github.com/apache/doris/pull/41202" target="_blank" rel="noopener noreferrer">#41202</a>  <a href="https://github.com/apache/doris/pull/40661" target="_blank" rel="noopener noreferrer">#40661</a></li>
<li>Fixed the issue where some tablets might repeatedly undergo unexpected balance processes during rebalance. <a href="https://github.com/apache/doris/pull/39792" target="_blank" rel="noopener noreferrer">#39792</a></li>
<li>Fixed the issue where storage vault permissions were lost after FE restarted. <a href="https://github.com/apache/doris/pull/40260" target="_blank" rel="noopener noreferrer">#40260</a></li>
<li>Fixed the issue where tablet row counts and other statistical information might be incomplete due to FDB scan range pagination. <a href="https://github.com/apache/doris/pull/40494" target="_blank" rel="noopener noreferrer">#40494</a></li>
<li>Fixed the performance issue caused by a large number of aborted transactions associated with the same label. <a href="https://github.com/apache/doris/pull/40606" target="_blank" rel="noopener noreferrer">#40606</a></li>
<li>Fixed the issue where <code>commit_txn</code> did not automatically re-enter, maintaining consistent behavior between compute-storage decoupled and integrated modes. <a href="https://github.com/apache/doris/pull/39615" target="_blank" rel="noopener noreferrer">#39615</a></li>
<li>Fixed the issue where the number of projected columns increased when dropping columns. <a href="https://github.com/apache/doris/pull/40187" target="_blank" rel="noopener noreferrer">#40187</a></li>
<li>Fixed the issue where delete statements did not correctly handle return values, causing data to still be visible after deletion. <a href="https://github.com/apache/doris/pull/39428" target="_blank" rel="noopener noreferrer">#39428</a></li>
<li>Fixed the coredump issue caused by rowset metadata competition during file cache preheating. <a href="https://github.com/apache/doris/pull/39361" target="_blank" rel="noopener noreferrer">#39361</a></li>
<li>Fixed the issue where the entire cache space would be used up when TTL cache enabled LRU eviction. <a href="https://github.com/apache/doris/pull/39814" target="_blank" rel="noopener noreferrer">#39814</a></li>
<li>Fixed the issue where temporary files could not be recycled when importing commit rowset failed with HDFS storage backend. <a href="https://github.com/apache/doris/pull/40215" target="_blank" rel="noopener noreferrer">#40215</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse-2">Lakehouse<a href="https://doris.apache.org/blog/release-note-3.0.2#lakehouse-2" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>Fixed some issues with predicate pushdown in JDBC Catalog. <a href="https://github.com/apache/doris/pull/39064" target="_blank" rel="noopener noreferrer">#39064</a></li>
<li>Fixed the issue of not being able to read when <code>S``TRUCT</code> type columns are missing in Parquet format. <a href="https://github.com/apache/doris/pull/38718" target="_blank" rel="noopener noreferrer">#38718</a></li>
<li>Fixed the issue of FileSystem leaks on the FE side in some cases. <a href="https://github.com/apache/doris/pull/38610" target="_blank" rel="noopener noreferrer">#38610</a></li>
<li>Fixed the issue of metadata cache information being inconsistent when Hive/Iceberg tables write back in some cases. <a href="https://github.com/apache/doris/pull/40729" target="_blank" rel="noopener noreferrer">#40729</a></li>
<li>Fixed the issue of unstable partition ID generation for external tables in some cases. <a href="https://github.com/apache/doris/pull/39325" target="_blank" rel="noopener noreferrer">#39325</a></li>
<li>Fixed the issue of external table queries selecting BE nodes in the blacklist in some cases. <a href="https://github.com/apache/doris/pull/39451" target="_blank" rel="noopener noreferrer">#39451</a></li>
<li>Optimized the timeout time for batch retrieval of external table partition information to avoid long-term thread occupation. <a href="https://github.com/apache/doris/pull/39346" target="_blank" rel="noopener noreferrer">#39346</a></li>
<li>Fixed the issue of memory leaks when querying Hudi tables in some cases. <a href="https://github.com/apache/doris/pull/41256" target="_blank" rel="noopener noreferrer">#41256</a></li>
<li>Fixed the issue of connection pool connection leaks in JDBC Catalog in some cases. <a href="https://github.com/apache/doris/pull/39582" target="_blank" rel="noopener noreferrer">#39582</a></li>
<li>Fixed the issue of BE memory leaks in JDBC Catalog in some cases. <a href="https://github.com/apache/doris/pull/41041" target="_blank" rel="noopener noreferrer">#41041</a></li>
<li>Fixed the issue of not being able to query Hudi data on Alibaba Cloud OSS. <a href="https://github.com/apache/doris/pull/41316" target="_blank" rel="noopener noreferrer">#41316</a></li>
<li>Fixed the issue of not being able to read empty partitions in MaxCompute. <a href="https://github.com/apache/doris/pull/40046" target="_blank" rel="noopener noreferrer">#40046</a></li>
<li>Fixed the issue of poor performance when querying Oracle through JDBC Catalog. <a href="https://github.com/apache/doris/pull/41513" target="_blank" rel="noopener noreferrer">#41513</a></li>
<li>Fixed the issue of BE crashes when querying deletion vector of Paimon tables after enabling file cache features. <a href="https://github.com/apache/doris/pull/39877" target="_blank" rel="noopener noreferrer">#39877</a></li>
<li>Fixed the issue of not being able to access Paimon tables on HDFS clusters with HA enabled. <a href="https://github.com/apache/doris/pull/39806" target="_blank" rel="noopener noreferrer">#39806</a></li>
<li>Temporarily disabled the page index filtering feature of Parquet to avoid potential issues. <a href="https://github.com/apache/doris/pull/38691" target="_blank" rel="noopener noreferrer">#38691</a></li>
<li>Fixed the issue of not being able to read unsigned types in Parquet files. <a href="https://github.com/apache/doris/pull/39926" target="_blank" rel="noopener noreferrer">#39926</a></li>
<li>Fixed the issue of potential infinite loops when reading Parquet files in some cases. <a href="https://github.com/apache/doris/pull/39523" target="_blank" rel="noopener noreferrer">#39523</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-materialized-views-1">Asynchronous Materialized Views<a href="https://doris.apache.org/blog/release-note-3.0.2#asynchronous-materialized-views-1" class="hash-link" aria-label="Direct link to Asynchronous Materialized Views" title="Direct link to Asynchronous Materialized Views">&#x200B;</a></h3>
<ul>
<li>Fixed the issue where partition construction might select the wrong table to track partitions if both sides have the same column names. <a href="https://github.com/apache/doris/pull/40810" target="_blank" rel="noopener noreferrer">#40810</a></li>
<li>Fixed the issue where transparent rewrite partition compensation might result in incorrect results. <a href="https://github.com/apache/doris/pull/40803" target="_blank" rel="noopener noreferrer">#40803</a></li>
<li>Fixed the issue where transparent rewrite did not take effect on external tables. <a href="https://github.com/apache/doris/pull/38909" target="_blank" rel="noopener noreferrer">#38909</a></li>
<li>Fixed the issue where nested materialized views might not refresh properly. <a href="https://github.com/apache/doris/pull/40433" target="_blank" rel="noopener noreferrer">#40433</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="synchronous-materialized-views">Synchronous Materialized Views<a href="https://doris.apache.org/blog/release-note-3.0.2#synchronous-materialized-views" class="hash-link" aria-label="Direct link to Synchronous Materialized Views" title="Direct link to Synchronous Materialized Views">&#x200B;</a></h3>
<ul>
<li>Fixed the issue where creating synchronous materialized views on MOW tables might result in incorrect query results. <a href="https://github.com/apache/doris/pull/39171" target="_blank" rel="noopener noreferrer">#39171</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer-2">Query Optimizer<a href="https://doris.apache.org/blog/release-note-3.0.2#query-optimizer-2" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>Fixed the issue where existing synchronous materialized views might not be usable after upgrading. <a href="https://github.com/apache/doris/pull/41283" target="_blank" rel="noopener noreferrer">#41283</a></li>
<li>Fixed the issue of not correctly handling milliseconds when comparing datetime literals. <a href="https://github.com/apache/doris/pull/40121" target="_blank" rel="noopener noreferrer">#40121</a></li>
<li>Fixed the issue of potential errors in conditional function partition pruning. <a href="https://github.com/apache/doris/pull/39298" target="_blank" rel="noopener noreferrer">#39298</a></li>
<li>Fixed the issue where MOW tables with synchronous materialized views could not perform delete operations. <a href="https://github.com/apache/doris/pull/39578" target="_blank" rel="noopener noreferrer">#39578</a></li>
<li>Fixed the issue where the nullable of slots in JDBC external table query predicates might be incorrectly planned, causing query errors. <a href="https://github.com/apache/doris/pull/41014" target="_blank" rel="noopener noreferrer">#41014</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution-2">Query Execution<a href="https://doris.apache.org/blog/release-note-3.0.2#query-execution-2" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>Fixed the memory leak issue caused by the use of runtime filters. <a href="https://github.com/apache/doris/pull/39155" target="_blank" rel="noopener noreferrer">#39155</a></li>
<li>Fixed the issue of excessive memory usage by window functions. <a href="https://github.com/apache/doris/pull/39581" target="_blank" rel="noopener noreferrer">#39581</a></li>
<li>Fixed a series of function compatibility issues during rolling upgrades. <a href="https://github.com/apache/doris/pull/41023" target="_blank" rel="noopener noreferrer">#41023</a>  <a href="https://github.com/apache/doris/pull/40438" target="_blank" rel="noopener noreferrer">#40438</a>  <a href="https://github.com/apache/doris/pull/39648" target="_blank" rel="noopener noreferrer">#39648</a></li>
<li>Fixed the issue of incorrect results with <code>encryption_function</code> when used with constants. <a href="https://github.com/apache/doris/pull/40201" target="_blank" rel="noopener noreferrer">#40201</a></li>
<li>Fixed the issue of errors when importing single-table materialized views. <a href="https://github.com/apache/doris/pull/39061" target="_blank" rel="noopener noreferrer">#39061</a></li>
<li>Fixed the issue of incorrect partition result calculations for window functions. <a href="https://github.com/apache/doris/pull/39100" target="_blank" rel="noopener noreferrer">#39100</a>  <a href="https://github.com/apache/doris/pull/40761" target="_blank" rel="noopener noreferrer">#40761</a></li>
<li>Fixed the issue of incorrect calculations for topn when null values are present. <a href="https://github.com/apache/doris/pull/39497" target="_blank" rel="noopener noreferrer">#39497</a></li>
<li>Fixed the issue of incorrect results with the <code>map_agg</code> function. <a href="https://github.com/apache/doris/pull/39743" target="_blank" rel="noopener noreferrer">#39743</a></li>
<li>Fixed the issue of incorrect messages returned by cancel. <a href="https://github.com/apache/doris/pull/38982" target="_blank" rel="noopener noreferrer">#38982</a></li>
<li>Fixed the issue of BE core dumps caused by encrypt and decrypt functions. <a href="https://github.com/apache/doris/pull/40726" target="_blank" rel="noopener noreferrer">#40726</a></li>
<li>Fixed the issue of queries getting stuck due to too many scanners in high-concurrency scenarios. <a href="https://github.com/apache/doris/pull/40495" target="_blank" rel="noopener noreferrer">#40495</a></li>
<li>Supported time types in runtime filters. <a href="https://github.com/apache/doris/pull/38258" target="_blank" rel="noopener noreferrer">#38258</a></li>
<li>Fixed the issue of incorrect results with window funnel functions. <a href="https://github.com/apache/doris/pull/40960" target="_blank" rel="noopener noreferrer">#40960</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semi-structured-data-management-1">Semi-Structured Data Management<a href="https://doris.apache.org/blog/release-note-3.0.2#semi-structured-data-management-1" class="hash-link" aria-label="Direct link to Semi-Structured Data Management" title="Direct link to Semi-Structured Data Management">&#x200B;</a></h3>
<ul>
<li>Fixed the issue of match function errors when no indexes were present. <a href="https://github.com/apache/doris/pull/38989" target="_blank" rel="noopener noreferrer">#38989</a></li>
<li>Fixed the issue of crashes when ARRAY data types were used as parameters for array_min/array_max functions. <a href="https://github.com/apache/doris/pull/39492" target="_blank" rel="noopener noreferrer">#39492</a></li>
<li>Fixed the issue of nullable with the <code>array_enumerate_uniq</code> function. <a href="https://github.com/apache/doris/pull/38384" target="_blank" rel="noopener noreferrer">#38384</a></li>
<li>Fixed the issue of bloomfilter indexes not being updated when adding or deleting columns. <a href="https://github.com/apache/doris/pull/38431" target="_blank" rel="noopener noreferrer">#38431</a></li>
<li>Fixed the issue of es-catalog parsing exceptions with array data. <a href="https://github.com/apache/doris/pull/39104" target="_blank" rel="noopener noreferrer">#39104</a></li>
<li>Fixed the issue of improper predicate push-down in es-catalog. <a href="https://github.com/apache/doris/pull/40111" target="_blank" rel="noopener noreferrer">#40111</a></li>
<li>Fixed the issue of exceptions caused by modifying input data with<code>map()</code> and <code>struct()</code> functions. <a href="https://github.com/apache/doris/pull/39699" target="_blank" rel="noopener noreferrer">#39699</a></li>
<li>Fixed the issue of index compaction crashes in special cases. <a href="https://github.com/apache/doris/pull/40294" target="_blank" rel="noopener noreferrer">#40294</a></li>
<li>Fixed the issue of ARRAY type inverted indexes missing nullbitmaps. <a href="https://github.com/apache/doris/pull/38907" target="_blank" rel="noopener noreferrer">#38907</a></li>
<li>Fixed the issue of incorrect results with the <code>count()</code> function on inverted indexes. <a href="https://github.com/apache/doris/pull/41152" target="_blank" rel="noopener noreferrer">#41152</a></li>
<li>Fixed the issue of correct results with the <code>explode_map</code> function when using aliases. <a href="https://github.com/apache/doris/pull/39757" target="_blank" rel="noopener noreferrer">#39757</a></li>
<li>Fixed the issue of VARIANT type not being able to use row storage for exceptional JSON data. <a href="https://github.com/apache/doris/pull/39394" target="_blank" rel="noopener noreferrer">#39394</a></li>
<li>Fixed the issue of memory leaks when returning ARRAY results with VARIANT type. <a href="https://github.com/apache/doris/pull/41358" target="_blank" rel="noopener noreferrer">#41358</a></li>
<li>Fixed the issue of changing column names with VARIANT type. <a href="https://github.com/apache/doris/pull/40320" target="_blank" rel="noopener noreferrer">#40320</a></li>
<li>Fixed the issue of potential precision loss when converting VARIANT type to DECIMAL type. <a href="https://github.com/apache/doris/pull/39650" target="_blank" rel="noopener noreferrer">#39650</a></li>
<li>Fixed the issue of nullable handling with VARIANT type. <a href="https://github.com/apache/doris/pull/39732" target="_blank" rel="noopener noreferrer">#39732</a></li>
<li>Fixed the issue of sparse column reading with VARIANT type. <a href="https://github.com/apache/doris/pull/40295" target="_blank" rel="noopener noreferrer">#40295</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-3">Other<a href="https://doris.apache.org/blog/release-note-3.0.2#other-3" class="hash-link" aria-label="Direct link to Other" title="Direct link to Other">&#x200B;</a></h3>
<ul>
<li>Fixed the compatibility issue between new and old audit log plugins. <a href="https://github.com/apache/doris/pull/41401" target="_blank" rel="noopener noreferrer">#41401</a></li>
<li>Fixed the issue where users could see processes of others in certain cases. <a href="https://github.com/apache/doris/pull/39747" target="_blank" rel="noopener noreferrer">#39747</a></li>
<li>Fixed the issue where users with permissions could not export. <a href="https://github.com/apache/doris/pull/38365" target="_blank" rel="noopener noreferrer">#38365</a></li>
<li>Fixed the issue where create table like required create permissions for the existing table. <a href="https://github.com/apache/doris/pull/37879" target="_blank" rel="noopener noreferrer">#37879</a></li>
<li>Fixed the issue where some features did not verify permissions. <a href="https://github.com/apache/doris/pull/39726" target="_blank" rel="noopener noreferrer">#39726</a></li>
<li>Fixed the issue of not correctly closing connections when using SSL. <a href="https://github.com/apache/doris/pull/38587" target="_blank" rel="noopener noreferrer">#38587</a></li>
<li>Fixed the issue where executing ALTER VIEW operations in some cases caused FE to fail to start. <a href="https://github.com/apache/doris/pull/40872" target="_blank" rel="noopener noreferrer">#40872</a></li>
</ul></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Release Notes" term="Release Notes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Apache Doris version 2.0.15 has been released]]></title>
        <id>https://doris.apache.org/blog/release-note-2.0.15</id>
        <link href="https://doris.apache.org/blog/release-note-2.0.15"/>
        <updated>2024-09-30T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Thanks to our community users and developers, about 157 improvements and bug fixes have been made in Doris 2.0.15 version]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Release Notes</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Apache Doris version 2.0.15 has been released</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-09-30T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">September 30, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Thanks to our community users and developers, about 157 improvements and bug fixes have been made in Doris 2.0.15 version</p>
<ul>
<li>
<p>Quick Download: <a href="https://doris.apache.org/download" target="_blank" rel="noopener noreferrer">https://doris.apache.org/download</a></p>
</li>
<li>
<p>GitHub: <a href="https://github.com/apache/doris/releases/tag/2.0.15" target="_blank" rel="noopener noreferrer">https://github.com/apache/doris/releases/tag/2.0.15</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-behavior-change">1 Behavior Change<a href="https://doris.apache.org/blog/release-note-2.0.15#1-behavior-change" class="hash-link" aria-label="Direct link to 1 Behavior Change" title="Direct link to 1 Behavior Change">&#x200B;</a></h2>
<p>NA</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-new-features">2 New Features<a href="https://doris.apache.org/blog/release-note-2.0.15#2-new-features" class="hash-link" aria-label="Direct link to 2 New Features" title="Direct link to 2 New Features">&#x200B;</a></h2>
<ul>
<li>
<p>Restore now supports deleting redundant tablets and partition options. <a href="https://github.com/apache/doris/pull/39028" target="_blank" rel="noopener noreferrer">#39028</a></p>
</li>
<li>
<p>Support JSON function <code>json_search</code>.<a href="https://github.com/apache/doris/pull/40948" target="_blank" rel="noopener noreferrer">#40948</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-improvement-and-optimizations">3 Improvement and Optimizations<a href="https://doris.apache.org/blog/release-note-2.0.15#3-improvement-and-optimizations" class="hash-link" aria-label="Direct link to 3 Improvement and Optimizations" title="Direct link to 3 Improvement and Optimizations">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="stability">Stability<a href="https://doris.apache.org/blog/release-note-2.0.15#stability" class="hash-link" aria-label="Direct link to Stability" title="Direct link to Stability">&#x200B;</a></h3>
<ul>
<li>
<p>Add a FE configuration <code>abort_txn_after_lost_heartbeat_time_second</code> for transaction abort time. <a href="https://github.com/apache/doris/pull/28662" target="_blank" rel="noopener noreferrer">#28662</a></p>
</li>
<li>
<p>Abort transactions after a BE loses heartbeat for over 1 minute instead of 5 seconds, to avoid overly sensitive transaction aborts. <a href="https://github.com/apache/doris/pull/22781" target="_blank" rel="noopener noreferrer">#22781</a></p>
</li>
<li>
<p>Delay scheduling EOF tasks of routine load to avoid an excessive number of small transactions. <a href="https://github.com/apache/doris/pull/39975" target="_blank" rel="noopener noreferrer">#39975</a></p>
</li>
<li>
<p>Prefer querying from online disk services to be more robust. <a href="https://github.com/apache/doris/pull/39467" target="_blank" rel="noopener noreferrer">#39467</a></p>
</li>
<li>
<p>Skip checking newly inserted rows in non-strict mode partial updates if the row&apos;s delete sign is marked. <a href="https://github.com/apache/doris/pull/40322" target="_blank" rel="noopener noreferrer">#40322</a></p>
</li>
<li>
<p>To prevent FE OOM, limit the number of tablets in backup tasks, with a default value of 300,000. <a href="https://github.com/apache/doris/pull/39987" target="_blank" rel="noopener noreferrer">#39987</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance">Performance<a href="https://doris.apache.org/blog/release-note-2.0.15#performance" class="hash-link" aria-label="Direct link to Performance" title="Direct link to Performance">&#x200B;</a></h3>
<ul>
<li>
<p>Optimize slow column updates caused by concurrent column updates and compactions. <a href="https://github.com/apache/doris/pull/38487" target="_blank" rel="noopener noreferrer">#38487</a></p>
</li>
<li>
<p>When a NullLiteral exists in a filter condition, it can now be folded into False and further converted to an EmptySet to reduce unnecessary data scanning and computation. <a href="https://github.com/apache/doris/pull/38135" target="_blank" rel="noopener noreferrer">#38135</a></p>
</li>
<li>
<p>Improve performance of <code>ORDER BY</code> permutation. <a href="https://github.com/apache/doris/pull/38985" target="_blank" rel="noopener noreferrer">#38985</a></p>
</li>
<li>
<p>Improve the performance of string processing in inverted indexes. <a href="https://github.com/apache/doris/pull/37395" target="_blank" rel="noopener noreferrer">#37395</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="optimizer-and-statistics">Optimizer and Statistics<a href="https://doris.apache.org/blog/release-note-2.0.15#optimizer-and-statistics" class="hash-link" aria-label="Direct link to Optimizer and Statistics" title="Direct link to Optimizer and Statistics">&#x200B;</a></h3>
<ul>
<li>
<p>Added support for statements beginning with a semicolon. <a href="https://github.com/apache/doris/pull/39399" target="_blank" rel="noopener noreferrer">#39399</a></p>
</li>
<li>
<p>Polish aggregate function signature matching. <a href="https://github.com/apache/doris/pull/39352" target="_blank" rel="noopener noreferrer">#39352</a></p>
</li>
<li>
<p>Drop column statistics and trigger auto analysis after schema change. <a href="https://github.com/apache/doris/pull/39101" target="_blank" rel="noopener noreferrer">#39101</a></p>
</li>
<li>
<p>Support dropping cached stats using <code>DROP CACHED STATS table_name</code>. <a href="https://github.com/apache/doris/pull/39367" target="_blank" rel="noopener noreferrer">#39367</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="multi-catalog-and-others">Multi Catalog and Others<a href="https://doris.apache.org/blog/release-note-2.0.15#multi-catalog-and-others" class="hash-link" aria-label="Direct link to Multi Catalog and Others" title="Direct link to Multi Catalog and Others">&#x200B;</a></h3>
<ul>
<li>
<p>Optimize JDBC Catalog refresh to reduce the frequency of client creation. <a href="https://github.com/apache/doris/pull/40261" target="_blank" rel="noopener noreferrer">#40261</a></p>
</li>
<li>
<p>Fix thread leaks in JDBC Catalog under certain conditions. <a href="https://github.com/apache/doris/pull/39423" target="_blank" rel="noopener noreferrer">#39423</a></p>
</li>
<li>
<p>ARRAY MAP STRUCT types now support <code>REPLACE_IF_NOT_NULL</code>. <a href="https://github.com/apache/doris/pull/38304" target="_blank" rel="noopener noreferrer">#38304</a></p>
</li>
<li>
<p>Retry delete jobs for failures that are not <code>DELETE_INVALID_XXX</code>. <a href="https://github.com/apache/doris/pull/37834" target="_blank" rel="noopener noreferrer">#37834</a></p>
</li>
</ul>
<p><strong>Credits</strong></p>
<p>@924060929, @BePPPower, @BiteTheDDDDt, @CalvinKirs, @GoGoWen, @HappenLee, @Jibing-Li, @Johnnyssc, @LiBinfeng-01, @Mryange, @SWJTU-ZhangLei, @TangSiyang2001, @Toms1999, @Vallishp, @Yukang-Lian, @airborne12, @amorynan, @bobhan1, @cambyzju, @csun5285, @dataroaring, @eldenmoon, @englefly, @feiniaofeiafei, @hello-stephen, @htyoung, @hubgeter, @justfortaste, @liaoxin01, @liugddx, @liutang123, @luwei16, @mongo360, @morrySnow, @qidaye, @smallx, @sollhui, @starocean999, @w41ter, @xiaokang, @xzj7019, @yujun777, @zclllyybb, @zddr, @zhangstar333, @zhannngchen, @zy-kkk, @zzzxl1993</p></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Release Notes" term="Release Notes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Apache Doris Flink Connector 24.0.0  just released!]]></title>
        <id>https://doris.apache.org/blog/release-flink-doris-connector-24.0.0</id>
        <link href="https://doris.apache.org/blog/release-flink-doris-connector-24.0.0"/>
        <updated>2024-09-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Dear community, We are excited to announce the official release of Apache Doris Flink Connector version 24.0.0 on September 5th, 2024.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Release Notes</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Apache Doris Flink Connector 24.0.0  just released!</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-09-25T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">September 25, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Dear community, We are excited to announce the official release of Apache Doris Flink Connector version 24.0.0 on September 5th, 2024. This release brings several enhancements and new capabilities, including support for Flink 1.20 and high-speed data retrieval from Doris via Arrow Flight SQL. Additionally, the FlinkCDC version required for full database synchronization has been upgraded to 3.1.x for optimal performance.</p>
<ul>
<li>Download Link: <a href="https://github.com/apache/doris-flink-connector/releases/tag/24.0.0" target="_blank" rel="noopener noreferrer">https://github.com/apache/doris-flink-connector/releases/tag/24.0.0</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="behavioral-changes">Behavioral Changes<a href="https://doris.apache.org/blog/release-flink-doris-connector-24.0.0#behavioral-changes" class="hash-link" aria-label="Direct link to Behavioral Changes" title="Direct link to Behavioral Changes">&#x200B;</a></h2>
<ul>
<li>
<p>FlinkCDC Upgrade: To leverage the full potential of this release, the FlinkCDC version used for full database synchronization must be upgraded to 3.1.x. Due to the incompatibility between FlinkCDC 3.1.x and earlier versions (e.g., 2.4), running full database synchronization jobs will require a stateless restart after upgrading FlinkCDC. Please refer to the <a href="https://mp.weixin.qq.com/s/qYW5Bw0IqUHUc8bnfWOIog" target="_blank" rel="noopener noreferrer">Apache Flink CDC 3.1.0 Release Announcement</a> for details on compatibility.</p>
</li>
<li>
<p>Version Renaming: To maintain consistency with other Connectors (e.g., Spark and Kafka) and account for the aforementioned incompatibilities, the Connector version has been renamed to the 24.x series. See the discussion thread <a href="https://lists.apache.org/thread/8tp215yk0tkgtdfkjdl4svvbljnmxzst" target="_blank" rel="noopener noreferrer">DISCUSS] About the next version change of Connector</a> for more information.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-features">New Features<a href="https://doris.apache.org/blog/release-flink-doris-connector-24.0.0#new-features" class="hash-link" aria-label="Direct link to New Features" title="Direct link to New Features">&#x200B;</a></h2>
<ul>
<li>
<p>Supported Flink v1.20.</p>
</li>
<li>
<p>DB2 Database synchronization is supported.</p>
</li>
<li>
<p>CDC Schema Change enhancement supported the use of the JSQLParser framework for DDL.</p>
</li>
<li>
<p>Supported Stream Load with GZ compression.</p>
</li>
<li>
<p>Enabled Arrow Flight SQL integration for high-speed data retrieval from Doris.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="https://doris.apache.org/blog/release-flink-doris-connector-24.0.0#improvements" class="hash-link" aria-label="Direct link to Improvements" title="Direct link to Improvements">&#x200B;</a></h2>
<ul>
<li>
<p>Upgraded FlinkCDC  to 3.1.1.</p>
</li>
<li>
<p>JDBC parameter configuration for DB2/Postgres/SQLServer synchronization.</p>
</li>
<li>
<p>Optimized batch writing mode.</p>
</li>
<li>
<p>Refined CDC synchronization logic.</p>
</li>
<li>
<p>Supported MySQL full database synchronization with <code>INTEGER</code> type.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug Fixes<a href="https://doris.apache.org/blog/release-flink-doris-connector-24.0.0#bug-fixes" class="hash-link" aria-label="Direct link to Bug Fixes" title="Direct link to Bug Fixes">&#x200B;</a></h2>
<ul>
<li>
<p>Resolved serialization issues with <code>MAP</code> subtypes of <code>DATE</code>/ <code>DATETIME</code></p>
</li>
<li>
<p>Fixed FlinkSQL projection pushdown bugs</p>
</li>
<li>
<p>Resolved <code>DECIMAL</code> type sync issues with MongoDB</p>
</li>
<li>
<p>Compatibility update for Doris arrow-based timestamp reading</p>
</li>
<li>
<p>Fixed non-effective delete events in CDC full database synchronization</p>
</li>
<li>
<p>Corrected schema change logic when default values are null</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="credits">Credits<a href="https://doris.apache.org/blog/release-flink-doris-connector-24.0.0#credits" class="hash-link" aria-label="Direct link to Credits" title="Direct link to Credits">&#x200B;</a></h2>
<p>@bingquanzhao&#x3001;@DongLiang-0&#x3001;@JasonLeeCoding&#x3001;@JNSimba@MaoMiMao&#x3001;@qg-lin@tmc9031&#x3001;@vinlee19</p></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Release Notes" term="Release Notes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Real-time data warehouse in TikTok based on Apache Doris]]></title>
        <id>https://doris.apache.org/blog/real-time-data-warehouse-in-TikTok-based-on-doris</id>
        <link href="https://doris.apache.org/blog/real-time-data-warehouse-in-TikTok-based-on-doris"/>
        <updated>2024-09-12T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[We are excited to invite the data platform team of TikTok to talk about how they use Apache Doris in their real-time data architecture and how they benefit from it, which could serve as a model for effective real-time data warehousing.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Best Practice</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Real-time data warehouse in TikTok based on Apache Doris</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Data Platform Team of TikTok</span></span><time datetime="2024-09-12T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">September 12, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Live streaming and e-commerce are among the biggest revenue drivers of TikTok, and they both rely on real-time data processing. It is more challenging than offline batch processing because it involves complicated operations like multi-stream JOINs and dimension table changes. It requires a higher level of development and maintenance input, and due to the need for system stability guarantee, it often leads to resource redundancy and waste.</p>
<p>We are excited to invite the data platform team of TikTok to talk about how they use <a href="https://doris.apache.org/" target="_blank" rel="noopener noreferrer">Apache Doris</a> in their real-time data architecture and how they benefit from it, which could serve as a model for effective real-time data warehousing.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="real-time-data-warehouse-in-tiktok">Real-time data warehouse in TikTok<a href="https://doris.apache.org/blog/real-time-data-warehouse-in-TikTok-based-on-doris#real-time-data-warehouse-in-tiktok" class="hash-link" aria-label="Direct link to Real-time data warehouse in TikTok" title="Direct link to Real-time data warehouse in TikTok">&#x200B;</a></h2>
<p><img decoding="async" loading="lazy" alt="Real-time data warehouse in TikTok" src="https://cdnd.selectdb.com/assets/images/real-time-data-warehouse-in-TikTok-3a4c3be36862d146c387cfbda3d468f8.PNG" width="1280" height="617" class="img_ev3q"></p>
<p>Before migration to Apache Doris, the real-time data was transferred by Flink, with Kafka enabling data flow between different data layers. Because Kafka itself does not have a logical table, it was hard to develop on it as easily as on Hive.</p>
<p>For TikTok, there is a significant gap in the data volume between real-time data and offline data. Due to the costs in development, operation, and resources associated with real-time data, the team tended to downgrade the real-time data requirements, but it was only a duct-tape solution.</p>
<ul>
<li>
<p><strong>Development costs</strong>: Since Flink is a stateful data stream engine with incremental state, it requires developers to have better knowledge of the underlying architecture, especially in multi-stream JOINs. The incremental state makes it impossible to store the full data state in memory like Hive. Real-time data requires a huge storage volume and the use of various computing engines (OLTP engines like MySQL, OLAP engines like ClickHouse and Apache Doris, and KV stores like Abase, Tier, and Redis) to meet different computing needs, adding to the development complexity. The incremental state also makes testing more challenging.</p>
</li>
<li>
<p><strong>Maintenance costs</strong>: Complex multi-stream JOIN operations often require storing large amounts of state data, which can lead to stability issues, especially when processing continuous live streams. The live stream business of TikTok is under continuous innovation. When there is a data schema change, direct deployment might cause data recovery failure due to altered state structures.</p>
</li>
<li>
<p><strong>Resources</strong>: Under-utilization of resources is a common issue in real-time scenarios. For example, at the beginning of a sales campaign, there is often a tidal surge of traffic, which will quickly decrease after a few minutes. However, to ensure stability throughout the campaign, a high resource level must be maintained 24/7, leading to resource waste.</p>
</li>
</ul>
<p>TikTok was looking for a solution that provides the same convenience as offline data development and reduces resource costs. Additionally, since the intermediate state data of Flink is inaccessible, it will be great that the new solution can enable quick and easy data testing, which is a prerequisite for data accuracy.</p>
<p><img decoding="async" loading="lazy" alt="Real-time data warehouse in TikTok" src="https://cdnd.selectdb.com/assets/images/real-time-data-warehouse-in-TikTok-2-6603d5e5915db8cbeeb6557b71da02fc.PNG" width="1280" height="507" class="img_ev3q"></p>
<p>The Flink-based architecture has been a mature solution in TikTok. It was primarily used for well-established business applications. In terms of data storage, it utilized the logical table format provided by Kafka. Despite the lack of fields, constraints, and high data traceability, this logical table approach supported over half of the real-time data development.</p>
<p>The new architecture is based on Apache Doris. It is simpler and similar to an offline Hive setup. The key to this Doris-based architecture is the combination of the sub-second scheduling engine with the OLAP engine. This enables data layering and the reuse of offline development.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="olap-engine">OLAP engine<a href="https://doris.apache.org/blog/real-time-data-warehouse-in-TikTok-based-on-doris#olap-engine" class="hash-link" aria-label="Direct link to OLAP engine" title="Direct link to OLAP engine">&#x200B;</a></h2>
<p>To serve the live streaming business in TikTok, the OLAP engine should be well-performed in:</p>
<ul>
<li>
<p><strong>Cross-site disaster recovery</strong>: This provides stability guarantee for live streaming to avoid significant financial losses caused by service unavailability.</p>
</li>
<li>
<p><strong>Read-write isolation</strong>: This is another guarantee of stability.</p>
</li>
<li>
<p><strong>Cross-cluster ETL</strong>: Data is scattered across different clusters for different business scenarios. For example, Cluster B and C both process transaction data, which should be synchronized from Cluster B to C, otherwise it will lead to duplicate data warehouse construction across business lines and impose burden on manpower and resources.</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="OLAP engine" src="https://cdnd.selectdb.com/assets/images/OLAP-engine-1089735ce92b6503eaaacca16d336c78.PNG" width="1280" height="543" class="img_ev3q"></p>
<p>This is how TikTok addresses these challenges:</p>
<ul>
<li>
<p><strong>Cross-site disaster recovery</strong>: Each table is stored with three replicas. The replicas are distributed across the data centers to ensure availability in each site. Message queues from the production end go through intermediate processing and arrive at the consumption end, forming the full data service link. In the event of a single data center outage, there are policies in place for both production and consumption to ensure service efficiency and stability.</p>
</li>
<li>
<p><strong>Read-write isolation</strong>: The read and write traffic is routed to different cluster groups.</p>
</li>
<li>
<p><strong>Cross-cluster ETL</strong>: For cross-cluster reads and writes, TikTok employs two mechanisms based on different business requirements and time sensitivity. One is to use Spark to read the data source format into a Yarn cluster and then synchronize it to the other clusters. The other is to leverage the <a href="https://doris.apache.org/docs/admin-manual/data-admin/ccr" target="_blank" rel="noopener noreferrer">cross-cluster replication</a> capability of Apache Doris. The Spark on Doris method is more stable and does not consume the computing resources of Doris, while the second approach is more efficient.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="real-time-ranking-board">Real-time ranking board<a href="https://doris.apache.org/blog/real-time-data-warehouse-in-TikTok-based-on-doris#real-time-ranking-board" class="hash-link" aria-label="Direct link to Real-time ranking board" title="Direct link to Real-time ranking board">&#x200B;</a></h2>
<p>How is the real-time data warehouse supporting the live streaming business of TikTok?</p>
<p>It builds a real-time ranking board to monitor its live streaming business performance. As is mentioned, it was migrated from Flink to Apache Doris. The new solution has a clear definition of metadata.</p>
<p><img decoding="async" loading="lazy" alt="Real-time ranking board" src="https://cdnd.selectdb.com/assets/images/real-time-ranking-board-ee634d2b4f9b6fd95bdb251616cb4b27.png" width="1280" height="720" class="img_ev3q"></p>
<p>The metadata is parsed from the fields in the real-time tables and then given definitions. Defining the metadata is a way to abstract the business logic of the ranking board.</p>
<p>This also involves defining the partitioning logic of the real-time ranking board. By simple configurations, the corresponding Flink tasks can be quickly created.</p>
<p>However, the need for such real-time ranking boards proliferates and challenges the Flink architecture in two ways:</p>
<ul>
<li>
<p>Firstly, the excessive number of ranking boards causes a surge in tasks, making resource management more difficult, especially real-time stream processing that runs 24/7.</p>
</li>
<li>
<p>Secondly, alerts from real-time tasks are getting more frequent. Also, the large number of tasks consuming the same message queue amplifies traffic, imposing an additional burden on HDFS.</p>
</li>
</ul>
<p>Moreover, since large promotional events in e-commerce tend to run for a long period, the long-cycle computation is a threat to the stability of Flink. <strong>This also makes backtracking difficult.</strong> To address these issues, maintenance personnel often need to perform operations at midnight when the state is relatively small and backtracking pressure is reduced.</p>
<p>Compared to the solution on Flink, the Doris-based data warehouse consumes less resources and generates less alerts. Plus, <strong>because the states are stored in Doris tables, long-cycle computation becomes more flexible</strong>.</p>
<p>Join Apache Doris community on <a href="https://join.slack.com/t/apachedoriscommunity/shared_invite/zt-2gmq5o30h-455W226d79zP3L96ZhXIoQ" target="_blank" rel="noopener noreferrer">Slack</a>!</p></div>]]></content>
        <author>
            <name>Data Platform Team of TikTok</name>
        </author>
        <category label="Best Practice" term="Best Practice"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Apache Doris 2.1.6 just released]]></title>
        <id>https://doris.apache.org/blog/release-note-2.1.6</id>
        <link href="https://doris.apache.org/blog/release-note-2.1.6"/>
        <updated>2024-09-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[This version brings continuous upgrades and improvements to the Lakehouse, Async Materialized Views, and Semi-Structured Data Management.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Release Notes</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Apache Doris 2.1.6 just released</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-09-10T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">September 10, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Dear community, <strong>Apache Doris version 2.1.6 was officially released on September 10, 2024.</strong> This version brings continuous upgrades and improvements to the Lakehouse, Async Materialized Views, and Semi-Structured Data Management. Additionally, several fixes have been implemented in areas such as the query optimizer, execution engine, storage management, permission management.</p>
<p><strong>Quick Download:</strong> <a href="https://doris.apache.org/download/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/download/</a></p>
<p><strong>GitHub Release:</strong> <a href="https://github.com/apache/doris/releases" target="_blank" rel="noopener noreferrer">https://github.com/apache/doris/releases</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="behavior-changes">Behavior changes<a href="https://doris.apache.org/blog/release-note-2.1.6#behavior-changes" class="hash-link" aria-label="Direct link to Behavior changes" title="Direct link to Behavior changes">&#x200B;</a></h2>
<ul>
<li>
<p>Removed the <code>delete_if_exists</code> option from create repository. <a href="https://github.com/apache/doris/pull/38192" target="_blank" rel="noopener noreferrer">#38192</a></p>
</li>
<li>
<p>Added the <code>enable_prepared_stmt_audit_log</code> session variable to control whether JDBC prepared statements record audit logs, with the default being no recording. <a href="https://github.com/apache/doris/pull/38624" target="_blank" rel="noopener noreferrer">#38624</a> <a href="https://github.com/apache/doris/pull/39009" target="_blank" rel="noopener noreferrer">#39009</a></p>
</li>
<li>
<p>Implemented fd limit and memory constraints for segment cache. <a href="https://github.com/apache/doris/pull/39689" target="_blank" rel="noopener noreferrer">#39689</a></p>
</li>
<li>
<p>When the FE configuration item <code>sys_log_mode</code> is set to BRIEF, file location information is added to the logs. <a href="https://github.com/apache/doris/pull/39571" target="_blank" rel="noopener noreferrer">#39571</a></p>
</li>
<li>
<p>Changed the default value of the session variable <code>max_allowed_packet</code> to 16MB. <a href="https://github.com/apache/doris/pull/38697" target="_blank" rel="noopener noreferrer">#38697</a></p>
</li>
<li>
<p>When a single request contains multiple statements, semicolons must be used to separate them. <a href="https://github.com/apache/doris/pull/38670" target="_blank" rel="noopener noreferrer">#38670</a></p>
</li>
<li>
<p>Added support for statements to begin with a semicolon. <a href="https://github.com/apache/doris/pull/39399" target="_blank" rel="noopener noreferrer">#39399</a></p>
</li>
<li>
<p>Aligned type formatting with MySQL in statements such as <code>show create table</code>. <a href="https://github.com/apache/doris/pull/38012" target="_blank" rel="noopener noreferrer">#38012</a></p>
</li>
<li>
<p>When the new optimizer planning times out, it no longer falls back to prevent the old optimizer from using longer planning times. <a href="https://github.com/apache/doris/pull/39499" target="_blank" rel="noopener noreferrer">#39499</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-features">New features<a href="https://doris.apache.org/blog/release-note-2.1.6#new-features" class="hash-link" aria-label="Direct link to New features" title="Direct link to New features">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse">Lakehouse<a href="https://doris.apache.org/blog/release-note-2.1.6#lakehouse" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>
<p>Supported writeback for Iceberg tables.</p>
<ul>
<li>For more information, please refer to the <a href="https://doris.apache.org/docs/lakehouse/datalake-building/iceberg-build" target="_blank" rel="noopener noreferrer">documentation</a>.</li>
</ul>
</li>
<li>
<p>SQL interception rules now support external tables.</p>
<ul>
<li>For more information, please refer to the <a href="https://doris.apache.org/docs/admin-manual/query-admin/sql-interception" target="_blank" rel="noopener noreferrer">documentation</a>.</li>
</ul>
</li>
<li>
<p>Added the system table <code>file_cache_statistics</code> to view BE data cache metrics.</p>
<ul>
<li>For more information, please refer to the <a href="https://doris.apache.org/docs/admin-manual/system-tables/file_cache_statistics" target="_blank" rel="noopener noreferrer">documentation</a>.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="async-materialized-view">Async Materialized View<a href="https://doris.apache.org/blog/release-note-2.1.6#async-materialized-view" class="hash-link" aria-label="Direct link to Async Materialized View" title="Direct link to Async Materialized View">&#x200B;</a></h3>
<ul>
<li>
<p>Supported transparent rewriting during inserts. <a href="https://github.com/apache/doris/pull/38115" target="_blank" rel="noopener noreferrer">#38115</a></p>
</li>
<li>
<p>Supported transparent rewriting when variant types exist in queries.<a href="https://github.com/apache/doris/pull/37929" target="_blank" rel="noopener noreferrer"> #37929</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semi-structured-data-management">Semi-Structured Data Management<a href="https://doris.apache.org/blog/release-note-2.1.6#semi-structured-data-management" class="hash-link" aria-label="Direct link to Semi-Structured Data Management" title="Direct link to Semi-Structured Data Management">&#x200B;</a></h3>
<ul>
<li>
<p>Supported casting ARRAY MAP to JSON type.<a href="https://github.com/apache/doris/pull/36548" target="_blank" rel="noopener noreferrer"> #36548</a></p>
</li>
<li>
<p>Supported the <code>json_keys</code> function.<a href="https://github.com/apache/doris/pull/36411" target="_blank" rel="noopener noreferrer"> #36411</a></p>
</li>
<li>
<p>Supported specifying the JSON path $. when importing JSON. <a href="https://github.com/apache/doris/pull/38213" target="_blank" rel="noopener noreferrer">#38213</a></p>
</li>
<li>
<p>ARRAY, MAP, STRUCT types now support <code>replace_if_not_null</code><a href="https://github.com/apache/doris/pull/38304" target="_blank" rel="noopener noreferrer">#38304</a></p>
</li>
<li>
<p>ARRAY, MAP, STRUCT types now support adjusting column order.<a href="https://github.com/apache/doris/pull/39210" target="_blank" rel="noopener noreferrer">#39210</a></p>
</li>
<li>
<p>Added the <code>multi_match</code> function to match keywords across multiple fields, with support for inverted index acceleration. <a href="https://github.com/apache/doris/pull/37722" target="_blank" rel="noopener noreferrer">#37722</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer">Query Optimizer<a href="https://doris.apache.org/blog/release-note-2.1.6#query-optimizer" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>
<p>Filled in the original database name, table name, column name, and alias for returned columns in the MySQL protocol. <a href="https://github.com/apache/doris/pull/38126" target="_blank" rel="noopener noreferrer"> #38126</a></p>
</li>
<li>
<p>Supported the aggregation function <code>group_concat</code> with both order by and distinct simultaneously. <a href="https://github.com/apache/doris/pull/38080" target="_blank" rel="noopener noreferrer">#38080</a></p>
</li>
<li>
<p>SQL cache now supports reusing cached results for queries with different comments. <a href="https://github.com/apache/doris/pull/40049" target="_blank" rel="noopener noreferrer">#40049</a></p>
</li>
<li>
<p>In partition pruning, supported including <code>date_trunc</code> and date functions in filter conditions. <a href="https://github.com/apache/doris/pull/38025" target="_blank" rel="noopener noreferrer">#38025</a> <a href="https://github.com/apache/doris/pull/38743" target="_blank" rel="noopener noreferrer">#38743</a></p>
</li>
<li>
<p>Allowed using the database name where the table resides as a qualifier prefix for table aliases. <a href="https://github.com/apache/doris/pull/38640" target="_blank" rel="noopener noreferrer">#38640</a></p>
</li>
<li>
<p>Supported hint-style comments.<a href="https://github.com/apache/doris/pull/39113" target="_blank" rel="noopener noreferrer">#39113</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="others">Others<a href="https://doris.apache.org/blog/release-note-2.1.6#others" class="hash-link" aria-label="Direct link to Others" title="Direct link to Others">&#x200B;</a></h3>
<ul>
<li>
<p>Added the system table <code>table_properties</code> for viewing table properties.</p>
<ul>
<li>For more information, please refer to the <a href="https://doris.apache.org/docs/admin-manual/system-tables/information_schema/table_properties" target="_blank" rel="noopener noreferrer">documentation</a>.</li>
</ul>
</li>
<li>
<p>Introduced deadlock and slow lock detection in FE.</p>
<ul>
<li>For more information, please refer to the <a href="https://doris.apache.org/docs/admin-manual/maint-monitor/frontend-lock-manager" target="_blank" rel="noopener noreferrer">documentation</a>.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="https://doris.apache.org/blog/release-note-2.1.6#improvements" class="hash-link" aria-label="Direct link to Improvements" title="Direct link to Improvements">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse-1">Lakehouse<a href="https://doris.apache.org/blog/release-note-2.1.6#lakehouse-1" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>
<p>Reimplemented the external table metadata caching mechanism.</p>
<ul>
<li>For details, refer to the <a href="https://doris.apache.org/docs/lakehouse/metacache" target="_blank" rel="noopener noreferrer">documentation</a>.</li>
</ul>
</li>
<li>
<p>Added the session variable <code>keep_carriage_return</code> with a default value of false. By default, reading Hive Text format tables treats both <code>\r\n</code> and <code>\n</code> as newline characters. <a href="https://github.com/apache/doris/pull/38099" target="_blank" rel="noopener noreferrer">#38099</a></p>
</li>
<li>
<p>Optimized memory statistics for Parquet/ORC file read/write operations.<a href="https://github.com/apache/doris/pull/37257" target="_blank" rel="noopener noreferrer">#37257</a></p>
</li>
<li>
<p>Supported pushing down IN/NOT IN predicates for Paimon tables. <a href="https://github.com/apache/doris/pull/38390" target="_blank" rel="noopener noreferrer">#38390</a></p>
</li>
<li>
<p>Enhanced the optimizer to support Time Travel syntax for Hudi tables. <a href="https://github.com/apache/doris/pull/38591" target="_blank" rel="noopener noreferrer">#38591</a></p>
</li>
<li>
<p>Optimized Kerberos authentication-related processes. <a href="https://github.com/apache/doris/pull/37301" target="_blank" rel="noopener noreferrer"> #37301</a></p>
</li>
<li>
<p>Enabled reading Hive tables after renaming column operations. <a href="https://github.com/apache/doris/pull/38809" target="_blank" rel="noopener noreferrer">#38809</a></p>
</li>
<li>
<p>Optimized the reading performance of partition columns for external tables. <a href="https://github.com/apache/doris/pull/38810" target="_blank" rel="noopener noreferrer">#38810</a></p>
</li>
<li>
<p>Improved the data shard merging strategy during external table query planning to avoid performance degradation caused by a large number of small shards.<a href="https://github.com/apache/doris/pull/38964" target="_blank" rel="noopener noreferrer">#38964</a></p>
</li>
<li>
<p>Added attributes such as location to <code>SHOW CREATE DATABASE/TABLE</code>. <a href="https://github.com/apache/doris/pull/39644" target="_blank" rel="noopener noreferrer">#39644</a></p>
</li>
<li>
<p>Supported complex types in MaxCompute Catalog. <a href="https://github.com/apache/doris/pull/39822" target="_blank" rel="noopener noreferrer">#39822</a></p>
</li>
<li>
<p>Optimized the file cache loading strategy by using asynchronous loading to avoid long BE startup times. <a href="https://github.com/apache/doris/pull/39036" target="_blank" rel="noopener noreferrer">#39036</a></p>
</li>
<li>
<p>Improved the file cache eviction strategy, such as evicting locks held for extended periods. <a href="https://github.com/apache/doris/pull/39721" target="_blank" rel="noopener noreferrer">#39721</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="async-materialized-view-1">Async Materialized View<a href="https://doris.apache.org/blog/release-note-2.1.6#async-materialized-view-1" class="hash-link" aria-label="Direct link to Async Materialized View" title="Direct link to Async Materialized View">&#x200B;</a></h3>
<ul>
<li>
<p>Supported hourly, weekly, and quarterly partition roll-up construction. <a href="https://github.com/apache/doris/pull/37678" target="_blank" rel="noopener noreferrer">#37678</a></p>
</li>
<li>
<p>For materialized views based on Hive external tables, the metadata cache is now updated before refresh to ensure the latest data is obtained during each refresh. <a href="https://github.com/apache/doris/pull/38212" target="_blank" rel="noopener noreferrer">#38212</a></p>
</li>
<li>
<p>Improved the performance of transparent rewrite planning in storage-compute decoupled mode by batch fetching metadata. <a href="https://github.com/apache/doris/pull/39301" target="_blank" rel="noopener noreferrer">#39301</a></p>
</li>
<li>
<p>Enhanced the performance of transparent rewrite planning by prohibiting duplicate enumerations. <a href="https://github.com/apache/doris/pull/39541" target="_blank" rel="noopener noreferrer">#39541</a></p>
</li>
<li>
<p>Improved the performance of transparent rewrite for refreshing materialized views based on Hive external table partitions.<a href="https://github.com/apache/doris/pull/38525" target="_blank" rel="noopener noreferrer">#38525</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semi-structured-data-management-1">Semi-Structured Data Management<a href="https://doris.apache.org/blog/release-note-2.1.6#semi-structured-data-management-1" class="hash-link" aria-label="Direct link to Semi-Structured Data Management" title="Direct link to Semi-Structured Data Management">&#x200B;</a></h3>
<ul>
<li>
<p>Optimized memory allocation for TOPN queries to improve performance. <a href="https://github.com/apache/doris/pull/37429" target="_blank" rel="noopener noreferrer">#37429</a></p>
</li>
<li>
<p>Enhanced the performance of string processing in inverted indexes.<a href="https://github.com/apache/doris/pull/37395" target="_blank" rel="noopener noreferrer">#37395</a></p>
</li>
<li>
<p>Optimized the performance of inverted indexes in MOW tables. <a href="https://github.com/apache/doris/pull/37428" target="_blank" rel="noopener noreferrer">#37428</a></p>
</li>
<li>
<p>Supported specifying the row-store <code>page_size</code> during table creation to control compression effectiveness. <a href="https://github.com/apache/doris/pull/37145" target="_blank" rel="noopener noreferrer">#37145</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer-1">Query Optimizer<a href="https://doris.apache.org/blog/release-note-2.1.6#query-optimizer-1" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>
<p>Adjusted the row count estimation algorithm for mark joins, resulting in more accurate cardinality estimates for mark joins. <a href="https://github.com/apache/doris/pull/38270" target="_blank" rel="noopener noreferrer">#38270</a></p>
</li>
<li>
<p>Optimized the cost estimation algorithm for semi/anti joins, enabling more accurate selection of semi/anti join orders. <a href="https://github.com/apache/doris/pull/37951" target="_blank" rel="noopener noreferrer">#37951</a></p>
</li>
<li>
<p>Adjusted the filter estimation algorithm for cases where some columns have no statistical information, leading to more accurate cardinality estimates. <a href="https://github.com/apache/doris/pull/39592" target="_blank" rel="noopener noreferrer">#39592</a></p>
</li>
<li>
<p>Modified the instance calculation logic for set operation operators to prevent insufficient parallelism in extreme cases. <a href="https://github.com/apache/doris/pull/39999" target="_blank" rel="noopener noreferrer">#39999</a></p>
</li>
<li>
<p>Adjusted the usage strategy of bucket shuffle, achieving better performance when data is not sufficiently shuffled. <a href="https://github.com/apache/doris/pull/36784" target="_blank" rel="noopener noreferrer">#36784</a></p>
</li>
<li>
<p>Enabled early filtering of window function data, supporting multiple window functions in a single projection. <a href="https://github.com/apache/doris/pull/38393" target="_blank" rel="noopener noreferrer">#38393</a></p>
</li>
<li>
<p>When a <code>NullLiteral</code> exists in a filter condition, it can now be folded into false, further converted to an <code>EmptySet</code> to reduce unnecessary data scanning and computation. <a href="https://github.com/apache/doris/pull/38135" target="_blank" rel="noopener noreferrer">#38135</a></p>
</li>
<li>
<p>Expanded the scope of predicate derivation, reducing data scanning in queries with specific patterns. <a href="https://github.com/apache/doris/pull/37314" target="_blank" rel="noopener noreferrer">#37314</a></p>
</li>
<li>
<p>Supported partial short-circuit evaluation logic in partition pruning to improve partition pruning performance, achieving over 100% improvement in specific scenarios. <a href="https://github.com/apache/doris/pull/38191" target="_blank" rel="noopener noreferrer">#38191</a></p>
</li>
<li>
<p>Enabled the computation of arbitrary scalar functions within user variables. <a href="https://github.com/apache/doris/pull/39144" target="_blank" rel="noopener noreferrer">#39144</a></p>
</li>
<li>
<p>Maintained error messages consistent with MySQL when alias conflicts exist in queries. <a href="https://github.com/apache/doris/pull/38104" target="_blank" rel="noopener noreferrer">#38104</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution">Query Execution<a href="https://doris.apache.org/blog/release-note-2.1.6#query-execution" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>
<p>Adapted AggState for compatibility from 2.1 to 3.x and fixed coredump issues. <a href="https://github.com/apache/doris/pull/37104" target="_blank" rel="noopener noreferrer">#37104</a></p>
</li>
<li>
<p>Refactored the strategy selection for local shuffle when no joins are involved. <a href="https://github.com/apache/doris/pull/37282" target="_blank" rel="noopener noreferrer">#37282</a></p>
</li>
<li>
<p>Modified the scanner for internal table queries to an asynchronous approach to prevent blocking during internal table queries. <a href="https://github.com/apache/doris/pull/38403" target="_blank" rel="noopener noreferrer">#38403</a></p>
</li>
<li>
<p>Optimized the block merge process when building hash tables in Join operators. <a href="https://github.com/apache/doris/pull/37471" target="_blank" rel="noopener noreferrer">#37471</a></p>
</li>
<li>
<p>Reduced the lock holding time for MultiCast operations. <a href="https://github.com/apache/doris/pull/37462" target="_blank" rel="noopener noreferrer">37462</a></p>
</li>
<li>
<p>Optimized gRPC&apos;s keepAliveTime and added a connection monitoring mechanism, reducing the probability of query failures due to RPC errors during query execution. <a href="https://github.com/apache/doris/pull/37304" target="_blank" rel="noopener noreferrer">#37304</a></p>
</li>
<li>
<p>Cleaned up all dirty pages in jemalloc when memory limits are exceeded. <a href="https://github.com/apache/doris/pull/37164" target="_blank" rel="noopener noreferrer">#37164</a></p>
</li>
<li>
<p>Improved the performance of <code>aes_encrypt</code>/<code>decrypt</code> functions when handling constant types. <a href="https://github.com/apache/doris/pull/37194" target="_blank" rel="noopener noreferrer">#37194</a></p>
</li>
<li>
<p>Optimized the performance of <code>json_extract</code> functions when processing constant data. <a href="https://github.com/apache/doris/pull/36927" target="_blank" rel="noopener noreferrer">#36927</a></p>
</li>
<li>
<p>Optimized the performance of ParseURL functions when processing constant data. <a href="https://github.com/apache/doris/pull/36882" target="_blank" rel="noopener noreferrer">#36882</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="backup-recovery--ccr">Backup Recovery / CCR<a href="https://doris.apache.org/blog/release-note-2.1.6#backup-recovery--ccr" class="hash-link" aria-label="Direct link to Backup Recovery / CCR" title="Direct link to Backup Recovery / CCR">&#x200B;</a></h3>
<ul>
<li>
<p>Restore now supports deleting redundant tablets and partition options. <a href="https://github.com/apache/doris/pull/39363" target="_blank" rel="noopener noreferrer">#39363</a></p>
</li>
<li>
<p>Check storage connectivity when creating a repository. <a href="https://github.com/apache/doris/pull/39538" target="_blank" rel="noopener noreferrer">#39538</a></p>
</li>
<li>
<p>Enables binlog to support <code>DROP TABLE</code>, allowing CCR to incrementally synchronize <code>DROP TABLE</code> operations. <a href="https://github.com/apache/doris/pull/38541" target="_blank" rel="noopener noreferrer">#38541</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compaction">Compaction<a href="https://doris.apache.org/blog/release-note-2.1.6#compaction" class="hash-link" aria-label="Direct link to Compaction" title="Direct link to Compaction">&#x200B;</a></h3>
<ul>
<li>
<p>Improves the issue where high-priority compaction tasks were not subject to task concurrency control limits. <a href="https://github.com/apache/doris/pull/38189" target="_blank" rel="noopener noreferrer">#38189</a></p>
</li>
<li>
<p>Automatically reduces compaction memory consumption based on data characteristics. <a href="https://github.com/apache/doris/pull/37486" target="_blank" rel="noopener noreferrer">#37486</a></p>
</li>
<li>
<p>Fixes an issue where the sequential data optimization strategy could lead to incorrect data in aggregate tables or MOR UNIQUE tables. <a href="https://github.com/apache/doris/pull/38299" target="_blank" rel="noopener noreferrer"> #38299</a></p>
</li>
<li>
<p>Optimizes the rowset selection strategy during compaction during replica replenishment to avoid triggering -235 errors. <a href="https://github.com/apache/doris/pull/39262" target="_blank" rel="noopener noreferrer">#39262</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mow-merge-on-write">MOW (Merge-On-Write)<a href="https://doris.apache.org/blog/release-note-2.1.6#mow-merge-on-write" class="hash-link" aria-label="Direct link to MOW (Merge-On-Write)" title="Direct link to MOW (Merge-On-Write)">&#x200B;</a></h3>
<ul>
<li>
<p>Optimizes slow column updates caused by concurrent column updates and compactions. <a href="https://github.com/apache/doris/pull/38682" target="_blank" rel="noopener noreferrer">#38682</a></p>
</li>
<li>
<p>Fixes an issue where segcompaction during bulk data imports could lead to incorrect MOW data. <a href="https://github.com/apache/doris/pull/38992" target="_blank" rel="noopener noreferrer">#38992</a> <a href="https://github.com/apache/doris/pull/39707" target="_blank" rel="noopener noreferrer">#39707</a></p>
</li>
<li>
<p>Fixes data loss in column updates that may occur after BE restarts. <a href="https://github.com/apache/doris/pull/39035" target="_blank" rel="noopener noreferrer">#39035</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-management">Storage Management<a href="https://doris.apache.org/blog/release-note-2.1.6#storage-management" class="hash-link" aria-label="Direct link to Storage Management" title="Direct link to Storage Management">&#x200B;</a></h3>
<ul>
<li>
<p>Adds FE configuration to control whether queries under hot-cold tiering prefer local data replicas. <a href="https://github.com/apache/doris/pull/38322" target="_blank" rel="noopener noreferrer">#38322</a></p>
</li>
<li>
<p>Optimizes expired BE report messages to include newly created tablets. <a href="https://github.com/apache/doris/pull/38839" target="_blank" rel="noopener noreferrer">#38839</a> <a href="https://github.com/apache/doris/pull/39605" target="_blank" rel="noopener noreferrer">#39605</a></p>
</li>
<li>
<p>Optimizes replica scheduling priority strategy to prioritize replicas with missing data. <a href="https://github.com/apache/doris/pull/38884" target="_blank" rel="noopener noreferrer">#38884</a></p>
</li>
<li>
<p>Prevents tablets with unfinished ALTER jobs from being balanced. <a href="https://github.com/apache/doris/pull/39202" target="_blank" rel="noopener noreferrer">#39202</a></p>
</li>
<li>
<p>Enables modifying the number of buckets for tables with list partitioning. <a href="https://github.com/apache/doris/pull/39688" target="_blank" rel="noopener noreferrer">#39688</a></p>
</li>
<li>
<p>Prefers querying from online disk services. <a href="https://github.com/apache/doris/pull/39654" target="_blank" rel="noopener noreferrer">#39654</a></p>
</li>
<li>
<p>Improves error messages for materialized view base tables that do not support deletion during synchronization. <a href="https://github.com/apache/doris/pull/39857" target="_blank" rel="noopener noreferrer">#39857</a></p>
</li>
<li>
<p>Improves error messages for single columns exceeding 4GB. <a href="https://github.com/apache/doris/pull/39897" target="_blank" rel="noopener noreferrer">#39897</a></p>
</li>
<li>
<p>Fixes an issue where aborted transactions were omitted when plan errors occurred during <code>INSERT</code> statements.<a href="https://github.com/apache/doris/pull/38260" target="_blank" rel="noopener noreferrer">#38260</a></p>
</li>
<li>
<p>Fixes exceptions during SSL connection closure.<a href="https://github.com/apache/doris/pull/38677" target="_blank" rel="noopener noreferrer">#38677</a></p>
</li>
<li>
<p>Fixes an issue where table locks were not held when aborting transactions using labels. <a href="https://github.com/apache/doris/pull/38842" target="_blank" rel="noopener noreferrer">#38842</a></p>
</li>
<li>
<p>Fixes <code>gson pretty</code> causing large image issues. <a href="https://github.com/apache/doris/pull/39135" target="_blank" rel="noopener noreferrer">#39135</a></p>
</li>
<li>
<p>Fixes an issue where the new optimizer did not check for bucket values of 0 in <code>CREATE TABLE</code> statements.<a href="https://github.com/apache/doris/pull/38999" target="_blank" rel="noopener noreferrer">#38999</a></p>
</li>
<li>
<p>Fixes errors when Chinese column names are included in <code>DELETE</code> condition predicates. <a href="https://github.com/apache/doris/pull/39500" target="_blank" rel="noopener noreferrer">#39500</a></p>
</li>
<li>
<p>Fixes frequent tablet balancing issues in partition balancing mode. <a href="https://github.com/apache/doris/pull/39606" target="_blank" rel="noopener noreferrer">#39606</a></p>
</li>
<li>
<p>Fixes an issue where partition storage policy attributes were lost. <a href="https://github.com/apache/doris/pull/39677" target="_blank" rel="noopener noreferrer">#39677</a></p>
</li>
<li>
<p>Fixes incorrect statistics when importing multiple tables within a transaction. <a href="https://github.com/apache/doris/pull/39548" target="_blank" rel="noopener noreferrer">#39548</a></p>
</li>
<li>
<p>Fixes errors when deleting random bucket tables. <a href="https://github.com/apache/doris/pull/39830" target="_blank" rel="noopener noreferrer">#39830</a></p>
</li>
<li>
<p>Fixes issues where FE fails to start due to non-existent UDFs. <a href="https://github.com/apache/doris/pull/39868" target="_blank" rel="noopener noreferrer">#39868</a></p>
</li>
<li>
<p>Fixes inconsistencies in the last failed version between FE master and slave. <a href="https://github.com/apache/doris/pull/39947" target="_blank" rel="noopener noreferrer">#39947</a></p>
</li>
<li>
<p>Fixes an issue where related tablets may still be in schema change state when schema change jobs are canceled. <a href="https://github.com/apache/doris/pull/39327" target="_blank" rel="noopener noreferrer"> #39327</a></p>
</li>
<li>
<p>Fixes errors when modifying type and column order in a single statement schema change (SC). <a href="https://github.com/apache/doris/pull/39107" target="_blank" rel="noopener noreferrer">#39107</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-loading">Data Loading<a href="https://doris.apache.org/blog/release-note-2.1.6#data-loading" class="hash-link" aria-label="Direct link to Data Loading" title="Direct link to Data Loading">&#x200B;</a></h3>
<ul>
<li>
<p>Improves error messages for -238 errors during imports. <a href="https://github.com/apache/doris/pull/39182" target="_blank" rel="noopener noreferrer">#39182</a></p>
</li>
<li>
<p>Allows importing to other partitions while restoring a partition. <a href="https://github.com/apache/doris/pull/39915" target="_blank" rel="noopener noreferrer">#39915</a></p>
</li>
<li>
<p>Optimizes the strategy for FE to select BEs during group commit. <a href="https://github.com/apache/doris/pull/37830" target="_blank" rel="noopener noreferrer">#37830</a> <a href="https://github.com/apache/doris/pull/39010" target="_blank" rel="noopener noreferrer">#39010</a></p>
</li>
<li>
<p>Avoids printing stack traces for some common streamload error messages. <a href="https://github.com/apache/doris/pull/38418" target="_blank" rel="noopener noreferrer">#38418</a></p>
</li>
<li>
<p>Improves handling of issues where offline BEs may affect import errors. <a href="https://github.com/apache/doris/pull/38256" target="_blank" rel="noopener noreferrer">#38256</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="permissions">Permissions<a href="https://doris.apache.org/blog/release-note-2.1.6#permissions" class="hash-link" aria-label="Direct link to Permissions" title="Direct link to Permissions">&#x200B;</a></h3>
<ul>
<li>Optimizes access performance after enabling the Ranger authentication plugin. <a href="https://github.com/apache/doris/pull/38575" target="_blank" rel="noopener noreferrer">#38575</a></li>
<li>Optimizes permission strategies for Refresh Catalog/Database/Table operations, allowing users to perform these operations with only SHOW permissions. <a href="https://github.com/apache/doris/pull/39008" target="_blank" rel="noopener noreferrer">#39008</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="https://doris.apache.org/blog/release-note-2.1.6#bug-fixes" class="hash-link" aria-label="Direct link to Bug fixes" title="Direct link to Bug fixes">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse-2">Lakehouse<a href="https://doris.apache.org/blog/release-note-2.1.6#lakehouse-2" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>
<p>Fixes the issue where switching catalogs may result in an error of not finding the database. <a href="https://github.com/apache/doris/pull/38114" target="_blank" rel="noopener noreferrer">#38114</a></p>
</li>
<li>
<p>Addresses exceptions caused by attempting to read non-existent data on S3. <a href="https://github.com/apache/doris/pull/38253" target="_blank" rel="noopener noreferrer">#38253</a></p>
</li>
<li>
<p>Resolves the issue where specifying an abnormal path during export operations may lead to incorrect export locations. <a href="https://github.com/apache/doris/pull/38602" target="_blank" rel="noopener noreferrer">#38602</a></p>
</li>
<li>
<p>Fixes the timezone issue for time columns in Paimon tables. <a href="https://github.com/apache/doris/pull/37716" target="_blank" rel="noopener noreferrer">#37716</a></p>
</li>
<li>
<p>Temporarily disables the Parquet PageIndex feature to avoid certain erroneous behaviors.</p>
</li>
<li>
<p>Corrects the selection of Backend nodes in the blacklist during external table queries. <a href="https://github.com/apache/doris/pull/38984" target="_blank" rel="noopener noreferrer">#38984</a></p>
</li>
<li>
<p>Resolves errors caused by missing subcolumns in Parquet Struct column types.<a href="https://github.com/apache/doris/pull/39192" target="_blank" rel="noopener noreferrer">#39192</a></p>
</li>
<li>
<p>Addresses several issues with predicate pushdown in JDBC Catalog. <a href="https://github.com/apache/doris/pull/39082" target="_blank" rel="noopener noreferrer">#39082</a></p>
</li>
<li>
<p>Fixes issues where some historical Parquet formats led to incorrect query results. <a href="https://github.com/apache/doris/pull/39375" target="_blank" rel="noopener noreferrer">#39375</a></p>
</li>
<li>
<p>Improves compatibility with ojdbc6 drivers for Oracle JDBC Catalog. <a href="https://github.com/apache/doris/pull/39408" target="_blank" rel="noopener noreferrer">#39408</a></p>
</li>
<li>
<p>Resolves potential FE memory leaks caused by Refresh Catalog/Database/Table operations. <a href="https://github.com/apache/doris/pull/39186" target="_blank" rel="noopener noreferrer">#39186</a> <a href="https://github.com/apache/doris/pull/39871" target="_blank" rel="noopener noreferrer">#39871</a></p>
</li>
<li>
<p>Fixes thread leaks in JDBC Catalog under certain conditions. <a href="https://github.com/apache/doris/pull/39666" target="_blank" rel="noopener noreferrer">#39666</a> <a href="https://github.com/apache/doris/pull/39582" target="_blank" rel="noopener noreferrer">#39582</a></p>
</li>
<li>
<p>Addresses potential event processing failures after enabling Hive Metastore event subscription. <a href="https://github.com/apache/doris/pull/39239" target="_blank" rel="noopener noreferrer">#39239</a></p>
</li>
<li>
<p>Disables reading Hive Text format tables with custom escape characters and null formats to prevent data errors. <a href="https://github.com/apache/doris/pull/39869" target="_blank" rel="noopener noreferrer">#39869</a></p>
</li>
<li>
<p>Resolves issues accessing Iceberg tables created via the Iceberg API under certain conditions. <a href="https://github.com/apache/doris/pull/39203" target="_blank" rel="noopener noreferrer">#39203</a></p>
</li>
<li>
<p>Fixes the inability to read Paimon tables stored on HDFS clusters with high availability enabled. <a href="https://github.com/apache/doris/pull/39876" target="_blank" rel="noopener noreferrer">#39876</a></p>
</li>
<li>
<p>Addresses errors that may occur when reading Paimon table deletion vectors after enabling file caching. <a href="https://github.com/apache/doris/pull/39875" target="_blank" rel="noopener noreferrer">#39875</a></p>
</li>
<li>
<p>Resolves potential deadlocks when reading Parquet files under certain conditions. <a href="https://github.com/apache/doris/pull/39945" target="_blank" rel="noopener noreferrer">#39945</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="async-materialized-view-2">Async Materialized View<a href="https://doris.apache.org/blog/release-note-2.1.6#async-materialized-view-2" class="hash-link" aria-label="Direct link to Async Materialized View" title="Direct link to Async Materialized View">&#x200B;</a></h3>
<ul>
<li>
<p>Fixes the inability to use <code>SHOW CREATE MATERIALIZED VIEW</code> on follower FEs. <a href="https://github.com/apache/doris/pull/38794" target="_blank" rel="noopener noreferrer">#38794</a></p>
</li>
<li>
<p>Unifies the object type of asynchronous materialized views in metadata as tables to enable proper display in data tools. <a href="https://github.com/apache/doris/pull/38797" target="_blank" rel="noopener noreferrer">#38797</a></p>
</li>
<li>
<p>Resolves the issue where nested asynchronous materialized views always perform full refreshes. <a href="https://github.com/apache/doris/pull/38698" target="_blank" rel="noopener noreferrer">#38698</a></p>
</li>
<li>
<p>Fixes the issue where canceled tasks may show as running after restarting FEs. <a href="https://github.com/apache/doris/pull/39424" target="_blank" rel="noopener noreferrer"> #39424</a></p>
</li>
<li>
<p>Addresses incorrect use of contexts, which may lead to unexpected failures of materialized view refresh tasks. <a href="https://github.com/apache/doris/pull/39690" target="_blank" rel="noopener noreferrer">#39690</a></p>
</li>
<li>
<p>Resolves issues that may cause varchar type write failures due to unreasonable lengths when creating asynchronous materialized views based on external tables.<a href="https://github.com/apache/doris/pull/37668" target="_blank" rel="noopener noreferrer">#37668</a></p>
</li>
<li>
<p>Fixes the potential invalidation of asynchronous materialized views based on external tables after FE restarts or catalog rebuilds. <a href="https://github.com/apache/doris/pull/39355" target="_blank" rel="noopener noreferrer">#39355</a></p>
</li>
<li>
<p>Prohibits the use of partition rollup for materialized views with list partitions to prevent the generation of incorrect data. <a href="https://github.com/apache/doris/pull/38124" target="_blank" rel="noopener noreferrer">#38124</a></p>
</li>
<li>
<p>Fixes incorrect results when literals exist in the select list during transparent rewriting for aggregation rollup. <a href="https://github.com/apache/doris/pull/38958" target="_blank" rel="noopener noreferrer">#38958</a></p>
</li>
<li>
<p>Addresses potential errors during transparent rewriting when queries contain filters like <code>a = a</code>. <a href="https://github.com/apache/doris/pull/39629" target="_blank" rel="noopener noreferrer">#39629</a></p>
</li>
<li>
<p>Fixes issues where transparent rewriting for direct external table queries fails. <a href="https://github.com/apache/doris/pull/39041" target="_blank" rel="noopener noreferrer">#39041</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semi-structured-data-management-2">Semi-Structured Data Management<a href="https://doris.apache.org/blog/release-note-2.1.6#semi-structured-data-management-2" class="hash-link" aria-label="Direct link to Semi-Structured Data Management" title="Direct link to Semi-Structured Data Management">&#x200B;</a></h3>
<ul>
<li>
<p>Removes support for prepared statements in the old optimizer. <a href="https://github.com/apache/doris/pull/39465" target="_blank" rel="noopener noreferrer">#39465</a></p>
</li>
<li>
<p>Fixes issues with JSON escape character handling. <a href="https://github.com/apache/doris/pull/37251" target="_blank" rel="noopener noreferrer">#37251</a></p>
</li>
<li>
<p>Resolves issues with duplicate processing of JSON fields. <a href="https://github.com/apache/doris/pull/38490" target="_blank" rel="noopener noreferrer">#38490</a></p>
</li>
<li>
<p>Fixes issues with some ARRAY and MAP functions. <a href="https://github.com/apache/doris/pull/39307" target="_blank" rel="noopener noreferrer">#39307</a> <a href="https://github.com/apache/doris/pull/39699" target="_blank" rel="noopener noreferrer">#39699</a> <a href="https://github.com/apache/doris/pull/39757" target="_blank" rel="noopener noreferrer">#39757</a></p>
</li>
<li>
<p>Resolves complex combinations of inverted index queries and LIKE queries. <a href="https://github.com/apache/doris/pull/36687" target="_blank" rel="noopener noreferrer">#36687</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer-2">Query Optimizer<a href="https://doris.apache.org/blog/release-note-2.1.6#query-optimizer-2" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the potential partition pruning error issue when the &apos;OR&apos; condition exists in partition filter conditions. <a href="https://github.com/apache/doris/pull/38897" target="_blank" rel="noopener noreferrer">#38897</a></p>
</li>
<li>
<p>Fixed the potential partition pruning error issue when complex expressions are involved. <a href="https://github.com/apache/doris/pull/39298" target="_blank" rel="noopener noreferrer">#39298</a></p>
</li>
<li>
<p>Fixed the issue where nullable in <code>agg_state</code> subtypes might be planned incorrectly, leading to execution errors. <a href="https://github.com/apache/doris/pull/37489" target="_blank" rel="noopener noreferrer">#37489</a></p>
</li>
<li>
<p>Fixed the issue where nullable in set operation operators might be planned incorrectly, leading to execution errors. <a href="https://github.com/apache/doris/pull/39109" target="_blank" rel="noopener noreferrer">#39109</a></p>
</li>
<li>
<p>Fixed the incorrect execution priority issue of intersect operator. <a href="https://github.com/apache/doris/pull/39095" target="_blank" rel="noopener noreferrer">#39095</a></p>
</li>
<li>
<p>Fixed the NPE issue that may occur when the maximum valid date literal exists in the query. <a href="https://github.com/apache/doris/pull/39482" target="_blank" rel="noopener noreferrer">#39482</a></p>
</li>
<li>
<p>Fixed the occasional planning error that results in an illegal slot error during execution. <a href="https://github.com/apache/doris/pull/39640" target="_blank" rel="noopener noreferrer">#39640</a></p>
</li>
<li>
<p>Fixed the issue where repeatedly referencing columns in cte may lead to missing data in some columns in the result. <a href="https://github.com/apache/doris/pull/39850" target="_blank" rel="noopener noreferrer">#39850</a></p>
</li>
<li>
<p>Fixed the occasional planning error issue when &apos;case when&apos; exists in the query. <a href="https://github.com/apache/doris/pull/38491" target="_blank" rel="noopener noreferrer">#38491</a></p>
</li>
<li>
<p>Fixed the issue where IP types cannot be implicitly converted to string types. <a href="https://github.com/apache/doris/pull/39318" target="_blank" rel="noopener noreferrer">#39318</a></p>
</li>
<li>
<p>Fixed the potential planning error issue when using multi-dimensional aggregation and the same column and its alias exist in the select list. <a href="https://github.com/apache/doris/pull/38166" target="_blank" rel="noopener noreferrer"> #38166</a></p>
</li>
<li>
<p>Fixed the issue where boolean types might be handled incorrectly when using BE constant folding. <a href="https://github.com/apache/doris/pull/39019" target="_blank" rel="noopener noreferrer">#39019</a></p>
</li>
<li>
<p>Fixed the planning error issue caused by <code>default_cluster</code>: as a prefix for the database name in expressions. <a href="https://github.com/apache/doris/pull/39114" target="_blank" rel="noopener noreferrer">#39114</a></p>
</li>
<li>
<p>Fixed the potential deadlock issue caused by<code> insert into</code>. <a href="https://github.com/apache/doris/pull/38660" target="_blank" rel="noopener noreferrer">#38660</a></p>
</li>
<li>
<p>Fixed the potential planning error issue caused by not holding table locks throughout the planning process. <a href="https://github.com/apache/doris/pull/38950" target="_blank" rel="noopener noreferrer">#38950</a></p>
</li>
<li>
<p>Fixed the issue where CHAR(0), VARCHAR(0) are not handled correctly when creating tables. <a href="https://github.com/apache/doris/pull/38427" target="_blank" rel="noopener noreferrer">#38427</a></p>
</li>
<li>
<p>Fixed the issue where <code>show create table</code> may incorrectly display hidden columns. <a href="https://github.com/apache/doris/pull/38796" target="_blank" rel="noopener noreferrer">#38796</a></p>
</li>
<li>
<p>Fixed the issue where columns with the same name as hidden columns are not prohibited when creating tables. <a href="https://github.com/apache/doris/pull/38796" target="_blank" rel="noopener noreferrer">#38796</a></p>
</li>
<li>
<p>Fixed the occasional planning error issue when executing <code>insert into as select</code> with CTEs. <a href="https://github.com/apache/doris/pull/38526" target="_blank" rel="noopener noreferrer">#38526</a></p>
</li>
<li>
<p>Fixed the issue where <code>insert into values</code> cannot automatically fill null default values. <strong>[<a href="https://doris.apache.org/blog/Nereids">fix</a> fix insert into table with null literal default value #39122](<a href="https://github.com/apache/doris/pull/39122" target="_blank" rel="noopener noreferrer">https://github.com/apache/doris/pull/39122</a>)</strong></p>
</li>
<li>
<p>Fixed the NPE issue caused by using cte in delete without using it. <a href="https://github.com/apache/doris/pull/39379" target="_blank" rel="noopener noreferrer">#39379</a></p>
</li>
<li>
<p>Fixed the issue where deleting from a randomly distributed aggregation model table fails. <a href="https://github.com/apache/doris/pull/37985" target="_blank" rel="noopener noreferrer">#37985</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution-1">Query Execution<a href="https://doris.apache.org/blog/release-note-2.1.6#query-execution-1" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue where the pipeline execution engine gets stuck in multiple scenarios, causing queries not to end. <a href="https://github.com/apache/doris/pull/38657" target="_blank" rel="noopener noreferrer">#38657</a> <a href="https://github.com/apache/doris/pull/38206" target="_blank" rel="noopener noreferrer">#38206</a> <a href="https://github.com/apache/doris/pull/38885" target="_blank" rel="noopener noreferrer">#38885</a></p>
</li>
<li>
<p>Fixed the coredump issue caused by null and non-null columns in set difference calculations.<a href="https://github.com/apache/doris/pull/38737" target="_blank" rel="noopener noreferrer">#38737</a></p>
</li>
<li>
<p>Fixed the incorrect result issue of the <code>width_bucket</code> function. <a href="https://github.com/apache/doris/pull/37892" target="_blank" rel="noopener noreferrer">#37892</a></p>
</li>
<li>
<p>Fixed the query error issue when a single row of data is large and the result set is also large (exceeding 2GB). <a href="https://github.com/apache/doris/pull/37990" target="_blank" rel="noopener noreferrer">#37990</a></p>
</li>
<li>
<p>Fixed the incorrect result issue of <code>stddev</code> with DecimalV2 type. <a href="https://github.com/apache/doris/pull/38731" target="_blank" rel="noopener noreferrer">#38731</a></p>
</li>
<li>
<p>Fixed the coredump issue caused by the <code>MULTI_MATCH_ANY</code> function. <a href="https://github.com/apache/doris/pull/37959" target="_blank" rel="noopener noreferrer">#37959</a></p>
</li>
<li>
<p>Fixed the issue where <code>insert overwrite auto partition</code> causes transaction rollback. <a href="https://github.com/apache/doris/pull/38103" target="_blank" rel="noopener noreferrer">#38103</a></p>
</li>
<li>
<p>Fixed the incorrect result issue of the <code>convert_tz</code> function. <a href="https://github.com/apache/doris/pull/37358" target="_blank" rel="noopener noreferrer">#37358</a> <a href="https://github.com/apache/doris/pull/38764" target="_blank" rel="noopener noreferrer">#38764</a></p>
</li>
<li>
<p>Fixed the coredump issue when using the <code>collect_set</code> function with window functions. <a href="https://github.com/apache/doris/pull/38234" target="_blank" rel="noopener noreferrer">#38234</a></p>
</li>
<li>
<p>Fixed the coredump issue caused by the mod function with abnormal input. <a href="https://github.com/apache/doris/pull/37999" target="_blank" rel="noopener noreferrer">#37999</a></p>
</li>
<li>
<p>Fixed the issue where executing the same expression in multiple threads may lead to incorrect Java UDF results. <a href="https://github.com/apache/doris/pull/38612" target="_blank" rel="noopener noreferrer">#38612</a></p>
</li>
<li>
<p>Fixed the overflow issue caused by the incorrect return type of the <code>conv</code> function. <a href="https://github.com/apache/doris/pull/38001" target="_blank" rel="noopener noreferrer">#38001</a></p>
</li>
<li>
<p>Fixed the unstable result issue of the histogram function. <a href="https://github.com/apache/doris/pull/38608" target="_blank" rel="noopener noreferrer">#38608</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="backup--recovery--ccr">Backup &amp; Recovery / CCR<a href="https://doris.apache.org/blog/release-note-2.1.6#backup--recovery--ccr" class="hash-link" aria-label="Direct link to Backup &amp; Recovery / CCR" title="Direct link to Backup &amp; Recovery / CCR">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue where the data version after backup and recovery may be incorrect, leading to unreadability. <a href="https://github.com/apache/doris/pull/38343" target="_blank" rel="noopener noreferrer">#38343</a></p>
</li>
<li>
<p>Fixed the issue of using restore version across versions. <a href="https://github.com/apache/doris/pull/38396" target="_blank" rel="noopener noreferrer">#38396</a></p>
</li>
<li>
<p>Fixed the issue where the job is not canceled when backup fails. <a href="https://github.com/apache/doris/pull/38993" target="_blank" rel="noopener noreferrer">#38993</a></p>
</li>
<li>
<p>Fixed the NPE issue in ccr during the upgrade from 2.1.4 to 2.1.5, causing the FE to fail to start. <a href="https://github.com/apache/doris/pull/39910" target="_blank" rel="noopener noreferrer">#39910</a></p>
</li>
<li>
<p>Fixed the issue where views and materialized views cannot be used after restoration. <a href="https://github.com/apache/doris/pull/38072" target="_blank" rel="noopener noreferrer">#38072</a> <a href="https://github.com/apache/doris/pull/39848" target="_blank" rel="noopener noreferrer">#39848</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-management-1">Storage Management<a href="https://doris.apache.org/blog/release-note-2.1.6#storage-management-1" class="hash-link" aria-label="Direct link to Storage Management" title="Direct link to Storage Management">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed possible memory leaks in routine load when loading multiple tables from a single stream. <a href="https://github.com/apache/doris/pull/38824" target="_blank" rel="noopener noreferrer">#38824</a></p>
</li>
<li>
<p>Fixed the issue where delimiters and escape characters in routine load were not effective. <a href="https://github.com/apache/doris/pull/38825" target="_blank" rel="noopener noreferrer">#38825</a></p>
</li>
<li>
<p>Fixed incorrectly show routine load results when the routine load task name contained uppercase letters. <a href="https://github.com/apache/doris/pull/38826" target="_blank" rel="noopener noreferrer">#38826</a></p>
</li>
<li>
<p>Fixed the issue where the offset cache was not reset when changing the routineload topic. <a href="https://github.com/apache/doris/pull/38474" target="_blank" rel="noopener noreferrer">#38474</a></p>
</li>
<li>
<p>Fixed the potential exception triggered by show routineload under concurrent scenarios. <a href="https://github.com/apache/doris/pull/39525" target="_blank" rel="noopener noreferrer">#39525</a></p>
</li>
<li>
<p>Fixed the issue where routine load might import data repeatedly. <a href="https://github.com/apache/doris/pull/39526" target="_blank" rel="noopener noreferrer">#39526</a></p>
</li>
<li>
<p>Fixed the data error caused by <code>setNull</code> when enabling group commit via JDBC. <a href="https://github.com/apache/doris/pull/38276" target="_blank" rel="noopener noreferrer">#38276</a></p>
</li>
<li>
<p>Fixed the potential NPE issue when enabling group commit insert to a non-master FE. <a href="https://github.com/apache/doris/pull/38345" target="_blank" rel="noopener noreferrer">#38345</a></p>
</li>
<li>
<p>Fixed incorrect error handling during internal data writing in group commit. <a href="https://github.com/apache/doris/pull/38997" target="_blank" rel="noopener noreferrer">#38997</a></p>
</li>
<li>
<p>Fixed the coredump that might be triggered when the group commit execution plan failed. <a href="https://github.com/apache/doris/pull/39396" target="_blank" rel="noopener noreferrer">#39396</a></p>
</li>
<li>
<p>Fixed the issue where concurrent imports into auto partition tables might report non-existent tablets. <a href="https://github.com/apache/doris/pull/38793" target="_blank" rel="noopener noreferrer">#38793</a></p>
</li>
<li>
<p>Fixed potential load stream leakage issues. <a href="https://github.com/apache/doris/pull/39039" target="_blank" rel="noopener noreferrer">#39039</a></p>
</li>
<li>
<p>Fixed the issue where transactions were opened for <code>insert into select</code> with no data. <a href="https://github.com/apache/doris/pull/39108" target="_blank" rel="noopener noreferrer">#39108</a></p>
</li>
<li>
<p>Ignored the single-replica import configuration when using memtable prefetching. <a href="https://github.com/apache/doris/pull/39154" target="_blank" rel="noopener noreferrer">#39154</a></p>
</li>
<li>
<p>Fixed the issue where background imports of stream load records might be abnormally aborted upon encountering db deletion. <a href="https://github.com/apache/doris/pull/39527" target="_blank" rel="noopener noreferrer">#39527</a></p>
</li>
<li>
<p>Fixed inaccurate error messages when data errors occurred in strict mode. <a href="https://github.com/apache/doris/pull/39587" target="_blank" rel="noopener noreferrer">#39587</a></p>
</li>
<li>
<p>Fixed the issue where streamload did not return an error URL upon encountering erroneous data. <a href="https://github.com/apache/doris/pull/38417" target="_blank" rel="noopener noreferrer">#38417</a></p>
</li>
<li>
<p>Fixed the issue with the combined use of insert overwrite and auto partition. <a href="https://github.com/apache/doris/pull/38442" target="_blank" rel="noopener noreferrer">#38442</a></p>
</li>
<li>
<p>Fixed parsing errors when CSV encountered data where the line delimiter was enclosed by the enclosing character. <a href="https://github.com/apache/doris/pull/38445" target="_blank" rel="noopener noreferrer">#38445</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-exporting">Data Exporting<a href="https://doris.apache.org/blog/release-note-2.1.6#data-exporting" class="hash-link" aria-label="Direct link to Data Exporting" title="Direct link to Data Exporting">&#x200B;</a></h3>
<ul>
<li>Fixed the issue where enabling the delete_existing_files property during export operations might result in duplicate deletion of exported data. <a href="https://github.com/apache/doris/pull/39304" target="_blank" rel="noopener noreferrer">#39304</a>)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="permissions-1">Permissions<a href="https://doris.apache.org/blog/release-note-2.1.6#permissions-1" class="hash-link" aria-label="Direct link to Permissions" title="Direct link to Permissions">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the incorrect requirement of ALTER TABLE permission when creating a materialized view. <a href="https://github.com/apache/doris/pull/38011" target="_blank" rel="noopener noreferrer">#38011</a></p>
</li>
<li>
<p>Fixed the issue where the db was explicitly displayed as empty when showing routine load. <a href="https://github.com/apache/doris/pull/38365" target="_blank" rel="noopener noreferrer">#38365</a></p>
</li>
<li>
<p>Fixed the incorrect requirement of CREATE permission on the original table when using CREATE TABLE LIKE. <a href="https://github.com/apache/doris/pull/37879" target="_blank" rel="noopener noreferrer">#37879</a></p>
</li>
<li>
<p>Fixed the issue where grant operations did not check if the object existed. <a href="https://github.com/apache/doris/pull/39597" target="_blank" rel="noopener noreferrer">#39597</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade-suggestions">Upgrade suggestions<a href="https://doris.apache.org/blog/release-note-2.1.6#upgrade-suggestions" class="hash-link" aria-label="Direct link to Upgrade suggestions" title="Direct link to Upgrade suggestions">&#x200B;</a></h2>
<p>When upgrading Doris, please follow the principle of not skipping two minor versions and upgrade sequentially.</p>
<p>For example, if you are upgrading from version 0.15.x to 2.0.x, it is recommended to first upgrade to the latest version of 1.1, then upgrade to the latest version of 1.2, and finally upgrade to the latest version of 2.0.</p>
<p>For more upgrade information, see the documentation: <a href="https://doris.apache.org/admin-manual/cluster-management/upgrade">Cluster Upgrade</a></p></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Release Notes" term="Release Notes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Creator of Talkie migrated from Loki and built a PB-scale logging system with Apache Doris]]></title>
        <id>https://doris.apache.org/blog/ai-unicorn-minimax-from-loki-and-built-a-pb-scale-logging-system-with-doris</id>
        <link href="https://doris.apache.org/blog/ai-unicorn-minimax-from-loki-and-built-a-pb-scale-logging-system-with-doris"/>
        <updated>2024-08-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Serving a PB-scale data size with over 99.9% availability, Apache Doris is the vital signs monitor of MiniMax, the maker of Talkie-the soulful AI that is sweeping the world.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Best Practice</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Creator of Talkie migrated from Loki and built a PB-scale logging system with Apache Doris</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-08-29T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">August 29, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>You might not have heard of <a href="https://www.minimaxi.com/en" target="_blank" rel="noopener noreferrer">MiniMax</a>, but you&apos;ve probably heard of <a href="https://www.talkie-ai.com/" target="_blank" rel="noopener noreferrer">Talkie</a>, the AI chatbot taking the world by storm. In the summer of 2024, Talkie ranked fifth among the most-downloaded free entertainment apps in the US, bringing its creator, MiniMax, into the global spotlight. As the maker of this market-stunning product, the AI unicorn maintains a low profile, but its history of smart decision-making dates back a long way.</p>
<p>Before MoE (Mixture of Experts) became an industry consensus, MiniMax has been investing most of its efforts in it. In April 2024, MiniMax launched its first commercially deployed MoE-based LLM, <strong>MiniMax-abab 6.5</strong>, which contains over a trillion parameters and delivers performances comparable to GPT-4, Claude-3, and Gemini-1.5.</p>
<p>As their LLM is getting more complex and called upon more frequently, it generates an exploding amount of logs from model training and inference. These logs provide the basis for performance monitoring, optimization, and troubleshooting. The existing Grafana Loki-based logging system of MiniMax faced performance and stability issues, so they planned for an upgrade. After looking at the common industry solutions, they came to Apache Doris.</p>
<p><strong>Now, all of MiniMax&apos;s business lines have been integrated with the Apache Doris-based logging system, which serves a PB-scale data size with over 99.9% availability. The query latency on 100 million logs is within seconds.</strong></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-old-grafana-loki-based-logging-system">The old Grafana Loki-based logging system<a href="https://doris.apache.org/blog/ai-unicorn-minimax-from-loki-and-built-a-pb-scale-logging-system-with-doris#the-old-grafana-loki-based-logging-system" class="hash-link" aria-label="Direct link to The old Grafana Loki-based logging system" title="Direct link to The old Grafana Loki-based logging system">&#x200B;</a></h2>
<p>The design of Loki, an open-source log aggregation system, was inspired by Prometheus and developed by the Grafana Labs team. It does not have an indexing structure, but instead builds indexes only on log labels and metadata.</p>
<p>The major components of a Loki-based system typically include:</p>
<ul>
<li>
<p><strong>Loki</strong>: the main server responsible for log storage and querying.</p>
</li>
<li>
<p><strong>Promtail</strong>: the agent layer for collecting logs and sending them to Loki.</p>
</li>
<li>
<p><strong>Grafana</strong>: for user interface visualization.</p>
</li>
</ul>
<p>To deploy Grafana Loki, each cluster should be deployed with a complete set of log collectors and Loki log storage/query services.</p>
<p>Loki uses an Index + Chunk design for log storage, where during ingestion, the different log streams are dispersed across various Ingesters based on a hash of the log labels, and the Ingesters are responsible for writing the log data to object storage. During querying, the Querier retrieves the relevant Chunks from the object storage based on the Index, and then performs the log matching.</p>
<p><img decoding="async" loading="lazy" alt="The old Grafana Loki-based logging system" src="https://cdnd.selectdb.com/assets/images/the-old-grafana-Loki-based-logging-system-d4f25adbc22b2ca44321d0dbf84603dc.png" width="1280" height="498" class="img_ev3q"></p>
<p>Although Grafana Loki is positioned as a lightweight, horizontally scalable, and highly available log management system, it still faces some challenges in practical business use:</p>
<ul>
<li>
<p><strong>Excessive query resource consumption</strong>: Loki does not create indexes based on the log, but instead, it only performs preliminary filtering of logs at the label granularity. Thus, for searches on the logs, it applies the query mechanism to perform full-text regular expression matching on the entire log data set. This operation can lead to spikes in resource consumption, including CPU, memory, and network bandwidth. As the volume of data being queried and the query per second (QPS) increases, Loki shows increasingly intolerable resource consumption and instability.</p>
</li>
<li>
<p><strong>Complex architecture</strong>: In addition to the modules shown in the above diagram, Loki also includes components like the Index Gateway, Memcache, and Compactor. The large number of architectural components makes the system challenging to operate and manage, and complex to configure.</p>
</li>
<li>
<p><strong>High maintenance cost and difficulty</strong>: MiniMax has a large number of deployed clusters, and each cluster has differences in its system, resources, storage, and network environments. The need to deploy an independent Loki architecture in each cluster adds to the maintenance difficulty.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="why-apache-doris">Why Apache Doris<a href="https://doris.apache.org/blog/ai-unicorn-minimax-from-loki-and-built-a-pb-scale-logging-system-with-doris#why-apache-doris" class="hash-link" aria-label="Direct link to Why Apache Doris" title="Direct link to Why Apache Doris">&#x200B;</a></h2>
<p>As one of the most data-intensive industries, AI use cases are characterized by long processing pipelines, abundant contextual data, and large per-request data volumes. Thus, the log size the MiniMax generates far exceeds those of non-AI software products of the same user base. The gigantic log size of MiniMax requires their logging system to be:</p>
<ul>
<li>
<p><strong>High-performance</strong>: They need the system to return query results on 100 million log entries within seconds.</p>
</li>
<li>
<p><strong>Flexible</strong>: The system should support log alerting and log metric queries, such as generating statistical trend lines for key terms.</p>
</li>
<li>
<p><strong>Low-cost</strong>: The petabyte-scale raw log data continues to grow, so it&apos;s a make-or-break factor to keep the storage and computational costs within reasonable bounds.</p>
</li>
</ul>
<p>After an evaluation of mature logging system architectures in the industry, MiniMax identified the following key components typically found in leading log management solutions:</p>
<ul>
<li>
<p><strong>Collection agent</strong>: collecting logs from service standard outputs and pushing the data into a central message queue.</p>
</li>
<li>
<p><strong>Message queue</strong>: decoupling upstream and downstream components, absorbing spikes, and ensuring system stability even when downstream components are unavailable.</p>
</li>
<li>
<p><strong>Storage and query middleware</strong>: storing and querying the log data. In a logging system, this middleware should be capable of inverted indexing to support efficient log searches.</p>
</li>
</ul>
<p>MiniMax decided to use iLogtail for the collection agents, Kafka for the message queue, and Apache Doris as the storage and query middleware. In selecting the storage middleware, MiniMax compared the representative technologies of Apache Doris and Elasticsearch.</p>
<p>Based on such reference architecture, MiniMax decided to use iLogtail as the collection agent, Apache Kafka for the message queue, and <strong><a href="https://doris.apache.org/" target="_blank" rel="noopener noreferrer">Apache Doris</a> as the storage and query middleware</strong>. The middleware decision was made after comparing Apache Doris and Elasticsearch.</p>
<p><img decoding="async" loading="lazy" alt="Why Apache Doris" src="https://cdnd.selectdb.com/assets/images/why-Apache-Doris-1cf3509615f273424114b2dc5a8aab3d.png" width="1280" height="578" class="img_ev3q"></p>
<p>Apache Doris shows competitiveness in cost and performance. It stands out particularly in storage efficiency, write throughput, and aggregation. Additionally, its compatibility with the MySQL syntax makes it more user-friendly.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="apache-doris-based-logging-system">Apache Doris-based logging system<a href="https://doris.apache.org/blog/ai-unicorn-minimax-from-loki-and-built-a-pb-scale-logging-system-with-doris#apache-doris-based-logging-system" class="hash-link" aria-label="Direct link to Apache Doris-based logging system" title="Direct link to Apache Doris-based logging system">&#x200B;</a></h2>
<p><img decoding="async" loading="lazy" alt="Apache Doris-based logging system" src="https://cdnd.selectdb.com/assets/images/apache-doris-based-logging-system-915a5c753d8bc0a6f406a5afab1da799.png" width="1280" height="571" class="img_ev3q"></p>
<p>The new logging system of MiniMax, called Mlogs, is more streamlined, with a single architecture serving all clusters. The upper layer acts as the control plane for the logging system, which consists of the encapsulation of log query interfaces and the module for automatic configuration generation and distribution. The lower layer represents the data plane of the logging system, containing the log collection agent, message queue, log writer, and the <strong>Apache Doris</strong> database.</p>
<p>Logs generated by the cluster services are collected by iLogtail and pushed to Kafka. Part of these logs is pulled from Kafka by the Mlogs Ingester and written to the Doris cluster via the Stream Load method of Apache Doris. The rest is directly subscribed to in real-time by Doris via Routine Load, pulling the message stream from Kafka. <strong>Ultimately, Apache Doris handles the storage and querying of all log data, eliminating the need for separate deployments for each cluster.</strong></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="hands-on-experience-from-minimax">Hands-on experience from MiniMax<a href="https://doris.apache.org/blog/ai-unicorn-minimax-from-loki-and-built-a-pb-scale-logging-system-with-doris#hands-on-experience-from-minimax" class="hash-link" aria-label="Direct link to Hands-on experience from MiniMax" title="Direct link to Hands-on experience from MiniMax">&#x200B;</a></h2>
<p><strong>Log ingestion</strong></p>
<p>The new architecture utilizes both the Routine Load and Stream Load methods of Apache Doris. Routine Load is ready to use out of the box and can directly handle JSON logs without the need for additional parsing. For more complex logs that require filtering and processing, MiniMax has introduced a log writer called Mlogs Ingester between Kafka and Doris. The Mlogs Ingester parses and processes the logs before writing them to Doris via Stream Load.</p>
<p><strong>Log search</strong></p>
<p>For log searches, MiniMax utilizes the inverted indexes and full-text regular expression query capabilities of Apache Doris.</p>
<ul>
<li>
<p>The inverted index of Apache Doris fits into a wide range of use cases and delivers high query performance. It&apos;s mainly used in <code>MATCH</code> and <code>MATCH_PHRASE</code> queries.</p>
</li>
<li>
<p>Full-text regular expression query (<code>REGEXP</code>) provides higher precision but lower performance than token-based queries. It is suitable for smaller-scale queries where precision is critical.</p>
</li>
</ul>
<p><strong>Performance improvement</strong></p>
<p>MiniMax implements <strong>query truncation</strong> to further accelerate queries. Log data is arranged linearly in chronological order. If a query requests data of a large range, it can consume excessive computation, storage, and network resources and potentially lead to query timeouts or even system unavailability. So they set and truncate the time range of the queries to prevent overly broad queries, and pre-calculate the data volume for all tables every 15 minutes to dynamically estimate the maximum queryable time range across different tables.</p>
<p><strong>Cost control</strong></p>
<p>To cut down storage costs, MiniMax utilizes the <strong><a href="https://doris.apache.org/docs/table-design/cold-hot-separation/" target="_blank" rel="noopener noreferrer">tiered storage</a></strong> capabilities of Apache Doris. They define data within the last 7 days as hot data and data older than 7 days as cold data. Data will be moved to object storage as soon as it turns cold. Furthermore, they archive object storage data that is over 30 days old and only restore the archived data when necessary.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="value-to-minimax">Value to MiniMax<a href="https://doris.apache.org/blog/ai-unicorn-minimax-from-loki-and-built-a-pb-scale-logging-system-with-doris#value-to-minimax" class="hash-link" aria-label="Direct link to Value to MiniMax" title="Direct link to Value to MiniMax">&#x200B;</a></h2>
<p>Now, the Apache Doris-based logging system has been supporting all business line log data within MiniMax, serving a <strong>PB-scale data size</strong> with over <strong>99.9% availability</strong>. It has also brought the following values to MiniMax:</p>
<ul>
<li>
<p><strong>Simplified architecture</strong>: The new system is easier to deploy and allows a single framework to serve all clusters. This reduces maintenance and management complexity, thus saving operational manpower and costs.</p>
</li>
<li>
<p><strong>Fast query response</strong>: The new system can respond to keyword searches and aggregation queries from 1 billion log records within 2 seconds. Most log queries can return results within seconds, too.</p>
</li>
<li>
<p><strong>High write performance</strong>: With the current hardware setups, the system can deliver a log write throughput of 10 GB/s, while maintaining data latency within seconds.</p>
</li>
<li>
<p><strong>Low storage costs</strong>: The data compression ratio reaches 5:1 and tiered storage further reduces storage costs by 70%.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">What&apos;s next<a href="https://doris.apache.org/blog/ai-unicorn-minimax-from-loki-and-built-a-pb-scale-logging-system-with-doris#whats-next" class="hash-link" aria-label="Direct link to What&apos;s next" title="Direct link to What&apos;s next">&#x200B;</a></h2>
<p>After a successful initial experience with Apache Doris, MiniMax proceeds with the next phase of its upgrade plan, which includes the following efforts:</p>
<ul>
<li>
<p><strong>Log pre-processing</strong>: introduce log sampling and structuring to improve data usability and storage efficiency.</p>
</li>
<li>
<p><strong>Tracing</strong>: integrate the logging system with other observability systems (monitoring, alerting, tracing, etc.) to provide comprehensive operational insights.</p>
</li>
<li>
<p><strong>Lakehousing</strong>: expand the use of Apache Doris include big data processing and analysis within MiniMax, laying the foundation for a data lakehouse.</p>
</li>
</ul>
<p>If you have any questions or require assistance regarding Apache Doris, join the <a href="https://join.slack.com/t/apachedoriscommunity/shared_invite/zt-2gmq5o30h-455W226d79zP3L96ZhXIoQ" target="_blank" rel="noopener noreferrer">community</a>.</p></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Best Practice" term="Best Practice"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Apache Doris 3.0.1 just released]]></title>
        <id>https://doris.apache.org/blog/release-note-3.0.1</id>
        <link href="https://doris.apache.org/blog/release-note-3.0.1"/>
        <updated>2024-08-23T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this version, Apache Doris has improvements in compute-storage decoupling, lakehouse, semi-structured data analysis and more.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Release Notes</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Apache Doris 3.0.1 just released</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-08-23T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">August 23, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Dear community members, the Apache Doris 3.0.1 version was officially released on August 23, 2024, featuring updates and improvements in compute-storage decoupling, lakehouse, semi-structured data analysis, asynchronous materialized views, and more.</p>
<p><strong>Quick Download:</strong> <a href="https://doris.apache.org/download/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/download/</a></p>
<p><strong>GitHub Release:</strong> <a href="https://github.com/apache/doris/releases" target="_blank" rel="noopener noreferrer">https://github.com/apache/doris/releases</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="behavior-changes">Behavior Changes<a href="https://doris.apache.org/blog/release-note-3.0.1#behavior-changes" class="hash-link" aria-label="Direct link to Behavior Changes" title="Direct link to Behavior Changes">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer">Query Optimizer<a href="https://doris.apache.org/blog/release-note-3.0.1#query-optimizer" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>
<p>Added the variable <code>use_max_length_of_varchar_in_ctas</code> to control the length behavior of VARCHAR type when executing <code>CREATE TABLE AS SELECT</code> (CTAS) operations.  <a href="https://github.com/apache/doris/pull/37069" target="_blank" rel="noopener noreferrer">#37069</a></p>
<ul>
<li>
<p>This variable is set to true by default.</p>
</li>
<li>
<p>When set to true, if the VARCHAR type column originates from a table, the derived length is used; otherwise, the maximum length is used.</p>
</li>
<li>
<p>When set to false, the VARCHAR type will always use the derived length.</p>
</li>
</ul>
</li>
<li>
<p>All data types will now be displayed in lowercase to maintain compatibility with MySQL format. <a href="https://github.com/apache/doris/pull/38012" target="_blank" rel="noopener noreferrer">#38012</a></p>
</li>
<li>
<p>Multiple query statements in the same query request must now be separated by semicolons. <a href="https://github.com/apache/doris/pull/38670" target="_blank" rel="noopener noreferrer">#38670</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution">Query Execution<a href="https://doris.apache.org/blog/release-note-3.0.1#query-execution" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>The default number of parallel tasks after shuffle operations in the cluster is set to 100, which will improve query stability and concurrent processing capability in large clusters. <a href="https://github.com/apache/doris/pull/38196" target="_blank" rel="noopener noreferrer">#38196</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage">Storage<a href="https://doris.apache.org/blog/release-note-3.0.1#storage" class="hash-link" aria-label="Direct link to Storage" title="Direct link to Storage">&#x200B;</a></h3>
<ul>
<li>
<p>The default value of <code>trash_file_expire_time_sec</code> has been changed from 86400 seconds to 0 seconds, which means that if files are deleted by mistake and the FE trash is cleared, the data cannot be recovered.</p>
</li>
<li>
<p>The table attribute <code>enable_mow_delete_on_delete_predicate</code> (introduced in version 3.0.0) has been renamed to <code>enable_mow_light_delete</code>.</p>
</li>
<li>
<p>Explicit transactions are now prohibited from performing delete operations on tables with written data.</p>
</li>
<li>
<p>Heavy schema change operations are prohibited on tables with auto-increment fields.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-features">New Features<a href="https://doris.apache.org/blog/release-note-3.0.1#new-features" class="hash-link" aria-label="Direct link to New Features" title="Direct link to New Features">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="job-scheduling">Job Scheduling<a href="https://doris.apache.org/blog/release-note-3.0.1#job-scheduling" class="hash-link" aria-label="Direct link to Job Scheduling" title="Direct link to Job Scheduling">&#x200B;</a></h3>
<ul>
<li>Optimized the execution logic of internal scheduling jobs, decoupling the strong association between start time and immediate execution parameters. Now, tasks can be created with a specified start time or selected for immediate execution, without conflict, enhancing scheduling flexibility. <a href="https://github.com/apache/doris/pull/36805" target="_blank" rel="noopener noreferrer">#36805</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compute-storage-decoupled">Compute-Storage Decoupled<a href="https://doris.apache.org/blog/release-note-3.0.1#compute-storage-decoupled" class="hash-link" aria-label="Direct link to Compute-Storage Decoupled" title="Direct link to Compute-Storage Decoupled">&#x200B;</a></h3>
<ul>
<li>
<p>Supports dynamic modification of the upper limit for file cache usage. <a href="https://github.com/apache/doris/pull/37484" target="_blank" rel="noopener noreferrer">#37484</a></p>
</li>
<li>
<p>Recycler now supports object storage rate limiting and server-side rate limiting retry functionality. <a href="https://github.com/apache/doris/pull/37663" target="_blank" rel="noopener noreferrer">#37663</a> <a href="https://github.com/apache/doris/pull/37680" target="_blank" rel="noopener noreferrer">#37680</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse">Lakehouse<a href="https://doris.apache.org/blog/release-note-3.0.1#lakehouse" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>
<p>Added the session variable <code>serde_dialect</code> to set the output format for complex types. <a href="https://github.com/apache/doris/pull/37039" target="_blank" rel="noopener noreferrer">#37039</a></p>
</li>
<li>
<p>SQL interception now supports external tables.</p>
<ul>
<li>For more information, refer to the documentation on  <a href="https://doris.apache.org/docs/admin-manual/query-admin/sql-interception" target="_blank" rel="noopener noreferrer">SQL Interception</a>.</li>
</ul>
</li>
<li>
<p>Insert overwrite now supports Iceberg tables. <a href="https://github.com/apache/doris/pull/37191" target="_blank" rel="noopener noreferrer">#37191</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-materialized-views">Asynchronous Materialized Views<a href="https://doris.apache.org/blog/release-note-3.0.1#asynchronous-materialized-views" class="hash-link" aria-label="Direct link to Asynchronous Materialized Views" title="Direct link to Asynchronous Materialized Views">&#x200B;</a></h3>
<ul>
<li>
<p>Supports partition roll-up and build at the hourly level. <a href="https://github.com/apache/doris/pull/37678" target="_blank" rel="noopener noreferrer">#37678</a></p>
</li>
<li>
<p>Supports atomic replacement of asynchronous materialized view definition statements. <a href="https://github.com/apache/doris/pull/36749" target="_blank" rel="noopener noreferrer">#36749</a></p>
</li>
<li>
<p>Transparent rewriting now supports Insert statements. <a href="https://github.com/apache/doris/pull/38115" target="_blank" rel="noopener noreferrer">#38115</a></p>
</li>
<li>
<p>Transparent rewriting now supports the VARIANT type. <a href="https://github.com/apache/doris/pull/37929" target="_blank" rel="noopener noreferrer">#37929</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution-1">Query Execution<a href="https://doris.apache.org/blog/release-note-3.0.1#query-execution-1" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>The group concat function now supports DISTINCT and ORDER BY options. <a href="https://github.com/apache/doris/pull/38744" target="_blank" rel="noopener noreferrer">#38744</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semi-structured-data-management">Semi-Structured Data Management<a href="https://doris.apache.org/blog/release-note-3.0.1#semi-structured-data-management" class="hash-link" aria-label="Direct link to Semi-Structured Data Management" title="Direct link to Semi-Structured Data Management">&#x200B;</a></h3>
<ul>
<li>
<p>The ES Catalog now maps <code>nested</code> or <code>object</code> types in Elasticsearch to the JSON type in Doris. <a href="https://github.com/apache/doris/pull/37101" target="_blank" rel="noopener noreferrer">#37101</a></p>
</li>
<li>
<p>Added the <code>MULTI_MATCH</code> function, which supports matching keywords across multiple fields and can leverage inverted indexes to accelerate searches. <a href="https://github.com/apache/doris/pull/37722" target="_blank" rel="noopener noreferrer">#37722</a></p>
</li>
<li>
<p>Added the <code>explode_json_object</code> function, which can unfold objects in JSON data into multiple rows. <a href="https://github.com/apache/doris/pull/36887" target="_blank" rel="noopener noreferrer">#36887</a></p>
</li>
<li>
<p>Inverted indexes now support memtable advancement, requiring index construction only once during multi-replica writes, reducing CPU consumption and improving performance. <a href="https://github.com/apache/doris/pull/35891" target="_blank" rel="noopener noreferrer">#35891</a></p>
</li>
<li>
<p>Added <code>MATCH_PHRASE</code> support for positive slop, e.g., <code>msg MATCH_PHRASE &apos;a b 2+&apos;</code> can match instances containing words a and b with a slop of no more than two, and a preceding b; regular slop without the final <code>+</code> does not guarantee this order. <a href="https://github.com/apache/doris/pull/36356" target="_blank" rel="noopener noreferrer">#36356</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other">Other<a href="https://doris.apache.org/blog/release-note-3.0.1#other" class="hash-link" aria-label="Direct link to Other" title="Direct link to Other">&#x200B;</a></h3>
<ul>
<li>
<p>Added the FE parameter <code>skip_audit_user_list</code>, where user operations specified in this configuration will not be recorded in the audit log. <a href="https://github.com/apache/doris/pull/38310" target="_blank" rel="noopener noreferrer">#38310</a></p>
<ul>
<li>For more information, refer to the documentation on <a href="https://doris.apache.org/docs/admin-manual/audit-plugin/" target="_blank" rel="noopener noreferrer">Audit Plugin</a>.</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="https://doris.apache.org/blog/release-note-3.0.1#improvements" class="hash-link" aria-label="Direct link to Improvements" title="Direct link to Improvements">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-1">Storage<a href="https://doris.apache.org/blog/release-note-3.0.1#storage-1" class="hash-link" aria-label="Direct link to Storage" title="Direct link to Storage">&#x200B;</a></h3>
<ul>
<li>
<p>Reduced the likelihood of write failures caused by disk balancing within a single BE. <a href="https://github.com/apache/doris/pull/38000" target="_blank" rel="noopener noreferrer">#38000</a></p>
</li>
<li>
<p>Decreased memory consumption by the memtable limiter. <a href="https://github.com/apache/doris/pull/37511" target="_blank" rel="noopener noreferrer">#37511</a></p>
</li>
<li>
<p>Moved old partitions to the FE trash during partition replacement operations. <a href="https://github.com/apache/doris/pull/36361" target="_blank" rel="noopener noreferrer">#36361</a></p>
</li>
<li>
<p>Optimized memory consumption during compaction. <a href="https://github.com/apache/doris/pull/37099" target="_blank" rel="noopener noreferrer">#37099</a></p>
</li>
<li>
<p>Added a session variable to control audit logs for JDBC PreparedStatement, with default setting to not print. <a href="https://github.com/apache/doris/pull/38419" target="_blank" rel="noopener noreferrer">#38419</a></p>
</li>
<li>
<p>Optimized the logic for selecting BEs for group commits. <a href="https://github.com/apache/doris/pull/35558" target="_blank" rel="noopener noreferrer">#35558</a></p>
</li>
<li>
<p>Improved the performance of column updates. <a href="https://github.com/apache/doris/pull/38487" target="_blank" rel="noopener noreferrer">#38487</a></p>
</li>
<li>
<p>Optimized the use of <code>delete bitmap cache</code>. <a href="https://github.com/apache/doris/pull/38761" target="_blank" rel="noopener noreferrer">#38761</a></p>
</li>
<li>
<p>Added a configuration to control query affinity during hot and cold tiering. <a href="https://github.com/apache/doris/pull/37492" target="_blank" rel="noopener noreferrer">#37492</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compute-storage-decoupled-1">Compute-Storage Decoupled<a href="https://doris.apache.org/blog/release-note-3.0.1#compute-storage-decoupled-1" class="hash-link" aria-label="Direct link to Compute-Storage Decoupled" title="Direct link to Compute-Storage Decoupled">&#x200B;</a></h3>
<ul>
<li>
<p>Implemented automatic retries when encountering object storage server rate limiting. <a href="https://github.com/apache/doris/pull/37199" target="_blank" rel="noopener noreferrer">#37199</a></p>
</li>
<li>
<p>Adapted the number of threads for memtable flush in the compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/38789" target="_blank" rel="noopener noreferrer">#38789</a></p>
</li>
<li>
<p>Added Azure as a compile option to support compilation in environments without Azure support.</p>
</li>
<li>
<p>Optimized the observability of object storage access rate limiting. <a href="https://github.com/apache/doris/pull/38294" target="_blank" rel="noopener noreferrer">#38294</a></p>
</li>
<li>
<p>Allowed the file cache TTL queue to perform LRU eviction, enhancing TTL queue usability. <a href="https://github.com/apache/doris/pull/37312" target="_blank" rel="noopener noreferrer">#37312</a></p>
</li>
<li>
<p>Optimized the number of balance writeeditlog IO operations in the storage and compute separation mode. <a href="https://github.com/apache/doris/pull/37787" target="_blank" rel="noopener noreferrer">#37787</a></p>
</li>
<li>
<p>Improved table creation speed in the storage and compute separation mode by sending tablet creation requests in batches. <a href="https://github.com/apache/doris/pull/36786" target="_blank" rel="noopener noreferrer">#36786</a></p>
</li>
<li>
<p>Optimized read failures caused by potential inconsistencies in the local file cache through backoff retries. <a href="https://github.com/apache/doris/pull/38645" target="_blank" rel="noopener noreferrer">#38645</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse-1">Lakehouse<a href="https://doris.apache.org/blog/release-note-3.0.1#lakehouse-1" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>
<p>Optimized memory statistics for Parquet/ORC format read and write operations. <a href="https://github.com/apache/doris/pull/37234" target="_blank" rel="noopener noreferrer">#37234</a></p>
</li>
<li>
<p>Trino Connector Catalog now supports predicate pushdown. <a href="https://github.com/apache/doris/pull/37874" target="_blank" rel="noopener noreferrer">#37874</a></p>
</li>
<li>
<p>Added a session variable <code>enable_count_push_down_for_external_table</code> to control whether to enable <code>count(*)</code> pushdown optimization for external tables. <a href="https://github.com/apache/doris/pull/37046" target="_blank" rel="noopener noreferrer">#37046</a></p>
</li>
<li>
<p>Optimized the read logic for Hudi snapshot reads, returning an empty set when the snapshot is empty, consistent with Spark behavior. <a href="https://github.com/apache/doris/pull/37702" target="_blank" rel="noopener noreferrer">#37702</a></p>
</li>
<li>
<p>Improved the read performance of partition columns for Hive tables. <a href="https://github.com/apache/doris/pull/37377" target="_blank" rel="noopener noreferrer">#37377</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-materialized-views-1">Asynchronous Materialized Views<a href="https://doris.apache.org/blog/release-note-3.0.1#asynchronous-materialized-views-1" class="hash-link" aria-label="Direct link to Asynchronous Materialized Views" title="Direct link to Asynchronous Materialized Views">&#x200B;</a></h3>
<ul>
<li>
<p>Improved transparent rewrite plan speed by 20%. <a href="https://github.com/apache/doris/pull/37197" target="_blank" rel="noopener noreferrer">#37197</a></p>
</li>
<li>
<p>Eliminated roll-up during transparent rewrite if the group key satisfies data uniqueness for better nested matching. <a href="https://github.com/apache/doris/pull/38387" target="_blank" rel="noopener noreferrer">#38387</a></p>
</li>
<li>
<p>Transparent rewrite now performs better aggregation elimination to improve the matching success rate of nested materialized views. <a href="https://github.com/apache/doris/pull/36888" target="_blank" rel="noopener noreferrer">#36888</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mysql-compatibility">MySQL Compatibility<a href="https://doris.apache.org/blog/release-note-3.0.1#mysql-compatibility" class="hash-link" aria-label="Direct link to MySQL Compatibility" title="Direct link to MySQL Compatibility">&#x200B;</a></h3>
<ul>
<li>
<p>Now correctly populates the database name, table name, and original name in the MySQL protocol result columns. <a href="https://github.com/apache/doris/pull/38126" target="_blank" rel="noopener noreferrer">#38126</a></p>
</li>
<li>
<p>Supported the hint format <code>/*+ func(value) */</code>. <a href="https://github.com/apache/doris/pull/37720" target="_blank" rel="noopener noreferrer">#37720</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer-1">Query Optimizer<a href="https://doris.apache.org/blog/release-note-3.0.1#query-optimizer-1" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>
<p>Significantly improved the plan speed for complex queries. <a href="https://github.com/apache/doris/pull/38317" target="_blank" rel="noopener noreferrer">#38317</a></p>
</li>
<li>
<p>Adaptively chose whether to perform bucket shuffle based on the number of data buckets to avoid performance degradation in extreme cases. <a href="https://github.com/apache/doris/pull/36784" target="_blank" rel="noopener noreferrer">#36784</a></p>
</li>
<li>
<p>Optimized the cost estimation logic for SEMI / ANTI JOIN. <a href="https://github.com/apache/doris/pull/37951" target="_blank" rel="noopener noreferrer">#37951</a> <a href="https://github.com/apache/doris/pull/37060" target="_blank" rel="noopener noreferrer">#37060</a></p>
</li>
<li>
<p>Supported pushing Limit down to the first stage of aggregation to improve performance. <a href="https://github.com/apache/doris/pull/34853" target="_blank" rel="noopener noreferrer">#34853</a></p>
</li>
<li>
<p>Partition pruning now supports filter conditions containing the <code>date_trunc</code> or <code>date</code> function. <a href="https://github.com/apache/doris/pull/38025" target="_blank" rel="noopener noreferrer">#38025</a> <a href="https://github.com/apache/doris/pull/38743" target="_blank" rel="noopener noreferrer">#38743</a></p>
</li>
<li>
<p>SQL cache now supports query scenarios that include user variables. <a href="https://github.com/apache/doris/pull/37915" target="_blank" rel="noopener noreferrer">#37915</a></p>
</li>
<li>
<p>Optimized error messages for invalid aggregation semantics. <a href="https://github.com/apache/doris/pull/38122" target="_blank" rel="noopener noreferrer">#38122</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution-2">Query Execution<a href="https://doris.apache.org/blog/release-note-3.0.1#query-execution-2" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>
<p>Adapted AggState compatibility from 2.1 to 3.x and fixed Coredump issues. <a href="https://github.com/apache/doris/pull/37104" target="_blank" rel="noopener noreferrer">#37104</a></p>
</li>
<li>
<p>Refactored the strategy selection for local shuffle without Join. <a href="https://github.com/apache/doris/pull/37282" target="_blank" rel="noopener noreferrer">#37282</a></p>
</li>
<li>
<p>Modified the scanner for internal table queries to be asynchronous to prevent stalling during such queries. <a href="https://github.com/apache/doris/pull/38403" target="_blank" rel="noopener noreferrer">#38403</a></p>
</li>
<li>
<p>Optimized the block merge process during Hash table construction for Join operators. <a href="https://github.com/apache/doris/pull/37471" target="_blank" rel="noopener noreferrer">#37471</a></p>
</li>
<li>
<p>Optimized the duration of lock holding for MultiCast. <a href="https://github.com/apache/doris/pull/37462" target="_blank" rel="noopener noreferrer">#37462</a></p>
</li>
<li>
<p>Optimized gRPC keepAliveTime and added link monitoring to reduce the probability of query failure due to RPC errors. <a href="https://github.com/apache/doris/pull/37304" target="_blank" rel="noopener noreferrer">#37304</a></p>
</li>
<li>
<p>Cleaned up all dirty pages in jemalloc when memory limits were exceeded. <a href="https://github.com/apache/doris/pull/37164" target="_blank" rel="noopener noreferrer">#37164</a></p>
</li>
<li>
<p>Optimized the processing performance of <code>aes_encrypt</code>/<code>decrypt</code> functions for constant types. <a href="https://github.com/apache/doris/pull/37194" target="_blank" rel="noopener noreferrer">#37194</a></p>
</li>
<li>
<p>Optimized the processing performance of the <code>json_extract</code> function for constant data. <a href="https://github.com/apache/doris/pull/36927" target="_blank" rel="noopener noreferrer">#36927</a></p>
</li>
<li>
<p>Optimized the processing performance of the <code>ParseUrl</code> function for constant data. <a href="https://github.com/apache/doris/pull/36882" target="_blank" rel="noopener noreferrer">#36882</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semi-structured-data-management-1">Semi-Structured Data Management<a href="https://doris.apache.org/blog/release-note-3.0.1#semi-structured-data-management-1" class="hash-link" aria-label="Direct link to Semi-Structured Data Management" title="Direct link to Semi-Structured Data Management">&#x200B;</a></h3>
<ul>
<li>
<p>Bitmap indexes now default to using inverted indexes, with <code>enable_create_bitmap_index_as_inverted_index</code> set to true by default. <a href="https://github.com/apache/doris/pull/36692" target="_blank" rel="noopener noreferrer">#36692</a></p>
</li>
<li>
<p>In the compute-storage decoupled mode, DESC can now view sub-columns of VARIANT type. <a href="https://github.com/apache/doris/pull/38143" target="_blank" rel="noopener noreferrer">#38143</a></p>
</li>
<li>
<p>Removed the step of checking file existence during inverted index queries to reduce access latency to remote storage. <a href="https://github.com/apache/doris/pull/36945" target="_blank" rel="noopener noreferrer">#36945</a></p>
</li>
<li>
<p>Complex types ARRAY / MAP / STRUCT now support <code>replace_if_not_null</code> for AGG tables. <a href="https://github.com/apache/doris/pull/38304" target="_blank" rel="noopener noreferrer">#38304</a></p>
</li>
<li>
<p>Escape characters for JSON data are now supported. <a href="https://github.com/apache/doris/pull/37176" target="_blank" rel="noopener noreferrer">#37176</a> <a href="https://github.com/apache/doris/pull/37251" target="_blank" rel="noopener noreferrer">#37251</a></p>
</li>
<li>
<p>Inverted index queries now behave consistently on MOW tables and DUP tables. <a href="https://github.com/apache/doris/pull/37428" target="_blank" rel="noopener noreferrer">#37428</a></p>
</li>
<li>
<p>Optimized the performance of inverted index acceleration for IN queries. <a href="https://github.com/apache/doris/pull/37395" target="_blank" rel="noopener noreferrer">#37395</a></p>
</li>
<li>
<p>Reduced unnecessary memory allocation during TOPN queries to improve performance. <a href="https://github.com/apache/doris/pull/37429" target="_blank" rel="noopener noreferrer">#37429</a></p>
</li>
<li>
<p>When creating an inverted index with tokenization, the <code>support_phrase</code> option is now automatically enabled to accelerate <code>match_phrase</code> series phrase queries. <a href="https://github.com/apache/doris/pull/37949" target="_blank" rel="noopener noreferrer">#37949</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-1">Other<a href="https://doris.apache.org/blog/release-note-3.0.1#other-1" class="hash-link" aria-label="Direct link to Other" title="Direct link to Other">&#x200B;</a></h3>
<ul>
<li>
<p>Audit log now can record SQL types. <a href="https://github.com/apache/doris/pull/37790" target="_blank" rel="noopener noreferrer">#37790</a></p>
</li>
<li>
<p>Added support for <code>information_schema.processlist</code> to show all FE. <a href="https://github.com/apache/doris/pull/38701" target="_blank" rel="noopener noreferrer">#38701</a></p>
</li>
<li>
<p>Cached ranger&apos;s <code>atamask</code> and <code>rowpolicy</code> to accelerate query efficiency. <a href="https://github.com/apache/doris/pull/37723" target="_blank" rel="noopener noreferrer">#37723</a></p>
</li>
<li>
<p>Optimized metadata management in job manager to release locks immediately after modifying metadata, reducing lock holding time. <a href="https://github.com/apache/doris/pull/38162" target="_blank" rel="noopener noreferrer">#38162</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug Fixes<a href="https://doris.apache.org/blog/release-note-3.0.1#bug-fixes" class="hash-link" aria-label="Direct link to Bug Fixes" title="Direct link to Bug Fixes">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade">Upgrade<a href="https://doris.apache.org/blog/release-note-3.0.1#upgrade" class="hash-link" aria-label="Direct link to Upgrade" title="Direct link to Upgrade">&#x200B;</a></h3>
<ul>
<li>
<p>Fix the issue where <code>mtmv load</code> fails during upgrade from version 2.1. <a href="https://github.com/apache/doris/pull/38799" target="_blank" rel="noopener noreferrer">#38799</a></p>
</li>
<li>
<p>Resolve the issue where <code>null_type</code> cannot be found during the upgrade to version 2.1. <a href="https://github.com/apache/doris/pull/39373" target="_blank" rel="noopener noreferrer">#39373</a></p>
</li>
<li>
<p>Address the compatibility issue with permission persistence during the upgrade from version 2.1 to 3.0. <a href="https://github.com/apache/doris/pull/39288" target="_blank" rel="noopener noreferrer">#39288</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="load">Load<a href="https://doris.apache.org/blog/release-note-3.0.1#load" class="hash-link" aria-label="Direct link to Load" title="Direct link to Load">&#x200B;</a></h3>
<ul>
<li>
<p>Fix the issue where parsing fails when the newline character is surrounded by delimiters in CSV format parsing. <a href="https://github.com/apache/doris/pull/38347" target="_blank" rel="noopener noreferrer">#38347</a></p>
</li>
<li>
<p>Resolve potential exception issues when FE forwards group commit. <a href="https://github.com/apache/doris/pull/38228" target="_blank" rel="noopener noreferrer">#38228</a> <a href="https://github.com/apache/doris/pull/38265" target="_blank" rel="noopener noreferrer">#38265</a></p>
</li>
<li>
<p>Group commit now supports the new optimizer. <a href="https://github.com/apache/doris/pull/37002" target="_blank" rel="noopener noreferrer">#37002</a></p>
</li>
<li>
<p>Fix the issue where group commit reports data errors when JDBC setNull is used. <a href="https://github.com/apache/doris/pull/38262" target="_blank" rel="noopener noreferrer">#38262</a></p>
</li>
<li>
<p>Optimize the retry logic for group commit when encountering <code>delete bitmap lock</code> errors. <a href="https://github.com/apache/doris/pull/37600" target="_blank" rel="noopener noreferrer">#37600</a></p>
</li>
<li>
<p>Resolve the issue where routine load cannot use CSV delimiters and escape characters. <a href="https://github.com/apache/doris/pull/38402" target="_blank" rel="noopener noreferrer">#38402</a></p>
</li>
<li>
<p>Fix the issue where routine load job names with mixed case cannot be displayed. <a href="https://github.com/apache/doris/pull/38523" target="_blank" rel="noopener noreferrer">#38523</a></p>
</li>
<li>
<p>Optimize the logic for actively recovering routine load during FE master-slave switching. <a href="https://github.com/apache/doris/pull/37876" target="_blank" rel="noopener noreferrer">#37876</a></p>
</li>
<li>
<p>Resolve the issue where routine load pauses when all data in Kafka is expired. <a href="https://github.com/apache/doris/pull/37288" target="_blank" rel="noopener noreferrer">#37288</a></p>
</li>
<li>
<p>Fix the issue where <code>show routine load</code> returns empty results. <a href="https://github.com/apache/doris/pull/38199" target="_blank" rel="noopener noreferrer">#38199</a></p>
</li>
<li>
<p>Resolve the memory leak issue during multi-table stream import in routine load. <a href="https://github.com/apache/doris/pull/38255" target="_blank" rel="noopener noreferrer">#38255</a></p>
</li>
<li>
<p>Fix the issue where stream load does not return the error URL. <a href="https://github.com/apache/doris/pull/38325" target="_blank" rel="noopener noreferrer">#38325</a></p>
</li>
<li>
<p>Resolve potential load channel leak issues. <a href="https://github.com/apache/doris/pull/38031" target="_blank" rel="noopener noreferrer">#38031</a> <a href="https://github.com/apache/doris/pull/37500" target="_blank" rel="noopener noreferrer">#37500</a></p>
</li>
<li>
<p>Fix the issue where no error may be reported when importing fewer segments than expected. <a href="https://github.com/apache/doris/pull/36753" target="_blank" rel="noopener noreferrer">#36753</a></p>
</li>
<li>
<p>Resolve the load stream leak issue. <a href="https://github.com/apache/doris/pull/38912" target="_blank" rel="noopener noreferrer">#38912</a></p>
</li>
<li>
<p>Optimize the impact of offline nodes on import operations. <a href="https://github.com/apache/doris/pull/38198" target="_blank" rel="noopener noreferrer">#38198</a></p>
</li>
<li>
<p>Fix the issue where transactions do not end when inserting into empty data. <a href="https://github.com/apache/doris/pull/38991" target="_blank" rel="noopener noreferrer">#38991</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="storage-2">Storage<a href="https://doris.apache.org/blog/release-note-3.0.1#storage-2" class="hash-link" aria-label="Direct link to Storage" title="Direct link to Storage">&#x200B;</a></h3>
<p><strong>01 Backup and Restoration</strong></p>
<ul>
<li>
<p>Fix the issue where tables cannot be written after backup and restoration. <a href="https://github.com/apache/doris/pull/37089" target="_blank" rel="noopener noreferrer">#37089</a></p>
</li>
<li>
<p>Resolve the issue where view database names are incorrect after backup and restoration. <a href="https://github.com/apache/doris/pull/37412" target="_blank" rel="noopener noreferrer">#37412</a></p>
</li>
</ul>
<p><strong>02 Compaction</strong></p>
<ul>
<li>
<p>Fix the issue where cumu compaction handles delete errors incorrectly during ordered data compression. <a href="https://github.com/apache/doris/pull/38742" target="_blank" rel="noopener noreferrer">#38742</a></p>
</li>
<li>
<p>Resolve the issue of duplicate keys in aggregate tables caused by sequential compression optimization. <a href="https://github.com/apache/doris/pull/38224" target="_blank" rel="noopener noreferrer">#38224</a></p>
</li>
<li>
<p>Fix the issue where compression operations cause coredump in large wide tables. <a href="https://github.com/apache/doris/pull/37960" target="_blank" rel="noopener noreferrer">#37960</a></p>
</li>
<li>
<p>Resolve the compression starvation issue caused by inaccurate concurrent statistics of compression tasks. <a href="https://github.com/apache/doris/pull/37318" target="_blank" rel="noopener noreferrer">#37318</a></p>
</li>
</ul>
<p><strong>03 MOW Unique Key</strong></p>
<ul>
<li>
<p>Resolve the issue of inconsistent data between replicas caused by cumulative compression deletion of delete sign. <a href="https://github.com/apache/doris/pull/37950" target="_blank" rel="noopener noreferrer">#37950</a></p>
</li>
<li>
<p>MOW delete now uses partial column updates with the new optimizer. <a href="https://github.com/apache/doris/pull/38751" target="_blank" rel="noopener noreferrer">#38751</a></p>
</li>
<li>
<p>Fix the potential duplicate key issue in MOW tables under compute-storage decoupled. <a href="https://github.com/apache/doris/pull/39018" target="_blank" rel="noopener noreferrer">#39018</a></p>
</li>
<li>
<p>Resolve the issue where MOW unique and duplicate tables cannot modify column order. <a href="https://github.com/apache/doris/pull/37067" target="_blank" rel="noopener noreferrer">#37067</a></p>
</li>
<li>
<p>Fix the potential data correctness issue caused by segcompaction. <a href="https://github.com/apache/doris/pull/37760" target="_blank" rel="noopener noreferrer">#37760</a></p>
</li>
<li>
<p>Resolve the potential memory leak issue during column updates. <a href="https://github.com/apache/doris/pull/37706" target="_blank" rel="noopener noreferrer">#37706</a></p>
</li>
</ul>
<p><strong>04 Other</strong></p>
<ul>
<li>
<p>Fix the small probability of exceptions in TOPN queries. <a href="https://github.com/apache/doris/pull/39119" target="_blank" rel="noopener noreferrer">#39119</a> <a href="https://github.com/apache/doris/pull/39199" target="_blank" rel="noopener noreferrer">#39199</a></p>
</li>
<li>
<p>Resolve the issue where auto-increment IDs may duplicate during FE restart. <a href="https://github.com/apache/doris/pull/37306" target="_blank" rel="noopener noreferrer">#37306</a></p>
</li>
<li>
<p>Fix the potential queuing issue in the delete operation priority queue. <a href="https://github.com/apache/doris/pull/37169" target="_blank" rel="noopener noreferrer">#37169</a></p>
</li>
<li>
<p>Optimize the delete retry logic. <a href="https://github.com/apache/doris/pull/37363" target="_blank" rel="noopener noreferrer">#37363</a></p>
</li>
<li>
<p>Resolve the issue with <code>bucket = 0</code> in table creation statements under the new optimizer. <a href="https://github.com/apache/doris/pull/38971" target="_blank" rel="noopener noreferrer">#38971</a></p>
</li>
<li>
<p>Fix the issue where FE reports success incorrectly when image generation fails. <a href="https://github.com/apache/doris/pull/37508" target="_blank" rel="noopener noreferrer">#37508</a></p>
</li>
<li>
<p>Resolve the issue where using the wrong nodename during FE offline nodes may cause inconsistent FE members. <a href="https://github.com/apache/doris/pull/37987" target="_blank" rel="noopener noreferrer">#37987</a></p>
</li>
<li>
<p>Fix the issue where CCR partition addition may fail. <a href="https://github.com/apache/doris/pull/37295" target="_blank" rel="noopener noreferrer">#37295</a></p>
</li>
<li>
<p>Resolve the <code>int32</code> overflow issue in inverted index files. <a href="https://github.com/apache/doris/pull/38891" target="_blank" rel="noopener noreferrer">#38891</a></p>
</li>
<li>
<p>Fix the issue where TRUNCATE TABLE failure may cause BE to fail to go offline. <a href="https://github.com/apache/doris/pull/37334" target="_blank" rel="noopener noreferrer">#37334</a></p>
</li>
<li>
<p>Resolve the issue where publish cannot continue due to null pointers. <a href="https://github.com/apache/doris/pull/37724" target="_blank" rel="noopener noreferrer">#37724</a> <a href="https://github.com/apache/doris/pull/37531" target="_blank" rel="noopener noreferrer">#37531</a></p>
</li>
<li>
<p>Fix the potential coredump issue when manually triggering disk migration. <a href="https://github.com/apache/doris/pull/37712" target="_blank" rel="noopener noreferrer">#37712</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compute-storage-decoupled-2">Compute-Storage Decoupled<a href="https://doris.apache.org/blog/release-note-3.0.1#compute-storage-decoupled-2" class="hash-link" aria-label="Direct link to Compute-Storage Decoupled" title="Direct link to Compute-Storage Decoupled">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue where <code>show create table</code> might display the <code>file_cache_ttl_seconds</code> attribute twice. <a href="https://github.com/apache/doris/pull/38052" target="_blank" rel="noopener noreferrer">#38052</a></p>
</li>
<li>
<p>Fixed the issue where segment Footer TTL was not set correctly after setting file cache TTL. <a href="https://github.com/apache/doris/pull/37485" target="_blank" rel="noopener noreferrer">#37485</a></p>
</li>
<li>
<p>Fixed the issue where file cache might cause coredump due to massive conversion of cache types. <a href="https://github.com/apache/doris/pull/38518" target="_blank" rel="noopener noreferrer">#38518</a></p>
</li>
<li>
<p>Fixed the potential file descriptor (fd) leak in file cache. <a href="https://github.com/apache/doris/pull/38051" target="_blank" rel="noopener noreferrer">#38051</a></p>
</li>
<li>
<p>Fixed the issue where schema change Job overwriting compaction Job prevented base tablet compaction from completing normally. <a href="https://github.com/apache/doris/pull/38210" target="_blank" rel="noopener noreferrer">#38210</a></p>
</li>
<li>
<p>Fixed the potential inaccuracy of base compaction score due to data race. <a href="https://github.com/apache/doris/pull/38006" target="_blank" rel="noopener noreferrer">#38006</a></p>
</li>
<li>
<p>Fixed the issue where error messages from imports might not be uploaded correctly to object storage. <a href="https://github.com/apache/doris/pull/38359" target="_blank" rel="noopener noreferrer">#38359</a></p>
</li>
<li>
<p>Fixed the inconsistency in return information between compute-storage decoupled mode and storage and compute integration mode for 2PC imports. <a href="https://github.com/apache/doris/pull/38076" target="_blank" rel="noopener noreferrer">#38076</a></p>
</li>
<li>
<p>Fix the issue where incorrect file size setting during file cache warm-up leads to coredump. <a href="https://github.com/apache/doris/pull/38939" target="_blank" rel="noopener noreferrer">#38939</a></p>
</li>
<li>
<p>Fixed the issue where partial column updates did not correctly dequeue delete operations. <a href="https://github.com/apache/doris/pull/37151" target="_blank" rel="noopener noreferrer">#37151</a></p>
</li>
<li>
<p>Fixed compatibility issues with permission persistence in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/38136" target="_blank" rel="noopener noreferrer">#38136</a> <a href="https://github.com/apache/doris/pull/37708" target="_blank" rel="noopener noreferrer">#37708</a></p>
</li>
<li>
<p>Fixed the issue where observer did not retry correctly when encountering a <code>-230</code> error. <a href="https://github.com/apache/doris/pull/37625" target="_blank" rel="noopener noreferrer">#37625</a></p>
</li>
<li>
<p>Fixed the issue where <code>show load</code> with conditions did not perform correct analysis. <a href="https://github.com/apache/doris/pull/37656" target="_blank" rel="noopener noreferrer">#37656</a></p>
</li>
<li>
<p>Fixed the issue where <code>show streamload</code> in compute-storage decoupled mode caused BE coredump. <a href="https://github.com/apache/doris/pull/37903" target="_blank" rel="noopener noreferrer">#37903</a></p>
</li>
<li>
<p>Fixed the issue where <code>copy into</code> did not correctly verify column names in strict mode. <a href="https://github.com/apache/doris/pull/37650" target="_blank" rel="noopener noreferrer">#37650</a></p>
</li>
<li>
<p>Fixed the issue where multi-stream imports into a single table lacked permissions. <a href="https://github.com/apache/doris/pull/38878" target="_blank" rel="noopener noreferrer">#38878</a></p>
</li>
<li>
<p>Fixed the potential overflow issue in <code>getVersionUpdateTimeMs</code>. <a href="https://github.com/apache/doris/pull/38074" target="_blank" rel="noopener noreferrer">#38074</a></p>
</li>
<li>
<p>Fixed the issue where FE azure blob list was not implemented correctly. <a href="https://github.com/apache/doris/pull/37986" target="_blank" rel="noopener noreferrer">#37986</a></p>
</li>
<li>
<p>Fixed the issue where inaccurate azure blob recycling time calculation prevented recycling. <a href="https://github.com/apache/doris/pull/37535" target="_blank" rel="noopener noreferrer">#37535</a></p>
</li>
<li>
<p>Fixed the issue where inverted index files were not deleted in compute-storage decoupled mode. <a href="https://github.com/apache/doris/pull/38306" target="_blank" rel="noopener noreferrer">#38306</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse-2">Lakehouse<a href="https://doris.apache.org/blog/release-note-3.0.1#lakehouse-2" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue with reading binary data from Oracle Catalog. <a href="https://github.com/apache/doris/pull/37078" target="_blank" rel="noopener noreferrer">#37078</a></p>
</li>
<li>
<p>Fixed the potential deadlock issue when acquiring external table metadata in multi-FE scenarios. <a href="https://github.com/apache/doris/pull/37756" target="_blank" rel="noopener noreferrer">#37756</a></p>
</li>
<li>
<p>Fixed the issue where JNI scanner failure caused BE nodes to crash. <a href="https://github.com/apache/doris/pull/37697" target="_blank" rel="noopener noreferrer">#37697</a></p>
</li>
<li>
<p>Fixed the issue with slow reading of date types from Trino Connector Catalog. <a href="https://github.com/apache/doris/pull/37266" target="_blank" rel="noopener noreferrer">#37266</a></p>
</li>
<li>
<p>Optimized kerberos authentication logic for Hive Catalog. <a href="https://github.com/apache/doris/pull/37301" target="_blank" rel="noopener noreferrer">#37301</a></p>
</li>
<li>
<p>Fixed the issue where region attributes might be parsed incorrectly when parsing MinIO properties. <a href="https://github.com/apache/doris/pull/37249" target="_blank" rel="noopener noreferrer">#37249</a></p>
</li>
<li>
<p>Fixed the issue where creating too many FileSystems by FE caused memory leaks. <a href="https://github.com/apache/doris/pull/36954" target="_blank" rel="noopener noreferrer">#36954</a></p>
</li>
<li>
<p>Fixed the issue with reading incorrect time zone information from Paimon. <a href="https://github.com/apache/doris/pull/37716" target="_blank" rel="noopener noreferrer">#37716</a></p>
</li>
<li>
<p>Fixed the potential thread leak issue caused by Hive write-back operations. <a href="https://github.com/apache/doris/pull/36990" target="_blank" rel="noopener noreferrer">#36990</a></p>
</li>
<li>
<p>Fixed the null pointer issue caused by enabling Hive metastore event synchronization. <a href="https://github.com/apache/doris/pull/38421" target="_blank" rel="noopener noreferrer">#38421</a></p>
</li>
<li>
<p>Fixed the issue where error messages were unclear or caused stalling when creating catalogs. <a href="https://github.com/apache/doris/pull/37551" target="_blank" rel="noopener noreferrer">#37551</a></p>
</li>
<li>
<p>Fixed the issue where reading Hive text format tables behaved differently from Hive. <a href="https://github.com/apache/doris/pull/37638" target="_blank" rel="noopener noreferrer">#37638</a></p>
</li>
<li>
<p>Fixed the logic error when switching between catalogs and databases. <a href="https://github.com/apache/doris/pull/37828" target="_blank" rel="noopener noreferrer">#37828</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mysql-compatibility-1">MySQL Compatibility<a href="https://doris.apache.org/blog/release-note-3.0.1#mysql-compatibility-1" class="hash-link" aria-label="Direct link to MySQL Compatibility" title="Direct link to MySQL Compatibility">&#x200B;</a></h3>
<ul>
<li>Fixed the issue where certain flags in the MySQL protocol were set incorrectly when SSL was enabled. <a href="https://github.com/apache/doris/pull/38086" target="_blank" rel="noopener noreferrer">#38086</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-materialized-views-2">Asynchronous Materialized Views<a href="https://doris.apache.org/blog/release-note-3.0.1#asynchronous-materialized-views-2" class="hash-link" aria-label="Direct link to Asynchronous Materialized Views" title="Direct link to Asynchronous Materialized Views">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue where construction might fail when the base table had a very large number of partitions. <a href="https://github.com/apache/doris/pull/37589" target="_blank" rel="noopener noreferrer">#37589</a></p>
</li>
<li>
<p>Fixed the issue where nested materialized views incorrectly performed full table refreshes even when partition refreshes were possible. <a href="https://github.com/apache/doris/pull/38698" target="_blank" rel="noopener noreferrer">#38698</a></p>
</li>
<li>
<p>Fixed the issue where partition refresh could not handle the simultaneous existence of valid and invalid dependencies when analyzing partition dependencies. <a href="https://github.com/apache/doris/pull/38367" target="_blank" rel="noopener noreferrer">#38367</a></p>
</li>
<li>
<p>Fixed the issue where the final result containing NULL type might cause asynchronous materialized views to fail. <a href="https://github.com/apache/doris/pull/37019" target="_blank" rel="noopener noreferrer">#37019</a></p>
</li>
<li>
<p>Fixed the planning error that might occur during transparent rewriting when both synchronous and asynchronous materialized views with the same name were present. <a href="https://github.com/apache/doris/pull/37311" target="_blank" rel="noopener noreferrer">#37311</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="synchronous-materialized-views">Synchronous Materialized Views<a href="https://doris.apache.org/blog/release-note-3.0.1#synchronous-materialized-views" class="hash-link" aria-label="Direct link to Synchronous Materialized Views" title="Direct link to Synchronous Materialized Views">&#x200B;</a></h3>
<ul>
<li>
<p>The rewritten synchronous materialized views now can correctly perform partition pruning. <a href="https://github.com/apache/doris/pull/38527" target="_blank" rel="noopener noreferrer">#38527</a></p>
</li>
<li>
<p>When rewriting synchronous materialized views, those with unready data are no longer selected. <a href="https://github.com/apache/doris/pull/38148" target="_blank" rel="noopener noreferrer">#38148</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer-2">Query Optimizer<a href="https://doris.apache.org/blog/release-note-3.0.1#query-optimizer-2" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the deadlock issue that might occur when queries and delete operations are performed simultaneously. <a href="https://github.com/apache/doris/pull/38660" target="_blank" rel="noopener noreferrer">#38660</a></p>
</li>
<li>
<p>Fixed the issue where bucket pruning might incorrectly prune on decimal column buckets. <a href="https://github.com/apache/doris/pull/37889" target="_blank" rel="noopener noreferrer">#37889</a></p>
</li>
<li>
<p>Fixed the issue where planning might be incorrect when mark join participates in join reorder. <a href="https://github.com/apache/doris/pull/39152" target="_blank" rel="noopener noreferrer">#39152</a></p>
</li>
<li>
<p>Fixed the issue where the result is incorrect when the correlation condition of a correlated subquery is not a simple column. <a href="https://github.com/apache/doris/pull/37644" target="_blank" rel="noopener noreferrer">#37644</a></p>
</li>
<li>
<p>Fixed the issue where partition pruning cannot correctly handle or expressions. <a href="https://github.com/apache/doris/pull/38897" target="_blank" rel="noopener noreferrer">#38897</a></p>
</li>
<li>
<p>Fixed the planning error that might occur when optimizing the execution order of JOIN and AGG. <a href="https://github.com/apache/doris/pull/37343" target="_blank" rel="noopener noreferrer">#37343</a></p>
</li>
<li>
<p>Fixed the issue where <code>str_to_date</code> performs incorrect constant folding calculations on datev1 types. <a href="https://github.com/apache/doris/pull/37360" target="_blank" rel="noopener noreferrer">#37360</a></p>
</li>
<li>
<p>Fixed the issue where the ACOS function&apos;s constant folding returns non-NaN values. <a href="https://github.com/apache/doris/pull/37932" target="_blank" rel="noopener noreferrer">#37932</a></p>
</li>
<li>
<p>Fixed the occasional planning error: &quot;The children format needs to be [WhenClause+, DefaultValue?]&quot;. <a href="https://github.com/apache/doris/pull/38491" target="_blank" rel="noopener noreferrer">#38491</a></p>
</li>
<li>
<p>Fixed the issue where planning might be incorrect when the projection includes window functions and there is both the original column and its alias. <a href="https://github.com/apache/doris/pull/38166" target="_blank" rel="noopener noreferrer">#38166</a></p>
</li>
<li>
<p>Fixed the issue where planning might report an error when the aggregation parameter contains a lambda expression. <a href="https://github.com/apache/doris/pull/37109" target="_blank" rel="noopener noreferrer">#37109</a></p>
</li>
<li>
<p>Fixed the insert error that might occur in extreme cases: &quot;MultiCastDataSink cannot be cast to DataStreamSink&quot;. <a href="https://github.com/apache/doris/pull/38526" target="_blank" rel="noopener noreferrer">#38526</a></p>
</li>
<li>
<p>Fixed the issue where the new optimizer does not correctly handle <code>char(0)/varchar(0)</code> when creating a table. <a href="https://github.com/apache/doris/pull/38427" target="_blank" rel="noopener noreferrer">#38427</a></p>
</li>
<li>
<p>Fixed the incorrect behavior of <code>char(255) toSql</code>. <a href="https://github.com/apache/doris/pull/37340" target="_blank" rel="noopener noreferrer">#37340</a></p>
</li>
<li>
<p>Fixed the issue where the nullable attribute within the <code>agg_state</code> type might lead to planning errors. <a href="https://github.com/apache/doris/pull/37489" target="_blank" rel="noopener noreferrer">#37489</a></p>
</li>
<li>
<p>Fixed the issue where row count statistics are inaccurate during mark Join. <a href="https://github.com/apache/doris/pull/38270" target="_blank" rel="noopener noreferrer">#38270</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution-3">Query Execution<a href="https://doris.apache.org/blog/release-note-3.0.1#query-execution-3" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed issues where the Pipeline execution engine was stuck, causing queries to not end, in multiple scenarios. <a href="https://github.com/apache/doris/pull/38657" target="_blank" rel="noopener noreferrer">#38657</a>, <a href="https://github.com/apache/doris/pull/38206" target="_blank" rel="noopener noreferrer">#38206</a>, <a href="https://github.com/apache/doris/pull/38885" target="_blank" rel="noopener noreferrer">#38885</a>, <a href="https://github.com/apache/doris/pull/38151" target="_blank" rel="noopener noreferrer">#38151</a>, <a href="https://github.com/apache/doris/pull/37297" target="_blank" rel="noopener noreferrer">#37297</a></p>
</li>
<li>
<p>Fixed the coredump issue caused by NULL and non-NULL columns during set difference calculations. <a href="https://github.com/apache/doris/pull/38750" target="_blank" rel="noopener noreferrer">#38750</a></p>
</li>
<li>
<p>Fixed the error when using the DECIMAL type with pure decimals in delete statements. <a href="https://github.com/apache/doris/pull/37801" target="_blank" rel="noopener noreferrer">#37801</a></p>
</li>
<li>
<p>Fixed the issue where the <code>width_bucket</code> function returned incorrect results. <a href="https://github.com/apache/doris/pull/37892" target="_blank" rel="noopener noreferrer">#37892</a></p>
</li>
<li>
<p>Fixed the query error when a single row of data was very large and the result set was also large (exceeding 2GB). <a href="https://github.com/apache/doris/pull/37990" target="_blank" rel="noopener noreferrer">#37990</a></p>
</li>
<li>
<p>Fixed the coredump issue caused by incorrect release of rpc connections during single-replica imports. <a href="https://github.com/apache/doris/pull/38087" target="_blank" rel="noopener noreferrer">#38087</a></p>
</li>
<li>
<p>Fixed the coredump issue caused by processing NULL values with the <code>foreach</code> function. <a href="https://github.com/apache/doris/pull/37349" target="_blank" rel="noopener noreferrer">#37349</a></p>
</li>
<li>
<p>Fixed the issue where stddev returned incorrect results for DECIMALV2 types. <a href="https://github.com/apache/doris/pull/38731" target="_blank" rel="noopener noreferrer">#38731</a></p>
</li>
<li>
<p>Fixed the slow performance of <code>bitmap union</code> calculations. <a href="https://github.com/apache/doris/pull/37816" target="_blank" rel="noopener noreferrer">#37816</a></p>
</li>
<li>
<p>Fixed the issue where RowsProduced for aggregation operators was not set in the profile. <a href="https://github.com/apache/doris/pull/38271" target="_blank" rel="noopener noreferrer">#38271</a></p>
</li>
<li>
<p>Fixed the overflow issue when calculating the number of buckets for the hash table under hash join. <a href="https://github.com/apache/doris/pull/37193" target="_blank" rel="noopener noreferrer">#37193</a>, <a href="https://github.com/apache/doris/pull/37493" target="_blank" rel="noopener noreferrer">#37493</a></p>
</li>
<li>
<p>Fixed the inaccurate recording of the <code>jemalloc cache memory tracker</code>. <a href="https://github.com/apache/doris/pull/37464" target="_blank" rel="noopener noreferrer">#37464</a></p>
</li>
<li>
<p>Added the <code>enable_stacktrace</code> configuration option, allowing users to control whether exception stacks are output in BE logs. <a href="https://github.com/apache/doris/pull/37713" target="_blank" rel="noopener noreferrer">#37713</a></p>
</li>
<li>
<p>Fixed the issue where Arrow Flight SQL did not work correctly when <code>enable_parallel_result_sink</code> was set to false. <a href="https://github.com/apache/doris/pull/37779" target="_blank" rel="noopener noreferrer">#37779</a></p>
</li>
<li>
<p>Fixed the incorrect use of colocate Join. <a href="https://github.com/apache/doris/pull/37361" target="_blank" rel="noopener noreferrer">#37361</a>, <a href="https://github.com/apache/doris/pull/37729" target="_blank" rel="noopener noreferrer">#37729</a></p>
</li>
<li>
<p>Fixed the calculation overflow issue of the <code>round</code> function on DECIMAL128 types. <a href="https://github.com/apache/doris/pull/37733" target="_blank" rel="noopener noreferrer">#37733</a>, <a href="https://github.com/apache/doris/pull/38106" target="_blank" rel="noopener noreferrer">#38106</a></p>
</li>
<li>
<p>Fixed the coredump issue when passing a const string to the <code>sleep</code> function. <a href="https://github.com/apache/doris/pull/37681" target="_blank" rel="noopener noreferrer">#37681</a></p>
</li>
<li>
<p>Increased the queue length for audit logs, solving the issue where audit logs could not be recorded normally under high concurrency scenarios with thousands of concurrent connections. <a href="https://github.com/apache/doris/pull/37786" target="_blank" rel="noopener noreferrer">#37786</a></p>
</li>
<li>
<p>Fixed the issue where creating a workload group caused too many threads, leading to BE coredump. <a href="https://github.com/apache/doris/pull/38096" target="_blank" rel="noopener noreferrer">#38096</a></p>
</li>
<li>
<p>Fixed the coredump issue caused by the <code>MULTI_MATCH_ANY</code> function. <a href="https://github.com/apache/doris/pull/37959" target="_blank" rel="noopener noreferrer">#37959</a></p>
</li>
<li>
<p>Fixed the transaction rollback issue caused by <code>insert overwrite auto partition</code>. <a href="https://github.com/apache/doris/pull/38103" target="_blank" rel="noopener noreferrer">#38103</a></p>
</li>
<li>
<p>Fixed the issue where the TimeUtils formatter did not use the correct time zone. <a href="https://github.com/apache/doris/pull/37465" target="_blank" rel="noopener noreferrer">#37465</a></p>
</li>
<li>
<p>Fixed the issue where results were incorrect under constant folding scenarios for week/yearweek. <a href="https://github.com/apache/doris/pull/37376" target="_blank" rel="noopener noreferrer">#37376</a></p>
</li>
<li>
<p>Fixed the issue where the <code>convert_tz</code> function returned incorrect results. <a href="https://github.com/apache/doris/pull/37358" target="_blank" rel="noopener noreferrer">#37358</a>, <a href="https://github.com/apache/doris/pull/38764" target="_blank" rel="noopener noreferrer">#38764</a></p>
</li>
<li>
<p>Fixed the coredump issue when using the <code>collect_set</code> function with window functions. <a href="https://github.com/apache/doris/pull/38234" target="_blank" rel="noopener noreferrer">#38234</a></p>
</li>
<li>
<p>Fixed the coredump issue caused by <code>percentile_approx</code> during rolling upgrades. <a href="https://github.com/apache/doris/pull/39321" target="_blank" rel="noopener noreferrer">#39321</a></p>
</li>
<li>
<p>Fixed the coredump issue caused by the <code>mod</code> function when encountering abnormal input. <a href="https://github.com/apache/doris/pull/37999" target="_blank" rel="noopener noreferrer">#37999</a></p>
</li>
<li>
<p>Fixed the issue where the hash table was not fully built when the broadcast join probe started running. <a href="https://github.com/apache/doris/pull/37643" target="_blank" rel="noopener noreferrer">#37643</a></p>
</li>
<li>
<p>Fixed the issue where executing the same expression in multithreaded environments might lead to incorrect results for Java UDFs. <a href="https://github.com/apache/doris/pull/38612" target="_blank" rel="noopener noreferrer">#38612</a></p>
</li>
<li>
<p>Fixed the overflow issue caused by incorrect return types of the <code>conv</code> function. <a href="https://github.com/apache/doris/pull/38001" target="_blank" rel="noopener noreferrer">#38001</a></p>
</li>
<li>
<p>Fixed the issue where the <code>json_replace</code> function returned incorrect types. <a href="https://github.com/apache/doris/pull/37014" target="_blank" rel="noopener noreferrer">#3701</a></p>
</li>
<li>
<p>Fixed the issue where the nullable attribute setting was unreasonable for the <code>percentile</code> aggregation function. <a href="https://github.com/apache/doris/pull/37330" target="_blank" rel="noopener noreferrer">#37330</a></p>
</li>
<li>
<p>Fixed the issue where the results of the <code>histogram</code> function were unstable. <a href="https://github.com/apache/doris/pull/38608" target="_blank" rel="noopener noreferrer">#38608</a></p>
</li>
<li>
<p>Fixed the issue where task state was displayed incorrectly in the profile. <a href="https://github.com/apache/doris/pull/38082" target="_blank" rel="noopener noreferrer">#38082</a></p>
</li>
<li>
<p>Fixed the issue where some queries were incorrectly canceled when the system just started. <a href="https://github.com/apache/doris/pull/37662" target="_blank" rel="noopener noreferrer">#37662</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semi-structured-data-management-2">Semi-Structured Data Management<a href="https://doris.apache.org/blog/release-note-3.0.1#semi-structured-data-management-2" class="hash-link" aria-label="Direct link to Semi-Structured Data Management" title="Direct link to Semi-Structured Data Management">&#x200B;</a></h3>
<ul>
<li>
<p>Fix some issues with time series compression. <a href="https://github.com/apache/doris/pull/39170" target="_blank" rel="noopener noreferrer">#39170</a> <a href="https://github.com/apache/doris/pull/39176" target="_blank" rel="noopener noreferrer">#39176</a></p>
</li>
<li>
<p>Fix the issue of incorrect index size statistics during compression. <a href="https://github.com/apache/doris/pull/37232" target="_blank" rel="noopener noreferrer">#37232</a></p>
</li>
<li>
<p>Fix the potential incorrect matching of ultra-long strings without tokenization in inverted indexes. <a href="https://github.com/apache/doris/pull/37679" target="_blank" rel="noopener noreferrer">#37679</a> <a href="https://github.com/apache/doris/pull/38218" target="_blank" rel="noopener noreferrer">#38218</a></p>
</li>
<li>
<p>Fix the high memory usage issue of <code>array_range</code> and <code>array_with_const</code> functions when dealing with large data volumes. <a href="https://github.com/apache/doris/pull/38284" target="_blank" rel="noopener noreferrer">#38284</a> <a href="https://github.com/apache/doris/pull/37495" target="_blank" rel="noopener noreferrer">#37495</a></p>
</li>
<li>
<p>Fix the potential coredump issue when selecting columns of ARRAY / MAP / STRUCT types. <a href="https://github.com/apache/doris/pull/37936" target="_blank" rel="noopener noreferrer">#37936</a></p>
</li>
<li>
<p>Fix the import failure issue caused by simdjson parsing errors when specifying jsonpath in Stream Load. <a href="https://github.com/apache/doris/pull/38490" target="_blank" rel="noopener noreferrer">#38490</a></p>
</li>
<li>
<p>Fix the exception handling issue when there are duplicate keys in JSON data. <a href="https://github.com/apache/doris/pull/38146" target="_blank" rel="noopener noreferrer">#38146</a></p>
</li>
<li>
<p>Fix the potential query error after DROP INDEX. <a href="https://github.com/apache/doris/pull/37646" target="_blank" rel="noopener noreferrer">#37646</a></p>
</li>
<li>
<p>Fix the error return issue in row merging checks during index compression. <a href="https://github.com/apache/doris/pull/38732" target="_blank" rel="noopener noreferrer">#38732</a></p>
</li>
<li>
<p>Inverted index v2 format now supports renaming columns. <a href="https://github.com/apache/doris/pull/38079" target="_blank" rel="noopener noreferrer">#38079</a></p>
</li>
<li>
<p>Fix the coredump issue when the <code>MATCH</code> function matches an empty string without an index. <a href="https://github.com/apache/doris/pull/37947" target="_blank" rel="noopener noreferrer">#37947</a></p>
</li>
<li>
<p>Fix the handling of NULL values in inverted indexes. <a href="https://github.com/apache/doris/pull/37921" target="_blank" rel="noopener noreferrer">#37921</a> <a href="https://github.com/apache/doris/pull/37842" target="_blank" rel="noopener noreferrer">#37842</a> <a href="https://github.com/apache/doris/pull/38741" target="_blank" rel="noopener noreferrer">#38741</a></p>
</li>
<li>
<p>Fix the incorrect <code>row_store_page_size</code> after FE restart. <a href="https://github.com/apache/doris/pull/38240" target="_blank" rel="noopener noreferrer">#38240</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-2">Other<a href="https://doris.apache.org/blog/release-note-3.0.1#other-2" class="hash-link" aria-label="Direct link to Other" title="Direct link to Other">&#x200B;</a></h3>
<ul>
<li>
<p>Fix the timezone configuration issue. The default timezone is no longer fixed at UTC+8 and is now obtained from system configuration. <a href="https://github.com/apache/doris/pull/37294" target="_blank" rel="noopener noreferrer">#37294</a></p>
</li>
<li>
<p>Fix the class conflict issue when using ranger due to multiple JSR specification implementations. <a href="https://github.com/apache/doris/pull/37575" target="_blank" rel="noopener noreferrer">#37575</a></p>
</li>
<li>
<p>Fix the potential uninitialized field issue in some BE code. <a href="https://github.com/apache/doris/pull/37403" target="_blank" rel="noopener noreferrer">#37403</a></p>
</li>
<li>
<p>Fix the error in delete statements for random distributed tables. <a href="https://github.com/apache/doris/pull/37985" target="_blank" rel="noopener noreferrer">#37985</a></p>
</li>
<li>
<p>Fix the incorrect requirement for <code>alter_priv</code> permission on the base table when creating a synchronized materialized view. <a href="https://github.com/apache/doris/pull/38011" target="_blank" rel="noopener noreferrer">#38011</a></p>
</li>
<li>
<p>Fix the issue of not authenticating resources when used in TVF. <a href="https://github.com/apache/doris/pull/36928" target="_blank" rel="noopener noreferrer">#36928</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="credits">Credits<a href="https://doris.apache.org/blog/release-note-3.0.1#credits" class="hash-link" aria-label="Direct link to Credits" title="Direct link to Credits">&#x200B;</a></h2>
<p>Thanks all who contribute to this release:</p>
<p>@133tosakarin, @924060929, @AshinGau, @Baymine, @BePPPower, @BiteTheDDDDt, @ByteYue, @CalvinKirs, @Ceng23333, @DarvenDuan, @FreeOnePlus, @Gabriel39, @HappenLee, @JNSimba, @Jibing-Li, @KassieZ, @Lchangliang, @LiBinfeng-01, @Mryange, @SWJTU-ZhangLei, @TangSiyang2001, @Tech-Circle-48, @Vallishp, @Yukang-Lian, @Yulei-Yang, @airborne12, @amorynan, @bobhan1, @cambyzju, @cjj2010, @csun5285, @dataroaring, @deardeng, @eldenmoon, @englefly, @feiniaofeiafei, @felixwluo, @freemandealer, @gavinchou, @ghkang98, @hello-stephen, @hubgeter, @hust-hhb, @jacktengg, @kaijchen, @kaka11chen, @keanji-x, @liaoxin01, @liutang123, @luwei16, @luzhijing, @lxr599, @morningman, @morrySnow, @mrhhsg, @mymeiyi, @platoneko, @qidaye, @qzsee, @seawinde, @shuke987, @sollhui, @starocean999, @suxiaogang223, @w41ter, @wangbo, @wangshuo128, @whutpencil, @wsjz, @wuwenchi, @wyxxxcat, @xiaokang, @xiedeyantu, @xinyiZzz, @xy720, @xzj7019, @yagagagaga, @yiguolei, @yujun777, @z404289981, @zclllyybb, @zddr, @zfr9527, @zhangbutao, @zhangstar333, @zhannngchen, @zhiqiang-hhhh, @zjj, @zy-kkk, @zzzxl1993</p></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Release Notes" term="Release Notes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Automatic and flexible data sharding: Auto Partition in Apache Doris]]></title>
        <id>https://doris.apache.org/blog/auto-partition-in-apache-doris</id>
        <link href="https://doris.apache.org/blog/auto-partition-in-apache-doris"/>
        <updated>2024-08-14T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Apache Doris 2.1.0 introduces Auto Partition. It supports partitioning data by RANGE or by LIST and further enhances flexibility on top of automatic partitioning.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Tech Sharing</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Automatic and flexible data sharding: Auto Partition in Apache Doris</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-08-14T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">August 14, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>To handle large datasets, distributed databases introduce strategies like partitioning and bucketing. Data is divided into smaller units based on specific rules and distributed across different nodes, so databases can perform parallel processing for higher performance and data management flexibility.</p>
<p>Like in many databases, <a href="https://doris.apache.org/" target="_blank" rel="noopener noreferrer">Apache Doris</a> shards data into partitions, and then a partition is further divided into buckets. <strong>Partitions</strong> are typically defined by time or other continuous values. This allows query engines to quickly locate the target data during queries by pruning irrelevant data ranges.</p>
<p><strong>Bucketing</strong>, on the other hand, distributes data based on the hash values of one or more columns, which prevents data skew.</p>
<p>Prior to version <a href="https://doris.apache.org/blog/release-note-2.1.0" target="_blank" rel="noopener noreferrer">2.1.0</a>, there are two way you can create data partitions in Apache Doris:</p>
<ul>
<li>
<p><strong><a href="https://doris.apache.org/docs/table-design/data-partitioning/manual-partitioning" target="_blank" rel="noopener noreferrer">Manual Partition</a></strong>: Users specify the partitions in the table creation statement, or modify them through DDL statements afterwards.</p>
</li>
<li>
<p><strong><a href="https://doris.apache.org/docs/table-design/data-partitioning/dynamic-partitioning" target="_blank" rel="noopener noreferrer">Dynamic Partition</a></strong>: The system automatically maintains partitions within a pre-defined range based on the data ingestion time.</p>
</li>
</ul>
<p>In Apache Doris 2.1.0, we have introduced <strong><a href="https://doris.apache.org/docs/table-design/data-partitioning/auto-partitioning" target="_blank" rel="noopener noreferrer">Auto Partition</a></strong>. It supports partitioning data by RANGE or by LIST and further enhances flexibility on top of automatic partitioning.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="evolution-of-partitioning-strategies-in-doris">Evolution of partitioning strategies in Doris<a href="https://doris.apache.org/blog/auto-partition-in-apache-doris#evolution-of-partitioning-strategies-in-doris" class="hash-link" aria-label="Direct link to Evolution of partitioning strategies in Doris" title="Direct link to Evolution of partitioning strategies in Doris">&#x200B;</a></h2>
<p>In the design of data distribution, we focus more on partition planning, because the choice of partition columns and partition intervals heavily depends on the actual data distribution patterns, and a good partition design can largely improve the query and storage efficiency of the table.</p>
<p>In Doris, the data table is divided into partitions and then buckets in a hierarchical manner. The data within the same bucket then forms a data <strong>tablet</strong>, which is the minimum physical storage unit in Doris for data replication, inter-cluster data scheduling, and load balancing.</p>
<p><img decoding="async" loading="lazy" alt="Evolution of partitioning strategies in Doris" src="https://cdnd.selectdb.com/assets/images/evolution-of-partitioning-strategies-in-Doris-28ecf81690866d81a59ef418c611a5d4.png" width="1280" height="614" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="manual-partition">Manual Partition<a href="https://doris.apache.org/blog/auto-partition-in-apache-doris#manual-partition" class="hash-link" aria-label="Direct link to Manual Partition" title="Direct link to Manual Partition">&#x200B;</a></h3>
<p>Doris allows users to manually create data partitions by RANGE and by LIST.</p>
<p>For time-stamped data like logs and transaction records, users typically create partitions based on the time dimension. Here&apos;s an example of the CREATE TABLE statement:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">IF</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">EXISTS</span><span class="token plain"> example_range_tbl</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">user_id</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> LARGEINT </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;User ID&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">date</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DATE</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Data import date&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">timestamp</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DATETIME</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Data import timestamp&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">city</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VARCHAR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">20</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Location of user&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">age</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">SMALLINT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Age of user&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">sex</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TINYINT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Sex of user&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">last_visit_date</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DATETIME</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">REPLACE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1970-01-01 00:00:00&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Last visit date of user&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">cost</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BIGINT</span><span class="token plain"> SUM </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;User consumption&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">max_dwell_time</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">INT</span><span class="token plain"> MAX </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Maximum dwell time of user&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">min_dwell_time</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">INT</span><span class="token plain"> MIN </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DEFAULT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;99999&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Minimum dwell time of user&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">ENGINE</span><span class="token operator">=</span><span class="token plain">OLAP</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AGGREGATE </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">KEY</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">user_id</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">date</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">timestamp</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">city</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">age</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">sex</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> RANGE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">date</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">p201701</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> LESS THAN </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2017-02-01&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">p201702</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> LESS THAN </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2017-03-01&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">p201703</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> LESS THAN </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2017-04-01&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">p2018</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2018-01-01&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2019-01-01&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">HASH</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">user_id</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> BUCKETS </span><span class="token number">16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PROPERTIES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;replication_num&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
<p>The table is partitioned by the data import date <code>date</code>, and 4 partitions have been pre-created. Within each partition, the data is further divided into 16 buckets based on the hash value of the <code>user_id</code>.</p>
<p>With this partitioning and bucketing design, when querying data from 2018 onwards, the system only need to scan the <code>p2018</code> partition. This is what the query SQL looks like:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">desc</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">select</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">count</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> example_range_tbl </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">where</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">date</span><span class="token plain"> </span><span class="token operator">&gt;=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;20180101&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">--------------------------------------------------------------------------------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">Explain</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Nereids Planner</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                                                      </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">--------------------------------------------------------------------------------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PLAN</span><span class="token plain"> FRAGMENT </span><span class="token number">0</span><span class="token plain">                                                                      </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">   OUTPUT EXPRS:                                                                      </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">     </span><span class="token function" style="color:rgb(80, 250, 123)">count</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token comment" style="color:rgb(98, 114, 164)">#11]                                                                    |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">   </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain">: UNPARTITIONED                                                           </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">                                                                                      </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">                                                                            </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">                                                                                      </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">   </span><span class="token number">0</span><span class="token plain">:VOlapScanNode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">193</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                                                               </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLE</span><span class="token plain">: test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">example_range_tbl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">example_range_tbl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> PREAGGREGATION: </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">OFF</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">          </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">      PREDICATES: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">date</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token comment" style="color:rgb(98, 114, 164)">#1] &gt;= &apos;2018-01-01&apos;)                                          |</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">      partitions</span><span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">4</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">p2018</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> tablets</span><span class="token operator">=</span><span class="token number">16</span><span class="token operator">/</span><span class="token number">16</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> tabletList</span><span class="token operator">=</span><span class="token number">561490</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">561492</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">561494</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">      cardinality</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> avgRowSize</span><span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> numNodes</span><span class="token operator">=</span><span class="token number">1</span><span class="token plain">                                       </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">      pushAggOp</span><span class="token operator">=</span><span class="token plain">NONE                                                                  </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain">                                                                                      </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">--------------------------------------------------------------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
<p>If the data is distributed unevenly across partitions, the hash-based bucketing mechanism can further divide the data based on the <code>user_id</code>. This helps to avoid load imbalance on some machines during querying and storage.</p>
<p>However, in real-world business scenarios, one cluster may have tens of thousands of tables, which means it is impossible to manage them manually.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">DAILY_TRADE_VALUE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain">              datev2 </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;Trade date&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_ID</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain">                </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;Trade ID&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">UNIQUE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">KEY</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_ID</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> RANGE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> p_200001 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-01-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-02-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> p_200002 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-02-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-03-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> p_200003 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-03-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-04-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> p_200004 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-04-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-05-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> p_200005 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-05-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-06-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> p_200006 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-06-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-07-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> p_200007 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-07-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-08-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> p_200008 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-08-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-09-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> p_200009 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-09-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-10-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> p_200010 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-10-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-11-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> p_200011 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-11-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-12-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> p_200012 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2000-12-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2001-01-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> p_200101 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2001-01-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2001-02-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">HASH</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> BUCKETS </span><span class="token number">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PROPERTIES </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
<p>In the above example, data is partitioned on a monthly basis. This requires the database administrator (DBA) to manually add a new partition each month and maintain table schema regularly. Imagine the case of real-time data processing, where you might need to create partitions daily or even hourly, manually doing this is no long a choice. That&apos;s why we introduced Dynamic Partition.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dynamic-partition">Dynamic Partition<a href="https://doris.apache.org/blog/auto-partition-in-apache-doris#dynamic-partition" class="hash-link" aria-label="Direct link to Dynamic Partition" title="Direct link to Dynamic Partition">&#x200B;</a></h3>
<p>By Dynamic Partition, Doris automatically creates and reclaims data partitions as long as the user specifies the partition unit, the number of historical partitions, and the number of future partitions. This functionality relies on a fixed thread on the Doris Frontend. It continuously polls and checks for new partitions to be created or old partitions to be reclaimed, and updates the partition schema of the table.</p>
<p>This is an example CREATE TABLE statement for a table which is partitioned by day. The <code>start</code> and <code>end</code> parameters are set to <code>-7</code> and <code>3</code>, respectively, meaning that data partitions for the next 3 days will be pre-created and the historical partitions that are older than 7 days will be reclaimed.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">DAILY_TRADE_VALUE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain">              datev2 </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;Trade date&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_ID</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain">                </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;Trade ID&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">UNIQUE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">KEY</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_ID</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> RANGE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">HASH</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> BUCKETS </span><span class="token number">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PROPERTIES </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;dynamic_partition.enable&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;true&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;dynamic_partition.time_unit&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;DAY&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;dynamic_partition.start&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;-7&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;dynamic_partition.end&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;3&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;dynamic_partition.prefix&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;p&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;dynamic_partition.buckets&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;10&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
<p>Over time, the table will always maintain partitions within the range of <code>[current date - 7, current date + 3]</code>. Dynamic Partition is particularly useful for real-time data ingestion scenarios, such as when the ODS (Operational Data Store) layer directly receives data from external sources like Kafka.</p>
<p>The <code>start</code> and <code>end</code> parameters define a fixed range for the partitions, allowing the user to manage the partitions only within this range. However, if the user needs to include more historical data, they would have to dial up the <code>start</code> value, and that could lead to unnecessary metadata overhead in the cluster.</p>
<p>Therefore, when applying Dynamic Partition, there is a trade-off between the convenience and efficiency of metadata management.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="developers-words">Developers&apos; words<a href="https://doris.apache.org/blog/auto-partition-in-apache-doris#developers-words" class="hash-link" aria-label="Direct link to Developers&apos; words" title="Direct link to Developers&apos; words">&#x200B;</a></h2>
<p>As the complexity of business adds up, Dynamic Partition becomes inadequate because:</p>
<ul>
<li>
<p>It only supports partitioning by RANGE but not by LIST.</p>
</li>
<li>
<p>It can only be applied to the current real-world timestamps.</p>
</li>
<li>
<p>It only supports a single continuous partition range, and cannot accommodate partitions outside of that range.</p>
</li>
</ul>
<p>Given these functional limitations, we started to plan a new partitioning mechanism that can both automate partition management and simplify data table maintenance.</p>
<p>We figured out that the ideal partitioning implementation should:</p>
<ul>
<li>
<p>Save the need for manually creating partitions after table creation;</p>
</li>
<li>
<p>Be able to accommodate all ingested data in corresponding partitions.</p>
</li>
</ul>
<p><strong>The former stands for automation and the latter for flexibility. The essence of realizing them both is associating partition creation with the actual data.</strong></p>
<p>Then we started to think about: What if we hold off the creation of partitions until the data is ingested, rather than doing it during table creation or through regular polling. Instead of pre-constructing the partition distribution, we can define the &quot;data-to-partition&quot; mapping rules, so the partitions are created after data arrives.</p>
<p>Compared to Manual Partition, this whole process would be fully automated, eliminating the need for human maintenance. Compared to Dynamic Partition, it avoids having partitions that are not used, or partitions that are needed but not present.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="auto-partition">Auto Partition<a href="https://doris.apache.org/blog/auto-partition-in-apache-doris#auto-partition" class="hash-link" aria-label="Direct link to Auto Partition" title="Direct link to Auto Partition">&#x200B;</a></h2>
<p>With <a href="https://doris.apache.org/blog/release-note-2.1.0" target="_blank" rel="noopener noreferrer">Apache Doris 2.1.0</a>, we bring the above plan into fruition. During data ingestion, Doris creates data partitions based on the configured rules. The Doris Backend nodes that are responsible for data processing and distribution will attempt to find the appropriate partition for each row of data in the DataSink operator of the execution plan. It no longer filters out data that does not fit into any existing partition or reports an error for such a situation, but automatically generates partitions for all ingested data.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="auto-partition-by-range">Auto Partition by RANGE<a href="https://doris.apache.org/blog/auto-partition-in-apache-doris#auto-partition-by-range" class="hash-link" aria-label="Direct link to Auto Partition by RANGE" title="Direct link to Auto Partition by RANGE">&#x200B;</a></h3>
<p>Auto Partition by RANGE provides an optimized partitioning solution based on the time dimension. It is more flexible than Dynamic Partition in terms of parameter configuration. The syntax for it is as follows:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">AUTO </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> RANGE </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">FUNC_CALL_EXPR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">FUNC_CALL_EXPR ::</span><span class="token operator">=</span><span class="token plain"> DATE_TRUNC </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">partition_column</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;&lt;interval&gt;&apos;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
<p>The <code>&lt;partition_column&gt;</code> above is the partition column (i.e., the column that the partitioning is based on). <code>&lt;interval&gt;</code>specifies the partition unit, which is the desired width of each partition.</p>
<p>For example, if the partition column is <code>k0</code> and you want to partition by month, the partition statement would be <code>AUTO PARTITION BY RANGE (DATE_TRUNC(k0, &apos;month&apos;))</code>. For all the imported data, the system will call <code>DATE_TRUNC(k0, &apos;month&apos;)</code> to calculate the left endpoint of the partition, and then the right endpoint by adding one <code>interval</code>.</p>
<p>Now, we can apply Auto Partition to the <code>DAILY_TRADE_VALUE</code> table introduced in the previous section on Dynamic Partition.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLE</span><span class="token plain"> DAILY_TRADE_VALUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain">    DATEV2 </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;Trade Date&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_ID</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VARCHAR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;Trade ID&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">AUTO </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> RANGE </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">DATE_TRUNC</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;month&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">HASH</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> BUCKETS </span><span class="token number">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PROPERTIES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
<p>After importing some data, these are the partitions we get:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">show</span><span class="token plain"> partitions </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> DAILY_TRADE_VALUE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Empty </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">set</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.10</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">insert</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">into</span><span class="token plain"> DAILY_TRADE_VALUE </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">values</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2015-01-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2020-01-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2024-03-05&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">10000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2024-03-06&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">10001</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Query OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">rows</span><span class="token plain"> affected </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.24</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;label&apos;</span><span class="token plain">:</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;label_2a7353a3f991400e_ae731988fa2bc568&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;status&apos;</span><span class="token plain">:</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;VISIBLE&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;txnId&apos;</span><span class="token plain">:</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;85097&apos;</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">show</span><span class="token plain"> partitions </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> DAILY_TRADE_VALUE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">-------------+-----------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+--------------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> PartitionId </span><span class="token operator">|</span><span class="token plain"> PartitionName   </span><span class="token operator">|</span><span class="token plain"> VisibleVersion </span><span class="token operator">|</span><span class="token plain"> VisibleVersionTime  </span><span class="token operator">|</span><span class="token plain"> State  </span><span class="token operator">|</span><span class="token plain"> PartitionKey </span><span class="token operator">|</span><span class="token plain"> Range                                                                          </span><span class="token operator">|</span><span class="token plain"> DistributionKey </span><span class="token operator">|</span><span class="token plain"> Buckets </span><span class="token operator">|</span><span class="token plain"> ReplicationNum </span><span class="token operator">|</span><span class="token plain"> StorageMedium </span><span class="token operator">|</span><span class="token plain"> CooldownTime        </span><span class="token operator">|</span><span class="token plain"> RemoteStoragePolicy </span><span class="token operator">|</span><span class="token plain"> LastConsistencyCheckTime </span><span class="token operator">|</span><span class="token plain"> DataSize </span><span class="token operator">|</span><span class="token plain"> IsInMemory </span><span class="token operator">|</span><span class="token plain"> ReplicaAllocation       </span><span class="token operator">|</span><span class="token plain"> IsMutable </span><span class="token operator">|</span><span class="token plain"> SyncWithBaseTables </span><span class="token operator">|</span><span class="token plain"> UnsyncTables </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">-------------+-----------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+--------------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">588395</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> p20150101000000 </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">01</span><span class="token plain"> </span><span class="token number">19</span><span class="token plain">:</span><span class="token number">02</span><span class="token plain">:</span><span class="token number">40</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> NORMAL </span><span class="token operator">|</span><span class="token plain"> TRADE_DATE   </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">DATEV2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2015</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">DATEV2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2015</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">01</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> TRADE_DATE      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> HDD           </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">9999</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">31</span><span class="token plain"> </span><span class="token number">23</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">0.000</span><span class="token plain">    </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain">: </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">               </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">588437</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> p20200101000000 </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">01</span><span class="token plain"> </span><span class="token number">19</span><span class="token plain">:</span><span class="token number">02</span><span class="token plain">:</span><span class="token number">40</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> NORMAL </span><span class="token operator">|</span><span class="token plain"> TRADE_DATE   </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">DATEV2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">DATEV2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2020</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">01</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> TRADE_DATE      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> HDD           </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">9999</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">31</span><span class="token plain"> </span><span class="token number">23</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">0.000</span><span class="token plain">    </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain">: </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">               </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">588416</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> p20240301000000 </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">01</span><span class="token plain"> </span><span class="token number">19</span><span class="token plain">:</span><span class="token number">02</span><span class="token plain">:</span><span class="token number">40</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> NORMAL </span><span class="token operator">|</span><span class="token plain"> TRADE_DATE   </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">DATEV2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">01</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">DATEV2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">01</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> TRADE_DATE      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> HDD           </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">9999</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">31</span><span class="token plain"> </span><span class="token number">23</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">0.000</span><span class="token plain">    </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain">: </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">               </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">-------------+-----------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+--------------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">3</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">rows</span><span class="token plain"> </span><span class="token operator">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">set</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.09</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
<p>As is shown, partitions are automatically created for the imported data, and it doesn&apos;t create partitions that are beyond the range of the existing data.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="auto-partition-by-list">Auto Partition by LIST<a href="https://doris.apache.org/blog/auto-partition-in-apache-doris#auto-partition-by-list" class="hash-link" aria-label="Direct link to Auto Partition by LIST" title="Direct link to Auto Partition by LIST">&#x200B;</a></h3>
<p>Auto Partition by LIST is to shard data based on non-time-based dimensions, such as <code>region</code> and <code>department</code>. It fills that gap for Dynamic Partition, which does not support data partitioning by LIST.</p>
<p>Auto Partition by RANGE provides an optimized partitioning solution based on the time dimension. It is more flexible than Dynamic Partition in terms of parameter configuration. The syntax for it is as follows:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">AUTO </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> LIST </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">partition_col</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
<p>This is an example of Auto Partition by LIST using <code>city</code> as the partition column:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLE</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">str_table</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain">     </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">city</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VARCHAR</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain">     </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DUPLICATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">KEY</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">city</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> AUTO </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> LIST </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">city</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">HASH</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">city</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> BUCKETS </span><span class="token number">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> PROPERTIES </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain">     </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Query OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">rows</span><span class="token plain"> affected </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.09</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">insert</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">into</span><span class="token plain"> str_table </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">values</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Denver&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Boston&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Los_Angeles&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Query OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">rows</span><span class="token plain"> affected </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.25</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">show</span><span class="token plain"> partitions </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> str_table</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">-------------+-----------------+----------------+---------------------+--------+--------------+-------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+--------------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> PartitionId </span><span class="token operator">|</span><span class="token plain"> PartitionName   </span><span class="token operator">|</span><span class="token plain"> VisibleVersion </span><span class="token operator">|</span><span class="token plain"> VisibleVersionTime  </span><span class="token operator">|</span><span class="token plain"> State  </span><span class="token operator">|</span><span class="token plain"> PartitionKey </span><span class="token operator">|</span><span class="token plain"> Range                                     </span><span class="token operator">|</span><span class="token plain"> DistributionKey </span><span class="token operator">|</span><span class="token plain"> Buckets </span><span class="token operator">|</span><span class="token plain"> ReplicationNum </span><span class="token operator">|</span><span class="token plain"> StorageMedium </span><span class="token operator">|</span><span class="token plain"> CooldownTime        </span><span class="token operator">|</span><span class="token plain"> RemoteStoragePolicy </span><span class="token operator">|</span><span class="token plain"> LastConsistencyCheckTime </span><span class="token operator">|</span><span class="token plain"> DataSize </span><span class="token operator">|</span><span class="token plain"> IsInMemory </span><span class="token operator">|</span><span class="token plain"> ReplicaAllocation       </span><span class="token operator">|</span><span class="token plain"> IsMutable </span><span class="token operator">|</span><span class="token plain"> SyncWithBaseTables </span><span class="token operator">|</span><span class="token plain"> UnsyncTables </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">-------------+-----------------+----------------+---------------------+--------+--------------+-------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+--------------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">589685</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> pDenver7        </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">01</span><span class="token plain"> </span><span class="token number">20</span><span class="token plain">:</span><span class="token number">12</span><span class="token plain">:</span><span class="token number">37</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> NORMAL </span><span class="token operator">|</span><span class="token plain"> city         </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VARCHAR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Denver</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> city            </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> HDD           </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">9999</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">31</span><span class="token plain"> </span><span class="token number">23</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">0.000</span><span class="token plain">    </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain">: </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">               </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">589643</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> pLos5fAngeles11 </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">01</span><span class="token plain"> </span><span class="token number">20</span><span class="token plain">:</span><span class="token number">12</span><span class="token plain">:</span><span class="token number">37</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> NORMAL </span><span class="token operator">|</span><span class="token plain"> city         </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VARCHAR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Los_Angeles</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> city            </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> HDD           </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">9999</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">31</span><span class="token plain"> </span><span class="token number">23</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">0.000</span><span class="token plain">    </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain">: </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">               </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">589664</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> pBoston8        </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">01</span><span class="token plain"> </span><span class="token number">20</span><span class="token plain">:</span><span class="token number">12</span><span class="token plain">:</span><span class="token number">37</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> NORMAL </span><span class="token operator">|</span><span class="token plain"> city         </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VARCHAR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Boston</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> city            </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> HDD           </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">9999</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">31</span><span class="token plain"> </span><span class="token number">23</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">0.000</span><span class="token plain">    </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain">: </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">               </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">-------------+-----------------+----------------+---------------------+--------+--------------+-------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+--------------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">3</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">rows</span><span class="token plain"> </span><span class="token operator">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">set</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.10</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
<p>After inserting data for the cities of Denver, Boston, and Los Angeles, the system automatically created corresponding partitions based on the city names. Previously, this type of custom partitioning could only be achieved through manual DDL statements. This is how Auto Partition by LIST simplifies database maintenance.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tips--notes">Tips &amp; notes<a href="https://doris.apache.org/blog/auto-partition-in-apache-doris#tips--notes" class="hash-link" aria-label="Direct link to Tips &amp; notes" title="Direct link to Tips &amp; notes">&#x200B;</a></h3>
<p><strong>Manually adjust historical partitions</strong></p>
<p>For tables that receive both real-time data and occasional historical updates, since Auto Partition does not automatically reclaim historical partitions, we recommend two options:</p>
<ul>
<li>
<p>Use Auto Partition, which will automatically create partitions for the occasional historical data updates.</p>
</li>
<li>
<p>Use Auto Partition and manually create a <code>LESS THAN</code> partition to accommodate the historical updates. This allows for a clearer separation of historical and real-time data, and makes data management easier.</p>
</li>
</ul>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLE</span><span class="token plain"> DAILY_TRADE_VALUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain">     </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain">    DATEV2 </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;Trade Date&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain">     </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_ID</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VARCHAR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">40</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">NOT</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">COMMENT</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;Trade ID&apos;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> AUTO </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> RANGE </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">DATE_TRUNC</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;DAY&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain">     </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">pHistory</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VALUES</span><span class="token plain"> LESS THAN </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;2024-01-01&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">HASH</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">TRADE_DATE</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> BUCKETS </span><span class="token number">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> PROPERTIES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain">     </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;replication_num&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Query OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">rows</span><span class="token plain"> affected </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.11</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">insert</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">into</span><span class="token plain"> DAILY_TRADE_VALUE </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">values</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2015-01-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2020-01-01&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2024-03-05&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">10000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;2024-03-06&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">10001</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Query OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">rows</span><span class="token plain"> affected </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.25</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;label&apos;</span><span class="token plain">:</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;label_96dc3d20c6974f4a_946bc1a674d24733&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;status&apos;</span><span class="token plain">:</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;VISIBLE&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;txnId&apos;</span><span class="token plain">:</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;85092&apos;</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">show</span><span class="token plain"> partitions </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> DAILY_TRADE_VALUE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">-------------+-----------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+--------------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> PartitionId </span><span class="token operator">|</span><span class="token plain"> PartitionName   </span><span class="token operator">|</span><span class="token plain"> VisibleVersion </span><span class="token operator">|</span><span class="token plain"> VisibleVersionTime  </span><span class="token operator">|</span><span class="token plain"> State  </span><span class="token operator">|</span><span class="token plain"> PartitionKey </span><span class="token operator">|</span><span class="token plain"> Range                                                                          </span><span class="token operator">|</span><span class="token plain"> DistributionKey </span><span class="token operator">|</span><span class="token plain"> Buckets </span><span class="token operator">|</span><span class="token plain"> ReplicationNum </span><span class="token operator">|</span><span class="token plain"> StorageMedium </span><span class="token operator">|</span><span class="token plain"> CooldownTime        </span><span class="token operator">|</span><span class="token plain"> RemoteStoragePolicy </span><span class="token operator">|</span><span class="token plain"> LastConsistencyCheckTime </span><span class="token operator">|</span><span class="token plain"> DataSize </span><span class="token operator">|</span><span class="token plain"> IsInMemory </span><span class="token operator">|</span><span class="token plain"> ReplicaAllocation       </span><span class="token operator">|</span><span class="token plain"> IsMutable </span><span class="token operator">|</span><span class="token plain"> SyncWithBaseTables </span><span class="token operator">|</span><span class="token plain"> UnsyncTables </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">-------------+-----------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+--------------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">577871</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> pHistory        </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">01</span><span class="token plain"> </span><span class="token number">08</span><span class="token plain">:</span><span class="token number">53</span><span class="token plain">:</span><span class="token number">49</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> NORMAL </span><span class="token operator">|</span><span class="token plain"> TRADE_DATE   </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">DATEV2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0000</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">DATEV2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">01</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> TRADE_DATE      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> HDD           </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">9999</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">31</span><span class="token plain"> </span><span class="token number">23</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">0.000</span><span class="token plain">    </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain">: </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">               </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">577940</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> p20240305000000 </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">01</span><span class="token plain"> </span><span class="token number">08</span><span class="token plain">:</span><span class="token number">53</span><span class="token plain">:</span><span class="token number">49</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> NORMAL </span><span class="token operator">|</span><span class="token plain"> TRADE_DATE   </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">DATEV2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">05</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">DATEV2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">06</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> TRADE_DATE      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> HDD           </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">9999</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">31</span><span class="token plain"> </span><span class="token number">23</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">0.000</span><span class="token plain">    </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain">: </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">               </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">577919</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> p20240306000000 </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">01</span><span class="token plain"> </span><span class="token number">08</span><span class="token plain">:</span><span class="token number">53</span><span class="token plain">:</span><span class="token number">49</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> NORMAL </span><span class="token operator">|</span><span class="token plain"> TRADE_DATE   </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">DATEV2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">06</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">DATEV2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">07</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> TRADE_DATE      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> HDD           </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">9999</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">31</span><span class="token plain"> </span><span class="token number">23</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">0.000</span><span class="token plain">    </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain">: </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">               </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">-------------+-----------------+----------------+---------------------+--------+--------------+--------------------------------------------------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+--------------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">3</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">rows</span><span class="token plain"> </span><span class="token operator">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">set</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.10</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
<p><strong>NULL partition</strong></p>
<p>With Auto Partition by LIST, Doris supports storing NULL values in NULL partitions. For example:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">TABLE</span><span class="token plain"> list_nullable</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain">     </span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">str</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">varchar</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> AUTO </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">PARTITION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> LIST </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">str</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">DISTRIBUTED</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">BY</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">HASH</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token identifier">str</span><span class="token identifier punctuation" style="color:rgb(248, 248, 242)">`</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> BUCKETS auto</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> PROPERTIES</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain">     </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;replication_num&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;1&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Query OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">rows</span><span class="token plain"> affected </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.10</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">insert</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">into</span><span class="token plain"> list_nullable </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">values</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;123&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Query OK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">rows</span><span class="token plain"> affected </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.24</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;label&apos;</span><span class="token plain">:</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;label_f5489769c2f04f0d_bfb65510f9737fff&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;status&apos;</span><span class="token plain">:</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;VISIBLE&apos;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&apos;txnId&apos;</span><span class="token plain">:</span><span class="token string" style="color:rgb(255, 121, 198)">&apos;85089&apos;</span><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mysql</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">show</span><span class="token plain"> partitions </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> list_nullable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">-------------+---------------+----------------+---------------------+--------+--------------+------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+--------------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> PartitionId </span><span class="token operator">|</span><span class="token plain"> PartitionName </span><span class="token operator">|</span><span class="token plain"> VisibleVersion </span><span class="token operator">|</span><span class="token plain"> VisibleVersionTime  </span><span class="token operator">|</span><span class="token plain"> State  </span><span class="token operator">|</span><span class="token plain"> PartitionKey </span><span class="token operator">|</span><span class="token plain"> Range                              </span><span class="token operator">|</span><span class="token plain"> DistributionKey </span><span class="token operator">|</span><span class="token plain"> Buckets </span><span class="token operator">|</span><span class="token plain"> ReplicationNum </span><span class="token operator">|</span><span class="token plain"> StorageMedium </span><span class="token operator">|</span><span class="token plain"> CooldownTime        </span><span class="token operator">|</span><span class="token plain"> RemoteStoragePolicy </span><span class="token operator">|</span><span class="token plain"> LastConsistencyCheckTime </span><span class="token operator">|</span><span class="token plain"> DataSize </span><span class="token operator">|</span><span class="token plain"> IsInMemory </span><span class="token operator">|</span><span class="token plain"> ReplicaAllocation       </span><span class="token operator">|</span><span class="token plain"> IsMutable </span><span class="token operator">|</span><span class="token plain"> SyncWithBaseTables </span><span class="token operator">|</span><span class="token plain"> UnsyncTables </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">-------------+---------------+----------------+---------------------+--------+--------------+------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+--------------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">577297</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> pX            </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">01</span><span class="token plain"> </span><span class="token number">08</span><span class="token plain">:</span><span class="token number">19</span><span class="token plain">:</span><span class="token number">21</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> NORMAL </span><span class="token operator">|</span><span class="token plain"> str          </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VARCHAR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token boolean">NULL</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> str             </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> HDD           </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">9999</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">31</span><span class="token plain"> </span><span class="token number">23</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">0.000</span><span class="token plain">    </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain">: </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">               </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">577276</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> p0            </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">01</span><span class="token plain"> </span><span class="token number">08</span><span class="token plain">:</span><span class="token number">19</span><span class="token plain">:</span><span class="token number">21</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> NORMAL </span><span class="token operator">|</span><span class="token plain"> str          </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VARCHAR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">     </span><span class="token operator">|</span><span class="token plain"> str             </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> HDD           </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">9999</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">31</span><span class="token plain"> </span><span class="token number">23</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">0.000</span><span class="token plain">    </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain">: </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">               </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">577255</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> p1233         </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">01</span><span class="token plain"> </span><span class="token number">08</span><span class="token plain">:</span><span class="token number">19</span><span class="token plain">:</span><span class="token number">21</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> NORMAL </span><span class="token operator">|</span><span class="token plain"> str          </span><span class="token operator">|</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">types</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">VARCHAR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">keys</span><span class="token plain">: </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">123</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">  </span><span class="token operator">|</span><span class="token plain"> str             </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain">              </span><span class="token operator">|</span><span class="token plain"> HDD           </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">9999</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">31</span><span class="token plain"> </span><span class="token number">23</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain">:</span><span class="token number">59</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">                     </span><span class="token operator">|</span><span class="token plain"> </span><span class="token number">0.000</span><span class="token plain">    </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">location</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">default</span><span class="token plain">: </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">      </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">               </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">NULL</span><span class="token plain">         </span><span class="token operator">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token operator">+</span><span class="token comment" style="color:rgb(98, 114, 164)">-------------+---------------+----------------+---------------------+--------+--------------+------------------------------------+-----------------+---------+----------------+---------------+---------------------+---------------------+--------------------------+----------+------------+-------------------------+-----------+--------------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">3</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">rows</span><span class="token plain"> </span><span class="token operator">in</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">set</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">0.11</span><span class="token plain"> sec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
<p>However, Auto Partition by RANGE does not support NULL partitions, because the NULL values will be stored in the smallest <code>LESS THAN</code> partition, and it is impossible to reliably determine the appropriate range for it. If Auto Partition were to create a NULL partition with a range of (-INFINITY, MIN_VALUE), there would be a risk of this partition being inadvertently deleted in production, as the MIN_VALUE boundary may not accurately represent the intended business logic.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="summary">Summary<a href="https://doris.apache.org/blog/auto-partition-in-apache-doris#summary" class="hash-link" aria-label="Direct link to Summary" title="Direct link to Summary">&#x200B;</a></h3>
<p>Auto Partition covers most of the use cases of Dynamic Partition, while introducing the benefit of upfront partition rule definition. Once the rules are defined, the bulk of partition creation work is automatically handled by Doris instead of a DBA.</p>
<p>Before utilizing Auto Partition, it&apos;s important to understand the relevant limitations:</p>
<ol>
<li>
<p>Auto Partition by LIST supports partitioning based on <strong>multiple columns</strong>, but each automatically created partition only contains one single value, and the partition name cannot exceed 50 characters in length. Note that the partition names follow specific naming conventions, which have particular implications for metadata management. That means not all of the 50-character space is at the user&apos;s disposal.</p>
</li>
<li>
<p>Auto Partition by RANGE only supports a <strong>single partition column</strong>, which must be of type <strong>DATE</strong> or <strong>DATETIME</strong>.</p>
</li>
<li>
<p>Auto Partition by LIST supports <strong>NULLABLE</strong> partition column and inserting NULL values. Auto Partition by RANGE does not support NULLABLE partition column.</p>
</li>
<li>
<p>It is not recommended to use Auto Partition in conjunction with Dynamic Partition after Apache Doris 2.1.3.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="performance-comparison">Performance comparison<a href="https://doris.apache.org/blog/auto-partition-in-apache-doris#performance-comparison" class="hash-link" aria-label="Direct link to Performance comparison" title="Direct link to Performance comparison">&#x200B;</a></h2>
<p>The main functional differences between Auto Partition and Dynamic Partition lie in partition creation and deletion, supported partition types, and their impact on import performance.</p>
<p>Dynamic Partition uses fixed threads to periodically create and reclaim partitions. It only supports partitioning by RANGE. In contrast, Auto Partition supports both partitioning by RANGE and by LIST. It automatically creates partitions on-demand based on specific rules during data ingestion, providing a higher level of automation and flexibility.</p>
<p>Dynamic Partition does not slow down data ingestion speed, while Auto Partition causes certain time overheads because it firstly checks for existing partitions and then creates new ones on demand. We will present the performance test results.</p>
<p><img decoding="async" loading="lazy" alt="Performance comparison" src="https://cdnd.selectdb.com/assets/images/performance-comparison-8d7f8ccd4c4267e74e3af342ada5d6fe.png" width="1280" height="585" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="auto-partition-ingestion-workflow">Auto Partition: ingestion workflow<a href="https://doris.apache.org/blog/auto-partition-in-apache-doris#auto-partition-ingestion-workflow" class="hash-link" aria-label="Direct link to Auto Partition: ingestion workflow" title="Direct link to Auto Partition: ingestion workflow">&#x200B;</a></h2>
<p>This part is about how data ingestion is implemented with the Auto Partition mechanism, and we use <a href="https://doris.apache.org/docs/data-operate/import/stream-load-manual" target="_blank" rel="noopener noreferrer">Stream Load</a> as an example. When Doris initiates a data import, one of the Doris Backend nodes takes on the role of the Coordinator. It is responsible for the initial data processing work and then dispatching the data to the appropriate BE nodes, known as the Executors, for execution.</p>
<p><img decoding="async" loading="lazy" alt="Auto Partition: ingestion workflow" src="https://cdnd.selectdb.com/assets/images/auto-partition-ingestion-workflow-3343361208ec317008cf169ac91398be.png" width="1280" height="731" class="img_ev3q"></p>
<p>In the final Datasink Node of the Coordinator&apos;s execution pipeline, the data needs to be routed to the correct partitions, buckets, and Doris Backend node locations before it can be successfully transmitted and stored.</p>
<p>To enable this data transfer, the Coordinator and Executor nodes establish a communication channels:</p>
<ul>
<li>
<p>The sending end is called the Node Channel.</p>
</li>
<li>
<p>The receiving end is called the Tablets Channel.</p>
</li>
</ul>
<p>This is how Auto Partition comes into play during the process of determining the correct partitions for the data:</p>
<p><img decoding="async" loading="lazy" alt="Auto Partition: ingestion workflow" src="https://cdnd.selectdb.com/assets/images/auto-partition-ingestion-workflow-2-7e25e7fd75a37f9da1de58c0f2c46f11.png" width="1280" height="348" class="img_ev3q"></p>
<p>Previously, without Auto Partition, when a table does not have the required partition, the behavior in Doris is for the BE nodes to accumulate errors until a <code>DATA_QUALITY_ERROR</code> is reported. Now, with Auto Partition enabled, a request will be initiated to the Doris Frontend to create the necessary partition on-the-fly. After the partition creation transaction is completed, the Doris Frontend responds to the Coordinator, which then opens the corresponding communication channels (Node Channel and Tablets Channel) to continue the data ingestion process. This is a seamless experience for users.</p>
<p>In a real-world cluster environment, the time spent by the Coordinator waiting for the Doris Frontend to complete partition creation can incur large overheads. This is due to the inherent latency of Thrift RPC calls, as well as lock contention on the Frontend under high load conditions.</p>
<p>To improve the data ingestion efficiency in Auto Partition, Doris has implemented batching to largely reduce the number of RPC calls made to the FE. This brings a notable performance enhancement for data write operations.</p>
<p>Note that when the FE Master completes the partition creation transaction, the new partition becomes immediately visible. However, if the import process ultimately fails or is canceled, the created partitions are not automatically reclaimed.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="auto-partition-performance">Auto Partition performance<a href="https://doris.apache.org/blog/auto-partition-in-apache-doris#auto-partition-performance" class="hash-link" aria-label="Direct link to Auto Partition performance" title="Direct link to Auto Partition performance">&#x200B;</a></h2>
<p>We tested the performance and stability of Auto Partition in Doris, covering different use cases:</p>
<p><strong>Case 1</strong>: 1 Frontend + 3 Backend; 6 randomly generated datasets, each having 100 million rows and 2,000 partitions; ingested the 6 datasets concurrently into 6 tables</p>
<ul>
<li>
<p><strong>Objective</strong>: Evaluate the performance of Auto Partition under high pressure and check for any performance degradation.</p>
</li>
<li>
<p><strong>Results</strong>: Auto Partition brings an <strong>average performance loss less than 5%</strong>, with all import transactions running stably.</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Auto Partition performance" src="https://cdnd.selectdb.com/assets/images/auto-partition-performance-4739a5a3e97dfe4b88cf2d94b0542c14.png" width="1280" height="581" class="img_ev3q"></p>
<p><strong>Case 2</strong>: 1 Frontend + 3 Backend; ingesting 100 rows per second from Flink by Routine Load; testing with 1, 10, and 20 concurrent transactions (tables), respectively</p>
<ul>
<li>
<p><strong>Objective</strong>: Identify any potential  or data backlog issues that could arise with Auto Partition under different concurrency levels.</p>
</li>
<li>
<p><strong>Results</strong>: With or without Auto Partition enabled, the data ingestion was successful without any backpressure issues across all the concurrency levels tested, even at 20 concurrent transactions when the CPU utilization reached close to 100%.</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Auto Partition performance" src="https://cdnd.selectdb.com/assets/images/auto-partition-performance-2-8a3981c9825d5ca4e6b4e3f5aec38708.png" width="1280" height="557" class="img_ev3q"></p>
<p>To conclude the results of these tests, the impact of enabling Auto Partition on data ingestion performance is minimal.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion-and-future-plans">Conclusion and future plans<a href="https://doris.apache.org/blog/auto-partition-in-apache-doris#conclusion-and-future-plans" class="hash-link" aria-label="Direct link to Conclusion and future plans" title="Direct link to Conclusion and future plans">&#x200B;</a></h2>
<p>Auto Partition has simplified DDL and partition management since Apache Doris 2.1.0. It is useful in large-scale data processing and makes it easy for users to migrate from other database systems to Apache Doris.</p>
<p>Moreover, we are committed to expanding the capabilities of Auto Partition to support more complex data types.</p>
<p>Plans for Auto Partition by RANGE:</p>
<ul>
<li>
<p>Support numeric values;</p>
</li>
<li>
<p>Allowing users to specify the left and right boundaries of the partition range.</p>
</li>
</ul>
<p>Plans for Auto Partition by LIST:</p>
<ul>
<li>Allow merging multiple values into the same partition based on specific rules.</li>
</ul>
<p>Join <a href="https://join.slack.com/t/apachedoriscommunity/shared_invite/zt-2gmq5o30h-455W226d79zP3L96ZhXIoQ" target="_blank" rel="noopener noreferrer">Apache Doris open-source community</a> for more information and further guidance.</p></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Tech Sharing" term="Tech Sharing"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Apache Doris version 2.0.14 has been released]]></title>
        <id>https://doris.apache.org/blog/release-note-2.0.14</id>
        <link href="https://doris.apache.org/blog/release-note-2.0.14"/>
        <updated>2024-08-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Thanks to our community users and developers, about 110 improvements and bug fixes have been made in Doris 2.0.14 version]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Release Notes</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Apache Doris version 2.0.14 has been released</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-08-07T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">August 7, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Thanks to our community users and developers, about 110 improvements and bug fixes have been made in Doris 2.0.14 version</p>
<p><a href="https://doris.apache.org/download/" target="_blank" rel="noopener noreferrer">Quick Download</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-new-features">1 New features<a href="https://doris.apache.org/blog/release-note-2.0.14#1-new-features" class="hash-link" aria-label="Direct link to 1 New features" title="Direct link to 1 New features">&#x200B;</a></h2>
<ul>
<li>Adds a REST interface to retrieve the most recent query profile: <code>curl http://user:password@127.0.0.1:8030/api/profile/text</code> <a href="https://github.com/apache/doris/pull/38268" target="_blank" rel="noopener noreferrer">#38268</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-improvements">2 Improvements<a href="https://doris.apache.org/blog/release-note-2.0.14#2-improvements" class="hash-link" aria-label="Direct link to 2 Improvements" title="Direct link to 2 Improvements">&#x200B;</a></h2>
<ul>
<li>
<p>Optimizes the primary key point query performance for MOW tables with sequence columns <a href="https://github.com/apache/doris/pull/38287" target="_blank" rel="noopener noreferrer">#38287</a></p>
</li>
<li>
<p>Enhances the performance of inverted index queries with many conditions  <a href="https://github.com/apache/doris/pull/35346" target="_blank" rel="noopener noreferrer">#35346</a></p>
</li>
<li>
<p>Automatically enables the   <code>support_phrase</code> option when creating a tokenized inverted index to accelerate  <code>match_phrase</code> phrase queries <a href="https://github.com/apache/doris/pull/37949" target="_blank" rel="noopener noreferrer">#37949</a></p>
</li>
<li>
<p>Supports simplified SQL hints, for example: <code>SELECT /*+ query_timeout(3000) */ * FROM t;</code> <a href="https://github.com/apache/doris/pull/37720" target="_blank" rel="noopener noreferrer">#37720</a></p>
</li>
<li>
<p>Automatically retries reading from object storage when encountering a   <code>429</code> error to improve stability <a href="https://github.com/apache/doris/pull/35396" target="_blank" rel="noopener noreferrer">#35396</a></p>
</li>
<li>
<p>LEFT SEMI / ANTI JOIN terminates subsequent matching execution upon matching a qualifying data row to enhance performance. <a href="https://github.com/apache/doris/pull/34703" target="_blank" rel="noopener noreferrer">#34703</a></p>
</li>
<li>
<p>Prevents coredump when returning illegal data to MySQL results. <a href="https://github.com/apache/doris/pull/28069" target="_blank" rel="noopener noreferrer">#28069</a></p>
</li>
<li>
<p>Unifies the output of type names in lowercase to maintain compatibility with MySQL and be more friendly to BI tools. <a href="https://github.com/apache/doris/pull/38521" target="_blank" rel="noopener noreferrer">#38521</a></p>
</li>
</ul>
<p>You can access the full list through the GitHub <a href="https://github.com/apache/doris/compare/2.0.13...2.0.14" target="_blank" rel="noopener noreferrer">link</a> , with the key features and improvements highlighted below.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="credits">Credits<a href="https://doris.apache.org/blog/release-note-2.0.14#credits" class="hash-link" aria-label="Direct link to Credits" title="Direct link to Credits">&#x200B;</a></h2>
<p>Thanks all who contribute to this release:</p>
<p>@ByteYue, @CalvinKirs, @GoGoWen, @HappenLee, @Jibing-Li, @Lchangliang, @LiBinfeng-01, @Mryange, @XieJiann, @Yukang-Lian, @Yulei-Yang, @airborne12, @amorynan, @biohazard4321, @cambyzju, @csun5285, @eldenmoon, @englefly, @freemandealer, @hello-stephen, @hubgeter, @kaijchen, @liaoxin01, @luwei16, @morningman, @morrySnow, @mymeiyi, @qidaye, @sollhui, @starocean999, @w41ter, @wuwenchi, @xiaokang, @xy720, @yujun777, @zclllyybb, @zddr, @zhangstar333, @zhiqiang-hhhh, @zy-kkk, @zzzxl1993</p></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Release Notes" term="Release Notes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Migrate data lakehouse from BigQuery to Apache Doris, saving $4,500 per month]]></title>
        <id>https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris</id>
        <link href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris"/>
        <updated>2024-07-19T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Dien Tran Thanh shares his firsthand experience, proven best practices, and insightful suggestions for migrating from BigQuery to Apache Doris to build a more cost-efficient data warehouse.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Best Practice</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Migrate data lakehouse from BigQuery to Apache Doris, saving $4,500 per month</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Dien, Tran Thanh</span></span><time datetime="2024-07-19T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">July 19, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><div class="theme-admonition theme-admonition-tip admonition_Gfwi alert alert--success"><div class="admonitionHeading_f1Ed">Special Thanks</div><div class="admonitionContent_UjKb"><p>The Apache Doris community would like to extend our gratitude to Dien for sharing his valuable experience and best practices in migrating from BigQuery to Apache Doris in this insightful and informative article. Dien is also an active member of the Apache Doris open-source <a href="https://join.slack.com/t/apachedoriscommunity/shared_invite/zt-2gmq5o30h-455W226d79zP3L96ZhXIoQ" target="_blank" rel="noopener noreferrer">community</a>, and we are truly appreciative of his ongoing support.</p></div></div>
<p>This article is written by <a href="https://www.linkedin.com/in/dien-tran-thanh-19275b14a/" target="_blank" rel="noopener noreferrer">Dien, Tran Thanh</a> and originally posted on <a href="https://dientt.medium.com/migrate-data-platform-t%E1%BB%AB-bigquery-sang-apache-doris-gi%C3%BAp-gi%E1%BA%A3m-chi-ph%C3%AD-t%E1%BB%AB-6-000-xu%E1%BB%91ng-c%C3%B2n-1-500-40ba9b22967e" target="_blank" rel="noopener noreferrer">Medium</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="the-problem-posed">The problem posed<a href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris#the-problem-posed" class="hash-link" aria-label="Direct link to The problem posed" title="Direct link to The problem posed">&#x200B;</a></h2>
<p>To cut BigQuery costs, my previous employer who worked at a retail company (Regrettably, I&apos;m not at liberty to disclose the name) asked me as an Advisor to research and design a data platform on-premises. In the data-driven company, it spent about $6,000 on BigQuery (The current scanning cost is $8.44 per TB &#x2014; Pay-as-you-go, not including taxes and storage fees).</p>
<p>I summarize the sources of the high BigQuery cost into the following:</p>
<ul>
<li>
<p><strong>ETL</strong>: More than 500 tables drawn from CRM system, OMS system, tracking on web/app, affiliates, marketplace, and social media... (Only the tables necessary for the current requirements are stored. For tables that are not actively needed, the data is stored as Parquet files in Google Cloud Storage (GCS)).</p>
</li>
<li>
<p><strong>Tables</strong>: The departments built nearly 120 tables in the data mart, including the reports of accounting, marketing, sales, operations, and BOD.</p>
</li>
<li>
<p><strong>Dashboards</strong>: There are 45 dashboards, each having 7&#x2013;10 charts on average.</p>
</li>
<li>
<p><strong>Queries</strong>: The systems running campaigns interact with BigQuery, as they need to query through a large volume of data (coded in Java, reading data from BigQuery).</p>
</li>
</ul>
<p>The situation was complicated. After reviewing the data usage, I realized that the existing data lakehouse has already optimized the use of BigQuery. They have applied the techniques suggested by Google, such as partitioning, clustering, materialized views, denormalization, and caching. Additionally, they have workers monitoring the audit logs to detect expensive queries and alerts to ensure the queries follow the established rules. That is to say, there was little room for further optimization on the BigQuery side.</p>
<p>Given this scenario, using an open-source on-premises solution appeared to be the choice. However, this would come with the trade-off of increased operational costs. Those who have migrated from a cloud-based solution to an on-premises one will understand the challenges associated with this decision.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="approach-to-the-problem">Approach to the problem<a href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris#approach-to-the-problem" class="hash-link" aria-label="Direct link to Approach to the problem" title="Direct link to Approach to the problem">&#x200B;</a></h2>
<p>The key requirements for this migration process are:</p>
<ul>
<li>
<p>Leverage the existing ETL pipeline with minimal changes.</p>
</li>
<li>
<p>Reuse the existing data marts that have been built by various teams. As 90% of them are built using SQL, the new data lakehouse system needs to have strong SQL support to enable the reuse of the existing workflows.</p>
</li>
<li>
<p>Ensure the current services (written in Java) can seamlessly connect to the new lakehouse, with minimal changes to the application logic.</p>
</li>
<li>
<p>Rebuild the existing dashboards on Metabase (a BI tool). This could be challenging as there might be differences in syntax or support for certain functions (e.g., window functions) between BigQuery and the new system.</p>
</li>
<li>
<p>Achieve good system performance, stability, flexibility, and easy scalability.</p>
</li>
<li>
<p>Hopefully, be able to read data from Apache Iceberg, as this is where the Machine Learning team exports their model results.</p>
</li>
<li>
<p>Hopefully, store vector data for the AI chatbot.</p>
</li>
<li>
<p>Ensure the new data lakehouse is easy for the existing teams to learn and adopt, especially in terms of SQL syntax.</p>
</li>
<li>
<p>The long-term maintenance costs of the new system should be low, with a reasonable initial effort to understand the operational aspects.</p>
</li>
</ul>
<p>Based on the information provided, I found <a href="https://doris.apache.org/" target="_blank" rel="noopener noreferrer">Apache Doris</a>, an open source data warehouse, to be a suitable solution. (A friend introduced it to me before, when performing this migration, I had 5 months of experience working with Doris.)</p>
<p>Around 20TB of data needs to be scanned daily. According to BigQuery charts, the peak hours are 00:00&#x2013;06:00, 8:30&#x2013;11:00 and 14:30&#x2013;16 :00). I use the following hardware configuration:</p>
<ul>
<li>
<p>3 Follower nodes, each with 20GB RAM, 12 CPU, and 200GB SSD</p>
</li>
<li>
<p>1 Observer node with 8GB RAM, 8 CPU, and 100GB SSD</p>
</li>
<li>
<p>3 Backend nodes, each with 64GB RAM, 32 CPU, and 3TB SSD</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="apache-doris-architecture" src="https://cdnd.selectdb.com/assets/images/apache-doris-architecture-3b2a8b33e45ebdfc64dd873c547eb8b1.png" width="1280" height="1080" class="img_ev3q"></p>
<p>With this configuration, the estimated monthly cost is around 37 million VND (using a server service provided by a Vietnamese company and the pricing may vary across different providers.).</p>
<p>Reasons to choose Apache Doris:</p>
<ul>
<li>
<p>Doris is being actively developed by Baidu to meet their own needs. It is widely used by other major tech companies such as Alibaba, Tencent, and Xiaomi... and recently many technology companies in India.</p>
</li>
<li>
<p>The Doris community, while smaller compared to Clickhouse, has an active Slack group where users can get support and direct answers from the developers, including those who have previously encountered and resolved similar issues.</p>
</li>
<li>
<p>Doris supports the MySQL protocol, allowing applications and tools that can connect to MySQL to also connect to Doris.</p>
</li>
<li>
<p>Doris provides high availability, where data can still be queried even if a node goes down, as long as the table&apos;s replication settings are configured properly.</p>
</li>
<li>
<p>Doris can be scaled both horizontally and vertically. In cases where local storage is insufficient, data can be stored on HDFS, S3, GCS, and accessed using federated queries.</p>
</li>
<li>
<p>Doris&apos; performance is optimized through the Massive Parallel Processing architecture, and features like predicate pushdown, partitioning, various Indexing mechanisms, and rollup (very useful). It also uses a columnar data format and provides flexible join capabilities, including broadcast joins and local joins utilizing replicas to avoid data shuffling. It provides more flexible upsert than ClickHouse.</p>
</li>
</ul>
<p>There are many more reasons, but I&apos;ve only highlighted a part of them above.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="problem-solving">Problem solving<a href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris#problem-solving" class="hash-link" aria-label="Direct link to Problem solving" title="Direct link to Problem solving">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="migrate-etl-streams-from-data-sources">Migrate ETL streams from data sources<a href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris#migrate-etl-streams-from-data-sources" class="hash-link" aria-label="Direct link to Migrate ETL streams from data sources" title="Direct link to Migrate ETL streams from data sources">&#x200B;</a></h3>
<p>Below is the high-level data architecture of the data flow before migration:</p>
<p><img decoding="async" loading="lazy" alt="Migrate ETL streams from data sources" src="https://cdnd.selectdb.com/assets/images/migrate-etl-streams-from-data-sources-a183600c5e7182e9ab0838d3a2bea3d5.png" width="1280" height="467" class="img_ev3q"></p>
<p>The company has saved costs by using open-source solutions for the ETL processing components, and it used only GCS and BigQuery. I will not delve into the details of the architecture here but keep the explanation simple to provide a high-level understanding of the migration process. If a more comprehensive solution is required, there are options like Apache Iceberg and Trino that can be leveraged for ad-hoc processing, A/B testing, etc.</p>
<p>This is the architecture after migration.</p>
<p><img decoding="async" loading="lazy" alt="Migrate ETL streams from data sources" src="https://cdnd.selectdb.com/assets/images/migrate-etl-streams-from-data-sources-2-75508eb1c2632d093290faad010c4194.png" width="1280" height="467" class="img_ev3q"></p>
<p>To minimize the changes, we have used a similar architecture, where Apache Doris provides a connector that allows Apache Flink to directly upsert data into it.</p>
<p>The File Storage Service is provided by the server company. (The client connection is similar to S3, and I guess the underlying core could be MinIO.)</p>
<p>Apache Doris supports reading real-time data directly from Kafka and performing simple ETL, but to reduce the burden on Doris and leverage the processing capabilities of Apache Flink, we have only created an abstraction to push the data into Doris, which is quite straightforward.</p>
<p>Migrating the old data is more challenging, and we have implemented the following steps:</p>
<ul>
<li>
<p><strong>Step 1</strong>: A script reads the schema for each table on BigQuery, and then creates corresponding tables with the same schema and partition columns on Doris (luckily, we don&apos;t have to deal with complex data types). Currently, Doris does not support clustering columns, but it does provide various indexes such as Bitmap Index, Prefix Index, Bloom Filter Index, and Inverted Index, depending on the use case.</p>
</li>
<li>
<p><strong>Step 2</strong>: A script exports each table from BigQuery into Parquet files and stores them in GCS.</p>
</li>
<li>
<p><strong>Step 3</strong>: A script directly reads the files from GCS and loads them into Doris (Doris supports reading data from File Storage System quite easily, requiring only a simple SQL statement).</p>
</li>
</ul>
<p>During the migration, we have prepared scripts and techniques to ensure data consistency between BigQuery and Doris when the new ETL flow on Doris starts consuming the new data.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="migrate-data-marts-flow">Migrate data marts flow<a href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris#migrate-data-marts-flow" class="hash-link" aria-label="Direct link to Migrate data marts flow" title="Direct link to Migrate data marts flow">&#x200B;</a></h3>
<p>This part is quite straightforward as the old flow used Apache Airflow, where they defined SQL (easy to manage SQL version when building Data Marts) and then used the Google Cloud BigQuery Operator to interact with BigQuery. In this part, I have replaced the BigQuery Operator with the MySQL Operator to connect to Doris. The Doris SQL is compatible with 90% of the old flow, so I can reuse the old SQL statements.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="migrate-services-pointing-to-bigquery">Migrate services pointing to BigQuery<a href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris#migrate-services-pointing-to-bigquery" class="hash-link" aria-label="Direct link to Migrate services pointing to BigQuery" title="Direct link to Migrate services pointing to BigQuery">&#x200B;</a></h3>
<p>This part is also easy as the majority of the services use simple custom SQL. The tables they use are mostly pre-calculated (denormalized, big tables, or materialized views), so there is almost no need for changes, except for the connection part to Doris, but we don&apos;t have to change the code logic.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="migrate-dashboards-in-metabase">Migrate dashboards in Metabase<a href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris#migrate-dashboards-in-metabase" class="hash-link" aria-label="Direct link to Migrate dashboards in Metabase" title="Direct link to Migrate dashboards in Metabase">&#x200B;</a></h3>
<p>When Metabase connects to Doris, some dashboards will throw errors due to different function syntax. For example, Doris uses the Window Functions such as <code>LEAD(expr, offset, default) OVER (partition_by_clause order_by_clause)</code>, while in BigQuery, it is <code>LEAD(expr) OVER (partition_by_clause order_by_clause)</code>. Such difference can lead to logical errors, so we need to remove those charts and rebuild the new syntax on Doris.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring">Monitoring<a href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris#monitoring" class="hash-link" aria-label="Direct link to Monitoring" title="Direct link to Monitoring">&#x200B;</a></h3>
<p>After all the migration, we use Airflow to check the data of both BigQuery and Doris for each table and each chart. When a table has a discrepancy, we will zoom in to handle it. Overall, we haven&apos;t seen any complex errors, and the discrepancy rate is less than 5%.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="evaluation">Evaluation<a href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris#evaluation" class="hash-link" aria-label="Direct link to Evaluation" title="Direct link to Evaluation">&#x200B;</a></h2>
<p>After the ETL pipeline ran stably for a week, I provided the team with a trial version. After 4 weeks of testing, the performance remained stable, with occasional failures of a Frontend (FE) node. (When one FE node died, the system could still be queried though. Only backend failures would impact performance since that means the parallel server capacity could not be fully utilized. When a failure occurred, the system would self-recover within 2 seconds). During peak hours, queries were often slow because the ETL job consuming over 70% of the resources. The solution was to reconfigure the resource allocation to restrict the ETL account from consuming more than 40% of resources. (Doris provides a <a href="https://doris.apache.org/blog/multi-tenant-workload-isolation-in-apache-doris" target="_blank" rel="noopener noreferrer">mechanism</a> to share resources between account groups, where normally unused resources can be borrowed, but during contention each group is limited to its allocated portion, so limiting ETL to 40% resolved the issue during high concurrent usage.)</p>
<p>The team plans to run the old and new systems in parallel for another 2-3 weeks. If everything checks out, they will then shut down the BigQuery pipeline.</p>
<p>Currently, the new system is not fully optimized, and the team hasn&apos;t utilized all the features that Apache Doris provides. With more time to explore, it seems they could solve many more problems.</p>
<p>The implementation was carried out by 1 Data Engineer, 1 Software Engineer, and 1 Data Analyst over 4 weeks.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advantages-of-the-new-system">Advantages of the new system<a href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris#advantages-of-the-new-system" class="hash-link" aria-label="Direct link to Advantages of the new system" title="Direct link to Advantages of the new system">&#x200B;</a></h2>
<ul>
<li>
<p>The biggest advantage is the cost savings. The monthly cost has been reduced from $6,000 to $1,500.</p>
</li>
<li>
<p>It supports seamless data import from Apache Iceberg. The Machine Learning and data mining team can directly import data without needing to create a separate pipeline like with BigQuery.</p>
</li>
<li>
<p>It supports <a href="https://python.langchain.com/v0.2/docs/integrations/vectorstores/apache_doris/" target="_blank" rel="noopener noreferrer">vector data storage</a> for AI chatbots. Data can be directly imported from the File Store Service (S3) instead of having to push it to Redis as before.</p>
</li>
<li>
<p>It provides efficient data aggregation through the Rollup mechanism.</p>
</li>
<li>
<p>It allows hybrid hot and cold storage within a single table. The older, less frequently accessed data can be stored in cold storage on the File Store Service, with Doris automatically retrieving the cold data when needed (though this may incur a slight performance penalty).</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="disadvantages-of-the-new-system">Disadvantages of the new system<a href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris#disadvantages-of-the-new-system" class="hash-link" aria-label="Direct link to Disadvantages of the new system" title="Direct link to Disadvantages of the new system">&#x200B;</a></h2>
<ul>
<li>
<p>It is difficult to maintain, as it requires significant time to adjust the many configuration parameters (over 100) to ensure the system operates as expected.</p>
</li>
<li>
<p>Users may encounter OOM errors if too many users access the system at the same time, as different queries compete for RAM resources (in this case, some users may encounter errors while others do not, depending on the process and group_account).</p>
</li>
<li>
<p>Data replication between nodes can sometimes lose synchronization due to network issues or other reasons, and the automatic replication retry mechanism may not be successful. In such cases, it is necessary to set up an external worker mechanism for automatic handling (Doris manages a storage unit called Tablet. The metadata on each node records the ETL data into a specific table, and the metadata version gets updated. Doris provides a SQL-based method to handle desynchronization).</p>
</li>
<li>
<p>New versions may occasionally have bugs, so it&apos;s recommended to check if the <a href="https://join.slack.com/t/apachedoriscommunity/shared_invite/zt-2gmq5o30h-455W226d79zP3L96ZhXIoQ" target="_blank" rel="noopener noreferrer">community</a> has reported any issues before deciding to upgrade.</p>
</li>
<li>
<p>Limited support for processing Vietnamese text, with the full-text search feature not performing well in Vietnamese.</p>
</li>
<li>
<p>The servers used are provided by a Vietnamese company, which seems to be using OpenStack, so they can occasionally be unstable. The occasional node disconnections require intervention from the provider. However, due to the high availability feature, Doris can still be used, though performance may be reduced during these periods (node disconnections are not frequent, occurring around once every few months). If the disconnection happens on a BE node, data rebalancing may be required if there are active ETL jobs at that time.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="key-lessons-from-this-migration-process">Key lessons from this migration process<a href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris#key-lessons-from-this-migration-process" class="hash-link" aria-label="Direct link to Key lessons from this migration process" title="Direct link to Key lessons from this migration process">&#x200B;</a></h2>
<ul>
<li>
<p>The bandwidth requirements were not properly estimated, so Doris sometimes exceeds the read capacity when reading data from the old tables stored in GCS.</p>
</li>
<li>
<p>The migration team was not fully dedicated to the task, spending only 70% of their time on the migration and 30% on other responsibilities. This intermittent work led to lower-than-expected performance. (I worked part-time.)</p>
</li>
<li>
<p>For real-time data streams, the recorded storage files are very small in size, so it is necessary to adjust the compaction configuration so that Doris can merge files in groups, which will give better query performance.</p>
</li>
<li>
<p>We spent significant time manually inspecting the data mart tables to determine the appropriate index type. However, this process can be automated by leveraging a metadata management tool like Datahub.</p>
</li>
<li>
<p>The data quality validation process was not thorough enough. We should use a more comprehensive approach combining count, sum, and dimensional checks to ensure high data accuracy.</p>
</li>
<li>
<p>We realized that the old system, built by the management, was designed with extensibility, integration, and migration in mind, so I hardly changed the flow or logic but made the most of the old system. It is a valuable lesson to learn from the legacy system&apos;s architecture.</p>
</li>
</ul>
<p>This article does not go into depth on the technical details of the new data lakehouse techniques, and the process of selecting the appropriate technologies is not discussed in detail, either.</p>
<p>Now, the data lakehouse has been used stably by the teams for weeks, and both the CTO and CFO are happy with it. However, it will require more extensive usage to enable a more objective evaluation.</p>
<p>Note: Using BigQuery is still more convenient than Doris, as Doris is an open-source solution and can have some minor issues. Doris requires more complex techniques to ensure a stable cluster, or it will require more effort in cluster maintenance. However, if you use Doris for an extended period and develop a good understanding of how to operate it, the maintenance costs are not particularly high.</p>
<p>Nevertheless, I still prefer using BigQuery. :D</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="https://doris.apache.org/blog/migrate-lakehouse-from-bigquery-to-doris#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">&#x200B;</a></h2>
<ul>
<li>
<p>Debezium: <a href="https://debezium.io/" target="_blank" rel="noopener noreferrer">https://debezium.io/</a></p>
</li>
<li>
<p>Apache Doris: <a href="https://doris.apache.org/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/</a></p>
</li>
<li>
<p>Tencent blog: <a href="https://medium.com/geekculture/tencent-data-engineer-why-we-go-from-clickhouse-to-apache-doris-db120f324290" target="_blank" rel="noopener noreferrer">https://medium.com/geekculture/tencent-data-engineer-why-we-go-from-clickhouse-to-apache-doris-db120f324290</a></p>
</li>
</ul></div>]]></content>
        <author>
            <name>Dien, Tran Thanh</name>
        </author>
        <category label="Best Practice" term="Best Practice"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Apache Doris version 2.0.13 has been released]]></title>
        <id>https://doris.apache.org/blog/release-note-2.0.13</id>
        <link href="https://doris.apache.org/blog/release-note-2.0.13"/>
        <updated>2024-07-17T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Thanks to our community users and developers, about 112 improvements and bug fixes have been made in Doris 2.0.13 version.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Release Notes</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Apache Doris version 2.0.13 has been released</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-07-17T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">July 17, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Thanks to our community users and developers, about 112 improvements and bug fixes have been made in Doris 2.0.13 version</p>
<p><a href="https://doris.apache.org/download/" target="_blank" rel="noopener noreferrer">Quick Download</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="behavior-changes">Behavior changes<a href="https://doris.apache.org/blog/release-note-2.0.13#behavior-changes" class="hash-link" aria-label="Direct link to Behavior changes" title="Direct link to Behavior changes">&#x200B;</a></h2>
<p>SQL input is treated as multiple statements only when the <code>CLIENT_MULTI_STATEMENTS</code> setting is enabled on the client side, enhancing compatibility with MySQL. <a href="https://github.com/apache/doris/pull/36759" target="_blank" rel="noopener noreferrer">#36759</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-features">New features<a href="https://doris.apache.org/blog/release-note-2.0.13#new-features" class="hash-link" aria-label="Direct link to New features" title="Direct link to New features">&#x200B;</a></h2>
<ul>
<li>
<p>A new BE configuration <code>allow_zero_date</code> has been added, allowing dates with all zeros. When set to <code>false</code>, <code>0000-00-00</code> is parsed as <code>NULL</code>, and when set to <code>true</code>, it is parsed as <code>0000-01-01</code>. The default value is <code>false</code> to maintain consistency with previous behavior. <a href="https://github.com/apache/doris/pull/34961" target="_blank" rel="noopener noreferrer">#34961</a></p>
</li>
<li>
<p><code>LogicalWindow</code> and <code>LogicalPartitionTopN</code> support multi-field predicate pushdown to improve performance. <a href="https://github.com/apache/doris/pull/36828" target="_blank" rel="noopener noreferrer">#36828</a></p>
</li>
<li>
<p>The ES Catalog now maps ES <code>nested</code> or <code>object</code> types to Doris <code>JSON</code> types. <a href="https://github.com/apache/doris/pull/37101" target="_blank" rel="noopener noreferrer">#37101</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="https://doris.apache.org/blog/release-note-2.0.13#improvements" class="hash-link" aria-label="Direct link to Improvements" title="Direct link to Improvements">&#x200B;</a></h2>
<ul>
<li>
<p>Queries with <code>LIMIT</code> end reading data earlier to reduce resource consumption and improve performance. <a href="https://github.com/apache/doris/pull/36535" target="_blank" rel="noopener noreferrer">#36535</a></p>
</li>
<li>
<p>Special JSON data with empty keys is now supported. <a href="https://github.com/apache/doris/pull/36762" target="_blank" rel="noopener noreferrer">#36762</a></p>
</li>
<li>
<p>Stability and usability of routine load have been improved, including load balancing, automatic recovery, exception handling, and more user-friendly error messages. <a href="https://github.com/apache/doris/pull/36450" target="_blank" rel="noopener noreferrer">#36450</a> <a href="https://github.com/apache/doris/pull/35376" target="_blank" rel="noopener noreferrer">#35376</a> <a href="https://github.com/apache/doris/pull/35266" target="_blank" rel="noopener noreferrer">#35266</a> <a href="https://github.com/apache/doris/pull/33372" target="_blank" rel="noopener noreferrer"> #33372</a> <a href="https://github.com/apache/doris/pull/32282" target="_blank" rel="noopener noreferrer">#32282</a> <a href="https://github.com/apache/doris/pull/32046" target="_blank" rel="noopener noreferrer">#32046</a> <a href="https://github.com/apache/doris/pull/32021" target="_blank" rel="noopener noreferrer">#32021</a> <a href="https://github.com/apache/doris/pull/31846" target="_blank" rel="noopener noreferrer">#31846</a> <a href="https://github.com/apache/doris/pull/31273" target="_blank" rel="noopener noreferrer">#31273</a></p>
</li>
<li>
<p>BE load balancing selection of hard disk strategy and speed optimization. <a href="https://github.com/apache/doris/pull/36826" target="_blank" rel="noopener noreferrer">#36826</a> <a href="https://github.com/apache/doris/pull/36795" target="_blank" rel="noopener noreferrer">#36795</a> <a href="https://github.com/apache/doris/pull/36509" target="_blank" rel="noopener noreferrer">#36509</a></p>
</li>
<li>
<p>Stability and usability of the JDBC catalog have been improved, including encryption, thread pool connection count configuration, and more user-friendly error messages. <a href="https://github.com/apache/doris/pull/36940" target="_blank" rel="noopener noreferrer">#36940</a> <a href="https://github.com/apache/doris/pull/36720" target="_blank" rel="noopener noreferrer">#36720</a> <a href="https://github.com/apache/doris/pull/30880" target="_blank" rel="noopener noreferrer">#30880</a> <a href="https://github.com/apache/doris/pull/35692" target="_blank" rel="noopener noreferrer">#35692</a></p>
</li>
</ul>
<p>You can access the full list through the GitHub <a href="https://github.com/apache/doris/compare/2.0.12...2.0.13" target="_blank" rel="noopener noreferrer">link</a> , with the key features and improvements highlighted below.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="credits">Credits<a href="https://doris.apache.org/blog/release-note-2.0.13#credits" class="hash-link" aria-label="Direct link to Credits" title="Direct link to Credits">&#x200B;</a></h2>
<p>Thanks to all who contributed to this release:</p>
<p>@Gabriel39, @Jibing-Li, @Johnnyssc, @Lchangliang, @LiBinfeng-01, @SWJTU-ZhangLei, @Thearas, @Yukang-Lian, @Yulei-Yang, @airborne12, @amorynan, @bobhan1, @cambyzju, @csun5285, @dataroaring, @deardeng, @eldenmoon, @englefly, @feiniaofeiafei, @hello-stephen, @jacktengg, @kaijchen, @liutang123, @luwei16, @morningman, @morrySnow, @mrhhsg, @mymeiyi, @platoneko, @qidaye, @sollhui, @starocean999, @w41ter, @xiaokang, @xy720, @yujun777, @zclllyybb, @zddr</p></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Release Notes" term="Release Notes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Apache Doris version 2.0.12 has been released]]></title>
        <id>https://doris.apache.org/blog/release-note-2.0.12</id>
        <link href="https://doris.apache.org/blog/release-note-2.0.12"/>
        <updated>2024-06-27T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Thanks to our community developers and users for their contributions. Doris version 2.0.12 will bring 99 improvements and bug fixes.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Release Notes</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Apache Doris version 2.0.12 has been released</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-06-27T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">June 27, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Thanks to our community developers and users for their contributions. Doris version 2.0.12 will bring 99 improvements and bug fixes.</p>
<p><strong>Quick Download:</strong> <a href="https://doris.apache.org/download/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/download/</a></p>
<p><strong>GitHub Release:</strong> <a href="https://github.com/apache/doris/releases" target="_blank" rel="noopener noreferrer">https://github.com/apache/doris/releases</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="behavior-changes">Behavior changes<a href="https://doris.apache.org/blog/release-note-2.0.12#behavior-changes" class="hash-link" aria-label="Direct link to Behavior changes" title="Direct link to Behavior changes">&#x200B;</a></h2>
<ul>
<li>
<p>No longer set the default table comment to the table type. Instead, set it to be empty by default, for example, change COMMENT &apos;OLAP&apos; to COMMENT &apos; &apos;.  This new behavior is more friendly for BI software that relies on table comments. <a href="https://github.com/apache/doris/pull/35855" target="_blank" rel="noopener noreferrer">#35855</a></p>
</li>
<li>
<p>Change the type of the <code>@@autocommit</code> variable from <code>BOOLEAN</code> to <code>BIGINT</code> to prevent errors from certain MySQL clients (such as .NET MySQL.Data). <a href="https://github.com/apache/doris/pull/33282" target="_blank" rel="noopener noreferrer">#33282</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="https://doris.apache.org/blog/release-note-2.0.12#improvements" class="hash-link" aria-label="Direct link to Improvements" title="Direct link to Improvements">&#x200B;</a></h2>
<ul>
<li>
<p>Remove the <code>disable_nested_complex_type</code> parameter and allow the creation of nested <code>ARRAY</code>, <code>MAP</code>, and <code>STRUCT</code> types by default. <a href="https://github.com/apache/doris/pull/36255" target="_blank" rel="noopener noreferrer">#36255</a></p>
</li>
<li>
<p>The HMS catalog supports the <code>SHOW CREATE DATABASE</code> command. <a href="https://github.com/apache/doris/pull/28145" target="_blank" rel="noopener noreferrer">#28145</a></p>
</li>
<li>
<p>Add more inverted index metrics to the query profile. <a href="https://github.com/apache/doris/pull/36545" target="_blank" rel="noopener noreferrer">#36545</a></p>
</li>
<li>
<p>Cross-Cluster Replication (CCR) supports inverted indices. <a href="https://github.com/apache/doris/pull/31743" target="_blank" rel="noopener noreferrer">#31743</a></p>
</li>
</ul>
<p>You can access the full list through the GitHub <a href="https://github.com/apache/doris/compare/2.0.11...2.0.12" target="_blank" rel="noopener noreferrer">link</a> , with the key features and improvements highlighted below.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="credits">Credits<a href="https://doris.apache.org/blog/release-note-2.0.12#credits" class="hash-link" aria-label="Direct link to Credits" title="Direct link to Credits">&#x200B;</a></h2>
<p>Thanks all who contribute to this release:</p>
<p>@airborne12, D14@amorynan, D14@BiteTheDDDDt, D14@cambyzju, D14@caoliang-web, D14@dataroaring, D14@eldenmoon, D14@feiniaofeiafei, D14@felixwluo, D14@gavinchou, D14@HappenLee, D14@hello-stephen, D14@jacktengg, D14@Jibing-Li, D14@Johnnyssc, D14@liaoxin01, D14@LiBinfeng-01, D14@luwei16, D14@mongo360, D14@morningman, D14@morrySnow, D14@mrhhsg, D14@Mryange, D14@mymeiyi, D14@qidaye, D14@qzsee, D14@starocean999, D14@w41ter, D14@wangbo, D14@wsjz, D14@wuwenchi, D14@xiaokang, D14@XuPengfei-1020, D14@xy720, D14@yongjinhou, D14@yujun777, D14@Yukang-Lian, D14@Yulei-Yang, D14@zclllyybb, D14@zddr, D14@zhannngchen, D14@zhiqiang-hhhh, D14@zy-kkk, D14@zzzxl1993</p></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Release Notes" term="Release Notes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Apache Doris 2.1.4 just released]]></title>
        <id>https://doris.apache.org/blog/release-note-2.1.4</id>
        <link href="https://doris.apache.org/blog/release-note-2.1.4"/>
        <updated>2024-06-26T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[In this update, we have optimized various functional experiences for data lakehouse scenarios, with a focus on resolving the abnormal memory usage issue in the previous version.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Release Notes</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Apache Doris 2.1.4 just released</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-06-26T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">June 26, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Dear community, Apache Doris version 2.1.4 was released on June 26, 2024. In this update, we have optimized various functional experiences for data lakehouse scenarios, with a focus on resolving the abnormal memory usage issue in the previous version. Additionally, we have implemented several improvemnents and bug fixes to enhance the stability.  Welcome to download and use it.</p>
<p><strong>Quick Download:</strong> <a href="https://doris.apache.org/download/" target="_blank" rel="noopener noreferrer">https://doris.apache.org/download/</a></p>
<p><strong>GitHub Release:</strong> <a href="https://github.com/apache/doris/releases" target="_blank" rel="noopener noreferrer">https://github.com/apache/doris/releases</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="behavior-changes">Behavior changes<a href="https://doris.apache.org/blog/release-note-2.1.4#behavior-changes" class="hash-link" aria-label="Direct link to Behavior changes" title="Direct link to Behavior changes">&#x200B;</a></h2>
<ul>
<li>
<p>Non-existent files will be ignored when querying external tables such as Hive. <a href="https://github.com/apache/doris/pull/35319" target="_blank" rel="noopener noreferrer">#35319</a></p>
<p>The file list is obtained from the meta cache, and it may not be consistent with the actual file list.</p>
<p>Ignoring non-existent files helps to avoid query errors.</p>
</li>
<li>
<p>By default, creating a Bitmap Index will no longer be automatically changed to an Inverted Index. <a href="https://github.com/apache/doris/pull/35521" target="_blank" rel="noopener noreferrer">#35521</a></p>
<p>This behavior is controlled by the FE configuration item <code>enable_create_bitmap_index_as_inverted_index</code>, which defaults to false.</p>
</li>
<li>
<p>When starting FE and BE processes using <code>--console</code>, all logs will be output to the standard output and differentiated by prefixes indicating the log type. <a href="https://github.com/apache/doris/pull/35679" target="_blank" rel="noopener noreferrer">#35679</a></p>
<p>For more infomation, please see the documentations:</p>
<ul>
<li>
<p><a href="https://doris.apache.org/docs/admin-manual/log-management/fe-log" target="_blank" rel="noopener noreferrer">Log Management - FE Log</a></p>
</li>
<li>
<p><a href="https://doris.apache.org/docs/admin-manual/log-management/be-log" target="_blank" rel="noopener noreferrer">Log Management - BE Log</a></p>
</li>
</ul>
</li>
<li>
<p>If no table comment is provided when creating a table, the default comment will be empty instead of using the table type as the default comment. <a href="https://github.com/apache/doris/pull/36025" target="_blank" rel="noopener noreferrer">#36025</a></p>
</li>
<li>
<p>The default precision of DECIMALV3 has been adjusted from (9, 0) to (38, 9) to maintain compatibility with the version in which this feature was initially released. <a href="https://github.com/apache/doris/pull/36316" target="_blank" rel="noopener noreferrer">#36316</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="new-features">New features<a href="https://doris.apache.org/blog/release-note-2.1.4#new-features" class="hash-link" aria-label="Direct link to New features" title="Direct link to New features">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer">Query Optimizer<a href="https://doris.apache.org/blog/release-note-2.1.4#query-optimizer" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>
<p>Support FE flame graph tool</p>
<p>For more information, see the <a href="https://doris.apache.org/community/developer-guide/fe-profiler" target="_blank" rel="noopener noreferrer">documentation</a></p>
</li>
<li>
<p>Support <code>SELECT DISTINCT</code> to be used with aggregation.</p>
</li>
<li>
<p>Support single table query rewrite without <code>GROUP BY</code>. This is useful for complex filters or expressions. <a href="https://github.com/apache/doris/pull/35242" target="_blank" rel="noopener noreferrer">#35242</a>.</p>
</li>
<li>
<p>The new optimizer fully supports point query functionality <a href="https://github.com/apache/doris/pull/36205" target="_blank" rel="noopener noreferrer">#36205</a>.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse">Lakehouse<a href="https://doris.apache.org/blog/release-note-2.1.4#lakehouse" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>
<p>Support native reader of Apache Paimon deletion vector  <a href="https://github.com/apache/doris/pull/35241" target="_blank" rel="noopener noreferrer">#35241</a></p>
</li>
<li>
<p>Support using Resource in Table Valued Functions <a href="https://github.com/apache/doris/pull/35139" target="_blank" rel="noopener noreferrer">#35139</a></p>
</li>
<li>
<p>Access controller with Hive Ranger plugin supports Data Mask</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-materialized-views">Asynchronous Materialized Views<a href="https://doris.apache.org/blog/release-note-2.1.4#asynchronous-materialized-views" class="hash-link" aria-label="Direct link to Asynchronous Materialized Views" title="Direct link to Asynchronous Materialized Views">&#x200B;</a></h3>
<ul>
<li>
<p>Support partition roll-up during construction. <a href="https://github.com/apache/doris/pull/31812" target="_blank" rel="noopener noreferrer">#31812</a></p>
</li>
<li>
<p>Support triggered updates during construction. <a href="https://github.com/apache/doris/pull/34548" target="_blank" rel="noopener noreferrer">#34548</a></p>
</li>
<li>
<p>Support specifying the <code>store_row_column</code> and <code>storage_medium</code> attribute during construction. <a href="https://github.com/apache/doris/pull/35860" target="_blank" rel="noopener noreferrer">#35860</a></p>
</li>
<li>
<p>Transparent rewrite supports single table asynchronous materialized views. <a href="https://github.com/apache/doris/pull/34646" target="_blank" rel="noopener noreferrer">#34646</a></p>
</li>
<li>
<p>Transparent rewrite supports <code>AGG_STATE</code> type aggregation roll-up. <a href="https://github.com/apache/doris/pull/35026" target="_blank" rel="noopener noreferrer">#35026</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="others">Others<a href="https://doris.apache.org/blog/release-note-2.1.4#others" class="hash-link" aria-label="Direct link to Others" title="Direct link to Others">&#x200B;</a></h3>
<ul>
<li>
<p>Added function <code>replace_empty</code>.</p>
<p>For more information, see <a href="https://doris.apache.org/docs/sql-manual/sql-functions/string-functions/replace_empty" target="_blank" rel="noopener noreferrer">documentation</a>.</p>
</li>
<li>
<p>Support <code>show storage policy using</code> statement.</p>
<p>For more information, see <a href="https://doris.apache.org/docs/sql-manual/sql-statements/Show-Statements/SHOW-STORAGE-POLICY-USING/" target="_blank" rel="noopener noreferrer">documentation</a>.</p>
</li>
<li>
<p>Support JVM metrics on the BE side.</p>
<p>By setting <code>enable_jvm_monitor=true</code> in <code>be.conf</code> to enable this feature.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="improvements">Improvements<a href="https://doris.apache.org/blog/release-note-2.1.4#improvements" class="hash-link" aria-label="Direct link to Improvements" title="Direct link to Improvements">&#x200B;</a></h2>
<ul>
<li>
<p>Supported creating inverted indexes for columns with Chinese names. <a href="https://github.com/apache/doris/pull/36321" target="_blank" rel="noopener noreferrer">#36321</a></p>
</li>
<li>
<p>Estimate memory consumed by segment cache more accurately so that unused memory can be released more quickly. <a href="https://github.com/apache/doris/pull/35751" target="_blank" rel="noopener noreferrer">#35751</a></p>
</li>
<li>
<p>Filter empty partitions before exporting tables to remote storage. <a href="https://github.com/apache/doris/pull/35542" target="_blank" rel="noopener noreferrer">#35542</a></p>
</li>
<li>
<p>Optimize routine load task allocation algorithm to balance the load among Backends. <a href="https://github.com/apache/doris/pull/34778" target="_blank" rel="noopener noreferrer">#34778</a></p>
</li>
<li>
<p>Provide hints when a related variable is not found during a set operation. <a href="https://github.com/apache/doris/pull/35775" target="_blank" rel="noopener noreferrer">#35775</a></p>
</li>
<li>
<p>Support placing Java UDF jar files in the FE&apos;s <code>custom_lib</code> directory for default loading. <a href="https://github.com/apache/doris/pull/35984" target="_blank" rel="noopener noreferrer">#35984</a></p>
</li>
<li>
<p>Add a timeout global variable <code>audit_plugin_load_timeout</code> for audit log load jobs.</p>
</li>
<li>
<p>Optimize the performance of transparent rewrite planning for asynchronous materialized views.</p>
</li>
<li>
<p>Optimize the <code>INSERT</code> operation that when the source is empty, the BE will not execute. <a href="https://github.com/apache/doris/pull/34418" target="_blank" rel="noopener noreferrer">#34418</a></p>
</li>
<li>
<p>Support fetching file lists of Hive/Hudi tables in batches. <a href="https://github.com/apache/doris/pull/35107" target="_blank" rel="noopener noreferrer">#35107</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bug-fixes">Bug fixes<a href="https://doris.apache.org/blog/release-note-2.1.4#bug-fixes" class="hash-link" aria-label="Direct link to Bug fixes" title="Direct link to Bug fixes">&#x200B;</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-optimizer-1">Query Optimizer<a href="https://doris.apache.org/blog/release-note-2.1.4#query-optimizer-1" class="hash-link" aria-label="Direct link to Query Optimizer" title="Direct link to Query Optimizer">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue where SQL cache returns old results after truncating a partition. <a href="https://github.com/apache/doris/pull/34698" target="_blank" rel="noopener noreferrer">#34698</a></p>
</li>
<li>
<p>Fixed the issue where casting from JSON to other types did not correctly handle nullable attributes. <a href="https://github.com/apache/doris/pull/34707" target="_blank" rel="noopener noreferrer">#34707</a></p>
</li>
<li>
<p>Fixed occasional DATETIMEV2 literal simplification errors. <a href="https://github.com/apache/doris/pull/35153" target="_blank" rel="noopener noreferrer">#35153</a></p>
</li>
<li>
<p>Fixed the issue where <code>COUNT(*)</code> could not be used in window functions. <a href="https://github.com/apache/doris/pull/35220" target="_blank" rel="noopener noreferrer">#35220</a></p>
</li>
<li>
<p>Fixed the issue where nullable attributes could be incorrect when all <code>SELECT</code> statements under <code>UNION ALL</code> have no <code>FROM</code> clause. <a href="https://github.com/apache/doris/pull/35074" target="_blank" rel="noopener noreferrer">#35074</a></p>
</li>
<li>
<p>Fixed the issue where <code>bitmap in join</code> and subquery unnesting could not be used simultaneously. <a href="https://github.com/apache/doris/pull/35435" target="_blank" rel="noopener noreferrer">#35435</a></p>
</li>
<li>
<p>Fixed the performance issue where filter conditions could not be pushed down to the CTE producer in specific situations. <a href="https://github.com/apache/doris/pull/35463" target="_blank" rel="noopener noreferrer">#35463</a></p>
</li>
<li>
<p>Fixed the issue where aggregate combinators written in uppercase could not be found. <a href="https://github.com/apache/doris/pull/35540" target="_blank" rel="noopener noreferrer">#35540</a></p>
</li>
<li>
<p>Fixed the performance issue where window functions were not properly pruned by column pruning. <a href="https://github.com/apache/doris/pull/35504" target="_blank" rel="noopener noreferrer">#35504</a></p>
</li>
<li>
<p>Fixed the issue where queries might parse incorrectly leading to wrong results when multiple tables with the same name but in different databases appeared simultaneously in the query. <a href="https://github.com/apache/doris/pull/35571" target="_blank" rel="noopener noreferrer">#35571</a></p>
</li>
<li>
<p>Fixed the query error caused by generating runtime filters during schema table scans. <a href="https://github.com/apache/doris/pull/35655" target="_blank" rel="noopener noreferrer">#35655</a></p>
</li>
<li>
<p>Fixed the issue where nested correlated subqueries could not execute because the join condition was folded into a null literal. <a href="https://github.com/apache/doris/pull/35811" target="_blank" rel="noopener noreferrer">#35811</a></p>
</li>
<li>
<p>Fixed the occasional issue where decimal literals were set with incorrect precision during planning. <a href="https://github.com/apache/doris/pull/36055" target="_blank" rel="noopener noreferrer">#36055</a></p>
</li>
<li>
<p>Fixed the occasional issue where multiple layers of aggregation were merged incorrectly during planning. <a href="https://github.com/apache/doris/pull/36145" target="_blank" rel="noopener noreferrer">#36145</a></p>
</li>
<li>
<p>Fixed the occasional issue where the input-output mismatch error occurred after aggregate expansion planning. <a href="https://github.com/apache/doris/pull/36207" target="_blank" rel="noopener noreferrer">#36207</a></p>
</li>
<li>
<p>Fixed the occasional issue where <code>&lt;=&gt;</code> was incorrectly converted to <code>=</code>. <a href="https://github.com/apache/doris/pull/36521" target="_blank" rel="noopener noreferrer">#36521</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="query-execution">Query Execution<a href="https://doris.apache.org/blog/release-note-2.1.4#query-execution" class="hash-link" aria-label="Direct link to Query Execution" title="Direct link to Query Execution">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue where the query hangs if the limited rows are reached on the pipeline engine and memory is not released. <a href="https://github.com/apache/doris/pull/35746" target="_blank" rel="noopener noreferrer">#35746</a></p>
</li>
<li>
<p>Fixed the BE coredump when <code>enable_decimal256</code> is true but falls back to the old planner. <a href="https://github.com/apache/doris/pull/35731" target="_blank" rel="noopener noreferrer">#35731</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="asynchronous-materialized-views-1">Asynchronous Materialized Views<a href="https://doris.apache.org/blog/release-note-2.1.4#asynchronous-materialized-views-1" class="hash-link" aria-label="Direct link to Asynchronous Materialized Views" title="Direct link to Asynchronous Materialized Views">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue where asynchronous materialized views caused backup and restore exceptions. <a href="https://github.com/apache/doris/pull/35703" target="_blank" rel="noopener noreferrer">#35703</a></p>
</li>
<li>
<p>Fixed the issue where partition rewrite could lead to incorrect results. <a href="https://github.com/apache/doris/pull/35236" target="_blank" rel="noopener noreferrer">#35236</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="semi-structured">Semi-structured<a href="https://doris.apache.org/blog/release-note-2.1.4#semi-structured" class="hash-link" aria-label="Direct link to Semi-structured" title="Direct link to Semi-structured">&#x200B;</a></h3>
<ul>
<li>Fixed the core dump problem when a VARIANT with an empty key is used. <a href="https://github.com/apache/doris/pull/35671" target="_blank" rel="noopener noreferrer">#35671</a></li>
<li>Bitmap and BloomFilter index should not perform light index changes. <a href="https://github.com/apache/doris/pull/35225" target="_blank" rel="noopener noreferrer">#35225</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="primary-key">Primary Key<a href="https://doris.apache.org/blog/release-note-2.1.4#primary-key" class="hash-link" aria-label="Direct link to Primary Key" title="Direct link to Primary Key">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue where an exception BE restart occurred in the case of partial column updates during import, which could result in duplicate keys. <a href="https://github.com/apache/doris/pull/35678" target="_blank" rel="noopener noreferrer">#35678</a></p>
</li>
<li>
<p>Fixed the issue where BE might core dump during clone operations when memory is tight. <a href="https://github.com/apache/doris/pull/34702" target="_blank" rel="noopener noreferrer">#34702</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lakehouse-1">Lakehouse<a href="https://doris.apache.org/blog/release-note-2.1.4#lakehouse-1" class="hash-link" aria-label="Direct link to Lakehouse" title="Direct link to Lakehouse">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue where a Hive table could not be created with a fully qualified name such as <code>ctl.db.tbl</code> <a href="https://github.com/apache/doris/pull/34984" target="_blank" rel="noopener noreferrer">#34984</a></p>
</li>
<li>
<p>Fixed the issue where the Hive metastore connection did not close when refreshing <a href="https://github.com/apache/doris/pull/35426" target="_blank" rel="noopener noreferrer">#35426</a></p>
</li>
<li>
<p>Fixed a potential meta replay issue when upgrading from 2.0.x to 2.1.x. <a href="https://github.com/apache/doris/pull/35532" target="_blank" rel="noopener noreferrer">#35532</a></p>
</li>
<li>
<p>Fixed the issue where the Table Valued Function could not read an empty snappy compressed file. <a href="https://github.com/apache/doris/pull/34926" target="_blank" rel="noopener noreferrer">#34926</a></p>
</li>
<li>
<p>Fixed the issue where unable to read Parquet files with invalid min-max column statistics <a href="https://github.com/apache/doris/pull/35041" target="_blank" rel="noopener noreferrer">#35041</a></p>
</li>
<li>
<p>Fixed the issue where unable to handle pushdown predicates with null-aware functions in the Parquet/ORC reader <a href="https://github.com/apache/doris/pull/35335" target="_blank" rel="noopener noreferrer">#35335</a></p>
</li>
<li>
<p>Fixed the issue about the order of partition columns when creating a Hive table <a href="https://github.com/apache/doris/pull/35347" target="_blank" rel="noopener noreferrer">#35347</a></p>
</li>
<li>
<p>Fixed the issue where writing to a Hive table on S3 failed when partition values contained spaces <a href="https://github.com/apache/doris/pull/35645" target="_blank" rel="noopener noreferrer">#35645</a></p>
</li>
<li>
<p>Fixed the issue about incorrect scheme of Aliyun OSS endpoint <a href="https://github.com/apache/doris/pull/34907" target="_blank" rel="noopener noreferrer">#34907</a></p>
</li>
<li>
<p>Fixed the issue where the Parquet format Hive table written by Doris could not be read by Hive <a href="https://github.com/apache/doris/pull/34981" target="_blank" rel="noopener noreferrer">#34981</a></p>
</li>
<li>
<p>Fixed the issue where unable to read ORC files after the schema change of a Hive table <a href="https://github.com/apache/doris/pull/35583" target="_blank" rel="noopener noreferrer">#35583</a></p>
</li>
<li>
<p>Fixed the issue where unable to read Paimon tables via JNI after the schema change of the Paimon table <a href="https://github.com/apache/doris/pull/35309" target="_blank" rel="noopener noreferrer">#35309</a></p>
</li>
<li>
<p>Fixed the issue of too small Row Groups in Parquet format files written out. <a href="https://github.com/apache/doris/pull/36042" target="_blank" rel="noopener noreferrer">#36042</a> <a href="https://github.com/apache/doris/pull/36143" target="_blank" rel="noopener noreferrer">#36143</a></p>
</li>
<li>
<p>Fixed the issue where unable to read Paimon tables after schema changes <a href="https://github.com/apache/doris/pull/36049" target="_blank" rel="noopener noreferrer">#36049</a></p>
</li>
<li>
<p>Fixed the issue where unable to read Hive Parquet format tables after schema changes <a href="https://github.com/apache/doris/pull/36182" target="_blank" rel="noopener noreferrer">#36182</a></p>
</li>
<li>
<p>Fixed the FE OOM issue caused by Hadoop FS cache <a href="https://github.com/apache/doris/pull/36403" target="_blank" rel="noopener noreferrer">#36403</a></p>
</li>
<li>
<p>Fixed the issue where FE could not start after enabling the Hive Metastore Listener <a href="https://github.com/apache/doris/pull/36533" target="_blank" rel="noopener noreferrer">#36533</a></p>
</li>
<li>
<p>Fixed the issue of query performance degradation with a large number of files <a href="https://github.com/apache/doris/pull/36431" target="_blank" rel="noopener noreferrer">#36431</a></p>
</li>
<li>
<p>Fixed the timezone issue when reading the timestamp column type in Iceberg <a href="https://github.com/apache/doris/pull/36435" target="_blank" rel="noopener noreferrer">#36435</a></p>
</li>
<li>
<p>Fixed DATETIME conversion error and data path error on Iceberg Table. <a href="https://github.com/apache/doris/pull/35708" target="_blank" rel="noopener noreferrer">#35708</a></p>
</li>
<li>
<p>Support retain and pass the additional user-defined properties fo Table Valued Functions to the S3 SDK. <a href="https://github.com/apache/doris/pull/35515" target="_blank" rel="noopener noreferrer">#35515</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-import">Data Import<a href="https://doris.apache.org/blog/release-note-2.1.4#data-import" class="hash-link" aria-label="Direct link to Data Import" title="Direct link to Data Import">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue where <code>CANCEL LOAD</code> did not work <a href="https://github.com/apache/doris/pull/35352" target="_blank" rel="noopener noreferrer">#35352</a></p>
</li>
<li>
<p>Fixed the issue where a null pointer error in the Publish phase of load transactions prevented the load from completing <a href="https://github.com/apache/doris/pull/35977" target="_blank" rel="noopener noreferrer">#35977</a></p>
</li>
<li>
<p>Fixed the issue with bRPC serializing large data files when sent via HTTP <a href="https://github.com/apache/doris/pull/36169" target="_blank" rel="noopener noreferrer">#36169</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-management">Data Management<a href="https://doris.apache.org/blog/release-note-2.1.4#data-management" class="hash-link" aria-label="Direct link to Data Management" title="Direct link to Data Management">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the isseu that the resource tag in ConnectionContext was not set after forwarding DDL or DML to master FE. <a href="https://github.com/apache/doris/pull/35618" target="_blank" rel="noopener noreferrer">#35618</a></p>
</li>
<li>
<p>Fixed the issue where the restored table name was incorrect when <code>lower_case_table_names</code> was enabled <a href="https://github.com/apache/doris/pull/35508" target="_blank" rel="noopener noreferrer">#35508</a></p>
</li>
<li>
<p>Fixed the issue where <code>admin clean trash</code> could not work <a href="https://github.com/apache/doris/pull/35271" target="_blank" rel="noopener noreferrer">#35271</a></p>
</li>
<li>
<p>Fixed the issue where a storage policy could not be deleted from a partition <a href="https://github.com/apache/doris/pull/35874" target="_blank" rel="noopener noreferrer">#35874</a></p>
</li>
<li>
<p>Fixed the issue of data loss when importing into a multi-replica automatic partition table <a href="https://github.com/apache/doris/pull/36586" target="_blank" rel="noopener noreferrer">#36586</a></p>
</li>
<li>
<p>Fixed the issue where the partition column of a table changed when querying or inserting into an automatic partition table using the old optimizer <a href="https://github.com/apache/doris/pull/36514" target="_blank" rel="noopener noreferrer">#36514</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="memory-management">Memory Management<a href="https://doris.apache.org/blog/release-note-2.1.4#memory-management" class="hash-link" aria-label="Direct link to Memory Management" title="Direct link to Memory Management">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue of frequent errors in the logs due to failure in obtaining Cgroup meminfo. <a href="https://github.com/apache/doris/pull/35425" target="_blank" rel="noopener noreferrer">#35425</a></p>
</li>
<li>
<p>Fixed the issue where the Segment cache size was uncontrolled when using BloomFilter, leading to abnormal process memory growth. <a href="https://github.com/apache/doris/pull/34871" target="_blank" rel="noopener noreferrer">#34871</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="permissions">Permissions<a href="https://doris.apache.org/blog/release-note-2.1.4#permissions" class="hash-link" aria-label="Direct link to Permissions" title="Direct link to Permissions">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue where permission settings were ineffective after enabling case-insensitive table names. <a href="https://github.com/apache/doris/pull/36557" target="_blank" rel="noopener noreferrer">#36557</a></p>
</li>
<li>
<p>Fixed the issue where setting LDAP passwords through non-Master FE nodes did not take effect. <a href="https://github.com/apache/doris/pull/36598" target="_blank" rel="noopener noreferrer">#36598</a></p>
</li>
<li>
<p>Fixed the issue where authorization could not be checked for the <code>SELECT COUNT(*)</code> statement. <a href="https://github.com/apache/doris/pull/35465" target="_blank" rel="noopener noreferrer">#35465</a></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="others-1">Others<a href="https://doris.apache.org/blog/release-note-2.1.4#others-1" class="hash-link" aria-label="Direct link to Others" title="Direct link to Others">&#x200B;</a></h3>
<ul>
<li>
<p>Fixed the issue where the client JDBC program could not close the connection if the MySQL connection was broken. <a href="https://github.com/apache/doris/pull/36616" target="_blank" rel="noopener noreferrer">#36616</a></p>
</li>
<li>
<p>Fixed MySQL protocol compatibility issue with the <code>SHOW PROCEDURE STATUS</code> statement. <a href="https://github.com/apache/doris/pull/35350" target="_blank" rel="noopener noreferrer">#35350</a></p>
</li>
<li>
<p>The <code>libevent</code> now forces Keepalive to solve the issue of connection leaks in certain situations. <a href="https://github.com/apache/doris/pull/36088" target="_blank" rel="noopener noreferrer">#36088</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="credits">Credits<a href="https://doris.apache.org/blog/release-note-2.1.4#credits" class="hash-link" aria-label="Direct link to Credits" title="Direct link to Credits">&#x200B;</a></h2>
<p>Thanks to every one who contributes to this release.</p>
<p>@airborne12, @amorynan, @AshinGau, @BePPPower, @BiteTheDDDDt, @ByteYue, @caiconghui, @CalvinKirs, @cambyzju, @catpineapple, @cjj2010, @csun5285, @DarvenDuan, @dataroaring, @deardeng, @Doris-Extras, @eldenmoon, @englefly, @feiniaofeiafei, @felixwluo, @freemandealer, @Gabriel39, @gavinchou, @GoGoWen, @HappenLee, @hello-stephen, @hubgeter, @hust-hhb, @jacktengg, @jackwener, @jeffreys-cat, @Jibing-Li, @kaijchen, @kaka11chen, @Lchangliang, @liaoxin01, @LiBinfeng-01, @lide-reed, @luennng, @luwei16, @mongo360, @morningman, @morrySnow, @mrhhsg, @Mryange, @mymeiyi, @nextdreamblue, @platoneko, @qidaye, @qzsee, @seawinde, @shuke987, @sollhui, @starocean999, @suxiaogang223, @TangSiyang2001, @Thearas, @Vallishp, @w41ter, @wangbo, @whutpencil, @wsjz, @wuwenchi, @xiaokang, @xiedeyantu, @XieJiann, @xinyiZzz, @XuPengfei-1020, @xy720, @xzj7019, @yiguolei, @yongjinhou, @yujun777, @Yukang-Lian, @Yulei-Yang, @zclllyybb, @zddr, @zfr9527, @zgxme, @zhangbutao, @zhangstar333, @zhannngchen, @zhiqiang-hhhh, @zy-kkk, @zzzxl1993</p></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Release Notes" term="Release Notes"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Why Apache Doris is the best open source alternative to Rockset]]></title>
        <id>https://doris.apache.org/blog/apache-doris-vs-rockset</id>
        <link href="https://doris.apache.org/blog/apache-doris-vs-rockset"/>
        <updated>2024-06-24T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Among of all the claim-to-be alternatives to Rockset, Apache Doris is one of the few that cover all the key features of Rockset.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Top News</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Why Apache Doris is the best open source alternative to Rockset</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Zaki Lu</span></span><time datetime="2024-06-24T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">June 24, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>OpenAI dropped a bomb on the data world by announcing <a href="https://openai.com/index/openai-acquires-rockset/" target="_blank" rel="noopener noreferrer">the acquisition of Rockset</a>, a cloud-based, fully managed analytical database. Among all the congratulating voices, one question is raised: <strong>why <a href="https://rockset.com/" target="_blank" rel="noopener noreferrer">Rockset</a></strong>?</p>
<p><img decoding="async" loading="lazy" alt="OpenAI acquisition Rockset" src="https://cdnd.selectdb.com/assets/images/openai-twitter-rockset-629193903b8235732c88086caa39cc0c.png" width="1212" height="482" class="img_ev3q"></p>
<p>Founded in 2016 by Venkat Venkataramani, former Engineering Director at Meta, Rockset focuses on real-time search and data analytics. Compared to other DBMS, Rockset stands out by its:</p>
<ul>
<li>
<p><strong>Real-time data updates</strong>: Rockset ensures data freshness for users by its capabilities in fetching and delivering the latest data. It supports real-time updates at the granularity of data fields, which can be performed within milliseconds.</p>
</li>
<li>
<p><strong>Converged index</strong>: It reaps the benefits of inverted index, columnar storage, and row-oriented storage, and provides efficient and flexible data querying services.</p>
</li>
<li>
<p><strong>Native support for semi-structured data</strong>: Rockset is well-suited to the growing demand for semi-structured data processing, hash joins, and nested loop joins.</p>
</li>
<li>
<p><strong>SQL and JOIN compatibility</strong>: The Search Index of Rockset is optimized for various join queries.</p>
</li>
</ul>
<p>The news also gaves all Rockset users a ticking time bomb: they have to find an appropriate alternative to Rockset for their own use case within three months. This, of course, arises as an opportunity for other analytical databases on the market. However, of all the claim-to-be alternatives, only a few of them cover all the above-mentioned key features of Rockset. Among them, Apache Doris is worth looking into.</p>
<p>As an open-source real-time data warehouse, Apache Doris is trusted by over 4000 enterprise users worldwide with powerful functionalities including:</p>
<ul>
<li>
<p><strong>Real-time data updates</strong>: Apache Doris supports not only <a href="https://doris.apache.org/docs/table-design/data-model/unique" target="_blank" rel="noopener noreferrer">real-time updates</a> and deletion, but also real-time partial column updates, making it particularly useful in cases involving frequent data updates.</p>
</li>
<li>
<p><strong>Row/column hybrid storage</strong>: Apache Doris is a column-oriented data warehouse that achieves world-leading OLAP performance on <a href="https://benchmark.clickhouse.com/" target="_blank" rel="noopener noreferrer">ClickBench</a>. Additionally, it supports row-oriented storage to serve <a href="https://doris.apache.org/docs/query/high-concurrent-point-query/" target="_blank" rel="noopener noreferrer">high-concurrency point query scenarios</a>, which allows it to respond to almost a million query requests within milliseconds.</p>
</li>
<li>
<p><strong><a href="https://doris.apache.org/docs/table-design/index/inverted-index" target="_blank" rel="noopener noreferrer">Inverted index</a> and full-text searches</strong>: Apache Doris provides high efficiency and flexibility in keyword searching. It allows index creation on all fields and a flexible combination of data fields for multi-dimensional data analysis.</p>
</li>
<li>
<p><strong>Native support for semi-structured data</strong>: Apache Doris has introduced the <a href="https://doris.apache.org/docs/sql-manual/sql-types/Data-Types/VARIANT" target="_blank" rel="noopener noreferrer">VARIANT</a> data type to accommodate semi-structured data. It enables flexible data schema and high query speed on top of cost-efficient data storage. Compared to traditional JSON methods, VARIANT can bring a 10x performance improvement.</p>
</li>
<li>
<p><strong>Support for various SQL and <a href="https://doris.apache.org/docs/query/join-optimization/doris-join-optimization" target="_blank" rel="noopener noreferrer">join operations</a></strong>: Apache Doris is highly compatible with MySQL syntaxes and interfaces. It supports INNER JOIN, CROSS JOIN, and all types of OUTER JOIN. The best part is its capability of auto-optimization based on data types to guarantee optimal performance under different circumstances.</p>
</li>
</ul>
<p>As a Top-Level Project of the Apache Software Foundation, Apache Doris is supported by a robust and fast-growing community. It has accumulated over 11.8K GitHub stars and 636 contributors so far.</p>
<p>Apache Doris is the best open-source alternative to Rockset. Feel free to contact <a href="mailto:dev@doris.apache.org" target="_blank" rel="noopener noreferrer">dev@doris.apache.org</a> for more assistance.</p></div>]]></content>
        <author>
            <name>Zaki Lu</name>
        </author>
        <category label="Top News" term="Top News"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Steps to industry-leading query speed: evolution of the Apache Doris execution engine]]></title>
        <id>https://doris.apache.org/blog/evolution-of-the-apache-doris-execution-engine</id>
        <link href="https://doris.apache.org/blog/evolution-of-the-apache-doris-execution-engine"/>
        <updated>2024-06-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[From the Volcano Model to the Pipeline Execution Engine, and now PipelineX, Apache Doris brings its computation efficiency to a higher level with each iteration.]]></summary>
        <content type="html"><![CDATA[<header><div class="text-center mb-4"><a class="!text-[#8592A6] cursor-pointer hover:no-underline" href="https://doris.apache.org/blog">Blog</a><span class="px-2 text-[#8592A6]">/</span><span><span class="s-tags"><span class="s-tag">Tech Sharing</span></span></span></div><h1 class="blog-post-title text-[2rem] leading-normal lg:!text-[2.5rem] text-center" itemprop="headline">Steps to industry-leading query speed: evolution of the Apache Doris execution engine</h1><div class="blog-info text-center flex justify-center text-sm text-black"><span class="authors"><span class="s-author text-black">Apache Doris</span></span><time datetime="2024-06-18T00:00:00.000Z" itemprop="datePublished" class="text-black ml-4">June 18, 2024</time></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>What makes a modern database system? The three key modules are query optimizer, execution engine, and storage engine. Among them, the role of execution engine to the DBMS is like the chef to a restaurant. This article focuses on the execution engine of the <a href="https://doris.apache.org/" target="_blank" rel="noopener noreferrer">Apache Doris</a> data warehouse, explaining the secret to its high performance.</p>
<p>To illustrate the role of the execution engine, let&apos;s follow the execution process of an SQL statement:</p>
<ul>
<li>
<p>Upon receiving an SQL query, the query optimizer performs syntax/lexical analysis and generates the optimal execution plan based on the cost model and optimization rules.</p>
</li>
<li>
<p>The execution engine then schedules the plan to the nodes, which operate on data in the underlying storage engine and then return the query results.</p>
</li>
</ul>
<p>The execution engine performs operations like data reading, filtering, sorting, and aggregation. The efficiency of these steps determines query performance and resource utilization. That&apos;s why different execution models bring distinction in query efficiency.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="volcano-model">Volcano Model<a href="https://doris.apache.org/blog/evolution-of-the-apache-doris-execution-engine#volcano-model" class="hash-link" aria-label="Direct link to Volcano Model" title="Direct link to Volcano Model">&#x200B;</a></h2>
<p>The Volcano Model (originally known as the Iterator Model) predominates in analytical databases, followed by the Materialization Model and Vectorized Model. In a Volcano Model, each operation is abstracted as an operator, so the entire SQL query is an operator tree. During query execution, the tree is traversed top-down by calling the <code>next()</code> interface, and data is pulled and processed from the bottom up. This is called a <strong>pull-based</strong> execution model.</p>
<p>The Volcano Model is flexible, scalable, and easy to implement and optimize. It underpins Apache Doris before version 2.1.0. When a user initiates an SQL query, Doris parses the query, generates a distributed execution plan, and dispatches tasks to the nodes for execution. Each individual task is an <strong>instance</strong>. Take a simple query as an example:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">select</span><span class="token plain"> age</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> sex </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> employees </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">where</span><span class="token plain"> age </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">30</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="Volcano Model" src="https://cdnd.selectdb.com/assets/images/doris-volcano-model-bf7cd6bf0fe5c369d9ae4ac0efa617d4.png" width="1280" height="874" class="img_ev3q"></p>
<p>In an instance, data flows between operators are propelled by the <code>next()</code> method. If the <code>next()</code> method of an operator is called, it will first call the <code>next()</code> of its child operator, obtain data from it, and then process the data to produce output.</p>
<p><code>next()</code> is a synchronous method. In other words, the current operator will be blocked if its child operator does not provide data for it. In this case, the <code>next()</code> method of the root operator needs to be called in a loop until all data is processed, which is when the instance finishes its computation.</p>
<p>Such execution mechanism faces a few bottlenecks in single-node, multi-core use cases:</p>
<ul>
<li>
<p><strong>Thread blocking</strong>: In a fixed-size thread pool, if an instance occupies a thread and it is blocked, that will easily cause a deadlock when there are a large number of instances requesting execution simultaneously. This is especially the case when the current instance is dependent on other instances. Additionally, if a node is running more instances than the number of CPU cores it has, the system scheduling mechanism will be heavily relied upon and a huge context switching overhead can be produced. In a colocation scenario, this will lead to an even larger thread switching overhead.</p>
</li>
<li>
<p><strong>CPU contention</strong>: The threads might compete for CPU resources so queries of different sizes and between different tenants might interfere with each other.</p>
</li>
<li>
<p><strong>Underutilization of the multi-core computing capabilities</strong>: Execution concurrency relies heavily on data distribution. Specifically, the number of instances running on a node is limited by the number of data buckets on that node. In this case, it&apos;s important to set an appropriate number of buckets. If you shard the data into too many buckets, that will become a burden for the system and bring unnecessary overheads; if the buckets are too few, you will not be able to utilize your CPU cores to the fullest. However, in a production environment, it is not always easy to estimate the proper number of buckets you need, thus performance loss.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pipeline-execution-engine">Pipeline Execution Engine<a href="https://doris.apache.org/blog/evolution-of-the-apache-doris-execution-engine#pipeline-execution-engine" class="hash-link" aria-label="Direct link to Pipeline Execution Engine" title="Direct link to Pipeline Execution Engine">&#x200B;</a></h2>
<p>Based on the known issues of Volcano Model, we&apos;ve replaced it with the Pipeline Execution Engine since Apache Doris 2.0.0.</p>
<p>As the name suggests, the Pipeline Execution Engine breaks down the execution plan into pipeline tasks, and schedules these pipeline tasks into a thread pool in a time-sharing manner. If a pipeline task is blocked, it will be put on hold to release the thread it is occupying. Meanwhile, it supports various scheduling strategies, meaning that you can allocate CPU resources to different queries and tenants more flexibly.</p>
<p>Additionally, the Pipeline Execution Engine pools together data within data buckets, so the number of running instances is no longer capped by the number of buckets. This not only enhances Apache Doris&apos; utilization of multi-core systems, but also improves system performance and stability by avoiding frequent thread creation and deletion.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="https://doris.apache.org/blog/evolution-of-the-apache-doris-execution-engine#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">&#x200B;</a></h3>
<p>This is the execution plan of a join query. It includes two instances:</p>
<p><img decoding="async" loading="lazy" alt="Pipeline Execution Engine" src="https://cdnd.selectdb.com/assets/images/doris-pipeline-execution-engine-0f462e7876f79b16a3dd1cb21daa8444.png" width="1280" height="678" class="img_ev3q"></p>
<p>As illustrated, the Probe operation can only be executed after the hash table is built, while the Build operation is reliant on the computation results of the Exchange operator. Each of the two instances is divided into two pipeline tasks as such. Then these tasks will be scheduled in the &quot;ready&quot; queue of the thread pool. Following the specified strategies, the threads obtain the tasks to process. In a pipeline task, after one data block is finished, if the relevant data is ready and its runtime stays within the maximum allowed duration, the thread will continue to compute the next data block.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="design--implementation">Design &amp; implementation<a href="https://doris.apache.org/blog/evolution-of-the-apache-doris-execution-engine#design--implementation" class="hash-link" aria-label="Direct link to Design &amp; implementation" title="Direct link to Design &amp; implementation">&#x200B;</a></h3>
<p><strong>Avoid thread blocking</strong></p>
<p>As is mentioned earlier, the Volcano Model is faced with a few bottlenecks:</p>
<ol>
<li>
<p>If too many threads are blocked, the thread pool will be saturated and unable to respond to subsequent queries.</p>
</li>
<li>
<p>Thread scheduling is entirely managed by the operating system, without any user-level control or customization.</p>
</li>
</ol>
<p>How does Pipeline Execution Engine avoid such issues?</p>
<ol>
<li>
<p>We fix the size of the thread pool to match the CPU core count. Then we split all operators that are prone to blocking into pipeline tasks. For example, we use individual threads for disk I/O operations and RPC operations.</p>
</li>
<li>
<p>We design a user-space polling scheduler. It continuously checks the state of all executable pipeline tasks and assigns executable tasks to threads. With this in place, the operating system doesn&apos;t have to frequently switch threads, thus less overheads. It also allows customized scheduling strategies, such as assigning priorities to tasks.</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Design &amp;amp; implementation" src="https://cdnd.selectdb.com/assets/images/pipeline-design-implementation-21c2bccd9d7d386133decbf17c2040fb.png" width="1280" height="587" class="img_ev3q"></p>
<p><strong>Parallelization</strong></p>
<p>Before version 2.0, Apache Doris requires users to set a concurrency parameter for the execution engine (<code>parallel_fragment_exec_instance_num</code>), which does not dynamically change based on the workloads. Therefore, it is a burden for users to figure out an appropriate concurrency level that leads to optimal performance.</p>
<p>What&apos;s the industry&apos;s solution to this?</p>
<p>Presto&apos;s idea is to shuffle the data into a reasonable number of partitions during execution, which requires minimal concurrency control from users. On the other hand, DuckDB introduces an extra synchronization mechanism instead of shuffling. We decide to follow Presto&apos;s track of Presto because the DuckDB solution inevitably involves the use of locks, which works against our purpose of avoiding blocking.</p>
<p>Unlike Presto, Apache Doris doesn&apos;t need an extra Local Exchange mechanism to shards the data into an appropriate number of partitions. With its massively parallel processing (MPP) architecture, Doris already does so during shuffling. (In Presto&apos;s case, it re-partitions the data via Local Exchange for higher execution concurrency. For example, in hash aggregation, Doris further shards the data based on the aggregation key in order to fully utilize the CPU cores. Also, this can downsize the hash table that each execution thread has to build.)</p>
<p><img decoding="async" loading="lazy" alt="Design &amp;amp; implementation" src="https://cdnd.selectdb.com/assets/images/pipeline-design-implementation-2-a687d57ca081c1170f31ab0145d5caff.png" width="1280" height="686" class="img_ev3q"></p>
<p>Based on the MPP architecture, we only need two improvements before we achieve what we want in Doris:</p>
<ul>
<li>
<p><strong>Increase the concurrency level during shuffling</strong>. For this, we only need to have the frontend (FE) perceive the backend (BE) environment and then set a reasonable number of partitions.</p>
</li>
<li>
<p><strong>Implement concurrent execution after data reading by the scan layer</strong>. To do this, we need a logical restructuring of the scan layer to decouple the threads from the number of data tablets. This is a pooling process. We pool the data read by scanner threads, so it can be fetched by multiple pipeline tasks directly.</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Design &amp;amp; implementation" src="https://cdnd.selectdb.com/assets/images/pipleine-design-implementation-3-fbbbb04f5de750bad1fd28694ca3b1d7.jpeg" width="1280" height="670" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pipelinex">PipelineX<a href="https://doris.apache.org/blog/evolution-of-the-apache-doris-execution-engine#pipelinex" class="hash-link" aria-label="Direct link to PipelineX" title="Direct link to PipelineX">&#x200B;</a></h2>
<p>Introduced in Apache Doris 2.0.0, the pipeline execution engine has been improving query performance and stability under hybrid workload scenarios (queries of different sizes and from different tenants). In <a href="https://doris.apache.org/blog/release-note-2.1.0" target="_blank" rel="noopener noreferrer">version 2.1.0</a>, we&apos;ve tackled the known issues and upgraded this from an experimental feature to a robust and reliable solution, which is what we call <a href="https://doris.apache.org/docs/query/pipeline/pipeline-x-execution-engine" target="_blank" rel="noopener noreferrer">PipelineX</a>.</p>
<p>PipelineX has provided answers to the following issues that used to challenge the Pipeline Execution Engine:</p>
<ul>
<li>
<p><strong>Limited execution concurrency</strong></p>
</li>
<li>
<p><strong>High execution overhead</strong></p>
</li>
<li>
<p><strong>High scheduling overhead</strong></p>
</li>
<li>
<p><strong>Poor readability of operator profile</strong></p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="execution-concurrency">Execution concurrency<a href="https://doris.apache.org/blog/evolution-of-the-apache-doris-execution-engine#execution-concurrency" class="hash-link" aria-label="Direct link to Execution concurrency" title="Direct link to Execution concurrency">&#x200B;</a></h3>
<p>The Pipeline Execution Engine remains under the restriction of the static concurrency parameter at FE and the tablet count at the storage layer, making itself unable to capitalize on the full computing resources. Plus, it is easily affected by data skew.</p>
<p>For example, suppose that Table A contains 100 million rows but it has only 1 tablet, which means it is not sharded enough, let&apos;s see what can happen when you perform an aggregation query on it:</p>
<div class="language-C++ language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> SELECT COUNT(*) FROM A GROUP BY A.COL_1;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
<p>During query execution, the query plan is divided into two <strong>fragments</strong>. Each fragment, consisting of multiple operators, is dispatched by frontend (FE) to backend (BE). The BE starts threads to execute the fragments concurrently.</p>
<p><img decoding="async" loading="lazy" alt="Pipeline Execution concurrency" src="https://cdnd.selectdb.com/assets/images/doris-pipelinex-4e2f29eb887b9b2dc157ab32aea356b4.png" width="1280" height="707" class="img_ev3q"></p>
<p>Now, let&apos;s focus on Fragment 0 for further elaboration. Because there is only one tablet, Fragment 0 can only be executed by one thread. That means aggregation of 100 million rows by one single thread. If you have 16 CPU cores, ideally, the system can allocate 8 threads to execute Fragment 0. In this case, there is a concurrency disparity of 8 to 1. This is how <strong>the number of tablets restricts execution concurrency</strong> and also why we introduce the idea of <strong>Local Shuffle mechanism to remove that restriction</strong> in Apache Doris 2.1.0. So this is how it works in PipelineX:</p>
<ul>
<li>
<p>The threads execute their own pipeline tasks, but the pipeline tasks only maintain their runtime state (known as <strong>Local State</strong>), while the information that shared across all pipeline tasks (known as <strong>Global State</strong>) is managed by one pipeline object.</p>
</li>
<li>
<p>On a single BE, the Local Shuffle mechanism is responsible for data distribution and data balancing across pipeline tasks.</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Pipeline Execution concurrency" src="https://cdnd.selectdb.com/assets/images/doris-pipelinex-1-6f7365d5417f254f369c691827d034eb.png" width="1220" height="1280" class="img_ev3q"></p>
<p>Apart from decoupling execution concurrency from tablet count, Local Shuffle can avoid performance loss due to data skew. Again, we will explain with the foregoing example.</p>
<p>This time, we shard Table A into two tablets instead of one, but the data is not evenly distributed. Tablet 1 and Tablet 3 hold 10 million and 90 million rows, respectively. The Pipeline Execution Engine and PipelineX Execution Engine respond differently to such data skew:</p>
<ul>
<li>
<p><strong>Pipeline Execution Engine</strong>: Thread 1 and Thread 2 executes Fragment 1 concurrently. The latter takes 9 times as long as Thread 1 because of the different data sizes they deal with.</p>
</li>
<li>
<p><strong>PipelineX Execution Engine</strong>: With Local Shuffle, data is distributed evenly to the two threads, so they take almost equal time to finish.</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Pipeline vs PipelineX execution engine" src="https://cdnd.selectdb.com/assets/images/doris-pipelinex-3-4be6cbf01667eb21a88ce0914e3a404a.png" width="1280" height="972" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="execution-overhead">Execution overhead<a href="https://doris.apache.org/blog/evolution-of-the-apache-doris-execution-engine#execution-overhead" class="hash-link" aria-label="Direct link to Execution overhead" title="Direct link to Execution overhead">&#x200B;</a></h3>
<p>Under the Pipeline Execution Engine, because the expressions of different instances are individual, each instance is initialized individually. However, since the initialization parameters of instances share a lot in common, we can reuse the shared states to reduce execution overheads. This is what PipelineX does: it initializes the Global State at a time, and the Local State sequentially.</p>
<p><img decoding="async" loading="lazy" alt="Execution overhead" src="https://cdnd.selectdb.com/assets/images/pipeline-execution-overhead-f3d56f790b260c95154e1039faf202d9.png" width="1280" height="625" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scheduling-overhead">Scheduling overhead<a href="https://doris.apache.org/blog/evolution-of-the-apache-doris-execution-engine#scheduling-overhead" class="hash-link" aria-label="Direct link to Scheduling overhead" title="Direct link to Scheduling overhead">&#x200B;</a></h3>
<p>In the Pipeline Execution Engine, the blocked tasks are put into a blocked queue, where a dedicated thread takes polls and moves the executable tasks over to the runnable queue. This dedicated scheduling thread consumes a CPU core, and incurs overheads that can be particularly noticeable on systems with limited computing resources.</p>
<p><strong>As a better solution, PipelineX encapsulates the blocking conditions as dependencies, and the task status (blocked or runnable) will be triggered to change by event notifications.</strong> Specifically, when RPC data arrives, the relevant task will be considered as ready by the ExchangeSourceOperator and then moved to the runnable queue.</p>
<p><img decoding="async" loading="lazy" alt="Scheduling overhead" src="https://cdnd.selectdb.com/assets/images/pipeline-scheduling-overhead-8fc879065b8ec7b550448f12d8cbad7d.png" width="1280" height="740" class="img_ev3q"></p>
<p>That means <strong>PipelineX implements event-driven scheduling</strong>. A query execution plan can be depicted as a DAG, where the pipeline tasks are abstracted as nodes and the dependencies as edges. Whether a pipeline task gets executed depends on whether all its associated dependencies have satisfied the requisite conditions.</p>
<p><img decoding="async" loading="lazy" alt="Scheduling overhead" src="https://cdnd.selectdb.com/assets/images/pipeline-scheduling-overhead-2-2141c79fe8435bc10d6f4e933e009ef4.jpeg" width="1280" height="723" class="img_ev3q"></p>
<p>For simplicity of illustration, the above DAG only shows the dependencies between the upstream and downstream pipeline tasks. In fact, all blocking conditions are abstracted as dependencies. The complete execution workflow of a pipeline task is as follows:</p>
<p><img decoding="async" loading="lazy" alt="Scheduling overhead" src="https://cdnd.selectdb.com/assets/images/pipeline-scheduling-overhead-3-7a77f777afc96de866410fd9624ce605.png" width="1280" height="629" class="img_ev3q"></p>
<p>In event-driven execution, a pipeline task will only be executed after all its dependencies satisfy the conditions; otherwise, it will be added to the blocked queue. When an external event arrives, all blocked tasks will be re-evaluated to see if they&apos;re runnable.</p>
<p>The event-driven design of PipelineX eliminates the need for a polling thread and thus the consequential performance loss under high cluster loads. Moreover, the encapsulation of dependencies enables a more flexible scheduling framework, making it easier to spill data to disks.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="operator-profile">Operator profile<a href="https://doris.apache.org/blog/evolution-of-the-apache-doris-execution-engine#operator-profile" class="hash-link" aria-label="Direct link to Operator profile" title="Direct link to Operator profile">&#x200B;</a></h3>
<p>PipelineX has reorganized the metrics in the operator profiles, adding new ones and obsoleting irrelevant ones. Besides, with the dependencies encapsulated, we monitor how long the dependencies take to get ready by the metric <code>WaitForDependency</code>, so the profile can provide a clear picture of the time spent in each step. These are two examples:</p>
<ul>
<li>
<p><strong>Scan Operator</strong>: The total execution time of <code>OLAP_SCAN_OPERATOR</code> is 457.750ms, including that spent in data reading by the scanner (436.883ms) and that in actual execution.</p>
<div class="language-C++ language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">OLAP_SCAN_OPERATOR  (id=4.  table  name  =  Z03_DI_MID):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -  ExecTime:  457.750ms</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -  WaitForDependency[OLAP_SCAN_OPERATOR_DEPENDENCY]Time:  436.883ms</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Exchange Source Operator</strong>: The execution time of <code>EXCHANGE_OPERATOR</code> is 86.691us. The time spent waiting for data from upstream is 409.256us.</p>
<div class="language-C++ language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">EXCHANGE_OPERATOR  (id=3):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -  ExecTime:  86.691us</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -  WaitForDependencyTime:  0ns</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        -  WaitForData0:  409.256us</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"/></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/></svg></span></button></div></div></div>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">What&apos;s next<a href="https://doris.apache.org/blog/evolution-of-the-apache-doris-execution-engine#whats-next" class="hash-link" aria-label="Direct link to What&apos;s next" title="Direct link to What&apos;s next">&#x200B;</a></h2>
<p>From the Volcano Model to the Pipeline Execution Engine, Apache Doris 2.0.0 has overcome the deadlocks under high cluster load and greatly increased CPU utilization. Now, from the Pipeline Execution Engine to PipelineX, Apache Doris 2.1.0 is more production-friendly as it has ironed out the kinks in concurrency, overheads, and operator profile.</p>
<p>What&apos;s next in our roadmap is to support spilling data to disk in PipelineX to further improve query speed and system reliability. We also plan to advance further in terms of automation, such as self-adaptive concurrency and auto execution plan optimization, accompanied by NUMA technologies to harvest better performance from hardware resources.</p>
<p>If you want to talk to the amazing Doris developers who lead these changes, you are more than welcome to join the <a href="https://join.slack.com/t/apachedoriscommunity/shared_invite/zt-2gmq5o30h-455W226d79zP3L96ZhXIoQ" target="_blank" rel="noopener noreferrer">Apache Doris</a> community.</p></div>]]></content>
        <author>
            <name>Apache Doris</name>
        </author>
        <category label="Tech Sharing" term="Tech Sharing"/>
    </entry>
</feed>