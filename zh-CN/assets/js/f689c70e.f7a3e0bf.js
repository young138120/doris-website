"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["887459"],{634115:function(n,e,l){l.r(e),l.d(e,{metadata:()=>i,contentTitle:()=>t,default:()=>h,assets:()=>c,toc:()=>o,frontMatter:()=>d});var i=JSON.parse('{"id":"query-acceleration/materialized-view/async-materialized-view/functions-and-demands","title":"\u529F\u80FD\u63CF\u8FF0","description":"\x3c!--","source":"@site/i18n/zh-CN/docusaurus-plugin-content-docs/current/query-acceleration/materialized-view/async-materialized-view/functions-and-demands.md","sourceDirName":"query-acceleration/materialized-view/async-materialized-view","slug":"/query-acceleration/materialized-view/async-materialized-view/functions-and-demands","permalink":"/zh-CN/docs/dev/query-acceleration/materialized-view/async-materialized-view/functions-and-demands","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\u529F\u80FD\u63CF\u8FF0","language":"zh-CN"},"sidebar":"docs","previous":{"title":"\u539F\u7406\u4ECB\u7ECD","permalink":"/zh-CN/docs/dev/query-acceleration/materialized-view/async-materialized-view/overview"},"next":{"title":"\u4F7F\u7528\u4E0E\u5B9E\u8DF5","permalink":"/zh-CN/docs/dev/query-acceleration/materialized-view/async-materialized-view/use-guide"}}'),r=l("785893"),s=l("250065");let d={title:"\u529F\u80FD\u63CF\u8FF0",language:"zh-CN"},t=void 0,c={},o=[{value:"DDL \u548C\u57FA\u7840\u8FD0\u7EF4",id:"ddl-\u548C\u57FA\u7840\u8FD0\u7EF4",level:2},{value:"\u7269\u5316\u89C6\u56FE\u521B\u5EFA",id:"\u7269\u5316\u89C6\u56FE\u521B\u5EFA",level:3},{value:"\u7269\u5316\u89C6\u56FE\u4FEE\u6539",id:"\u7269\u5316\u89C6\u56FE\u4FEE\u6539",level:3},{value:"\u7269\u5316\u89C6\u56FE\u5220\u9664",id:"\u7269\u5316\u89C6\u56FE\u5220\u9664",level:3},{value:"\u5237\u65B0\u7269\u5316\u89C6\u56FE",id:"\u5237\u65B0\u7269\u5316\u89C6\u56FE",level:3},{value:"\u6682\u505C\u7269\u5316\u89C6\u56FE",id:"\u6682\u505C\u7269\u5316\u89C6\u56FE",level:3},{value:"\u542F\u7528\u7269\u5316\u89C6\u56FE",id:"\u542F\u7528\u7269\u5316\u89C6\u56FE",level:3},{value:"\u53D6\u6D88\u7269\u5316\u89C6\u56FE\u5237\u65B0\u4EFB\u52A1",id:"\u53D6\u6D88\u7269\u5316\u89C6\u56FE\u5237\u65B0\u4EFB\u52A1",level:3},{value:"\u5143\u6570\u636E\u67E5\u8BE2",id:"\u5143\u6570\u636E\u67E5\u8BE2",level:2},{value:"\u6743\u9650\u8BF4\u660E",id:"\u6743\u9650\u8BF4\u660E",level:2},{value:"\u7269\u5316\u5237\u65B0\u6570\u636E\u6E56\u652F\u6301\u60C5\u51B5",id:"\u7269\u5316\u5237\u65B0\u6570\u636E\u6E56\u652F\u6301\u60C5\u51B5",level:2},{value:"\u7269\u5316\u89C6\u56FE\u548C OLAP \u5185\u8868\u5173\u7CFB",id:"\u7269\u5316\u89C6\u56FE\u548C-olap-\u5185\u8868\u5173\u7CFB",level:2},{value:"\u76F4\u67E5",id:"\u76F4\u67E5",level:2},{value:"\u67E5\u8BE2\u6539\u5199\u7684\u80FD\u529B\u8FB9\u754C",id:"\u67E5\u8BE2\u6539\u5199\u7684\u80FD\u529B\u8FB9\u754C",level:2},{value:"\u6761\u4EF6\u8865\u507F",id:"\u6761\u4EF6\u8865\u507F",level:3},{value:"JOIN \u6539\u5199",id:"join-\u6539\u5199",level:3},{value:"JOIN \u884D\u751F",id:"join-\u884D\u751F",level:3},{value:"\u805A\u5408\u6539\u5199",id:"\u805A\u5408\u6539\u5199",level:3},{value:"\u805A\u5408\u6539\u5199\uFF08\u4E0A\u5377\uFF09",id:"\u805A\u5408\u6539\u5199\u4E0A\u5377",level:3},{value:"\u591A\u7EF4\u805A\u5408\u6539\u5199",id:"\u591A\u7EF4\u805A\u5408\u6539\u5199",level:3},{value:"\u5206\u533A\u8865\u507F\u6539\u5199",id:"\u5206\u533A\u8865\u507F\u6539\u5199",level:3},{value:"\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u6539\u5199",id:"\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u6539\u5199",level:3},{value:"Explain \u67E5\u8BE2\u900F\u660E\u6539\u5199\u60C5\u51B5",id:"explain-\u67E5\u8BE2\u900F\u660E\u6539\u5199\u60C5\u51B5",level:2},{value:"\u9644\u5F55",id:"\u9644\u5F55",level:2},{value:"\u7269\u5316\u89C6\u56FE\u76F8\u5173\u5F00\u5173\u4ECB\u7ECD",id:"\u7269\u5316\u89C6\u56FE\u76F8\u5173\u5F00\u5173\u4ECB\u7ECD",level:3}];function a(n){let e={a:"a",admonition:"admonition",code:"code",div:"div",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.p,{children:"\u672C\u6587\u5C06\u8BE6\u7EC6\u8BF4\u660E\u7269\u5316\u89C6\u56FE DDL \u548C\u57FA\u7840\u8FD0\u7EF4\u3001\u5143\u6570\u636E\u67E5\u8BE2\u3001\u6743\u9650\u8BF4\u660E\u3001\u7269\u5316\u5237\u65B0\u6570\u636E\u6E56\u652F\u6301\u60C5\u51B5\u3001\u4E0E OLAP \u5185\u8868\u5173\u7CFB\u3001\u76F4\u67E5\u3001\u67E5\u8BE2\u6539\u5199\u7B49\u529F\u80FD\u4EE5\u53CA\u57FA\u7840\u547D\u4EE4\u3002"}),"\n",(0,r.jsx)(e.h2,{id:"ddl-\u548C\u57FA\u7840\u8FD0\u7EF4",children:"DDL \u548C\u57FA\u7840\u8FD0\u7EF4"}),"\n",(0,r.jsx)(e.h3,{id:"\u7269\u5316\u89C6\u56FE\u521B\u5EFA",children:"\u7269\u5316\u89C6\u56FE\u521B\u5EFA"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"1. \u8BE6\u60C5\u53C2\u8003"})," ",(0,r.jsx)(e.strong,{children:(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-statements/Data-Definition-Statements/Create/CREATE-ASYNC-MATERIALIZED-VIEW",children:"CREATE ASYNC MATERIALIZED VIEW"})})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"2. \u65B0\u589E\u5C5E\u6027"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"use_for_rewrite\uFF1A\uFF1A\u6807\u8BC6\u6B64\u7269\u5316\u89C6\u56FE\u662F\u5426\u53C2\u4E0E\u5230\u900F\u660E\u6539\u5199\u4E2D\uFF0C\u5982\u679C\u4E3A false\uFF0C\u4E0D\u53C2\u4E0E\u5230\u900F\u660E\u6539\u5199\uFF0C\u9ED8\u8BA4\u662F true\u3002\u6570\u636E\u5EFA\u6A21\u573A\u666F\u4E2D\uFF0C\u5982\u679C\u7269\u5316\u89C6\u56FE\u53EA\u662F\u7528\u4E8E\u76F4\u67E5\uFF0C\u7269\u5316\u89C6\u56FE\u53EF\u4EE5\u8BBE\u7F6E\u6B64\u5C5E\u6027\uFF0C\u4ECE\u800C\u4E0D\u53C2\u4E0E\u900F\u660E\u6539\u5199\uFF0C\u63D0\u9AD8\u67E5\u8BE2\u54CD\u5E94\u901F\u5EA6\u3002"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"3. \u5206\u533A\u7269\u5316\u89C6\u56FE"})}),"\n",(0,r.jsxs)(e.p,{children:["\u521B\u5EFA\u5206\u533A\u7269\u5316\u89C6\u56FE\u65F6\uFF0C\u5BF9\u4E8E\u5206\u533A\u5B57\u6BB5\u5F15\u7528\u7684\u8868\u8FBE\u5F0F\uFF0C\u4EC5\u5141\u8BB8\u4F7F\u7528 ",(0,r.jsx)(e.code,{children:"date_trunc"})," \u51FD\u6570\u548C\u5E38\u91CF\u3002\u4EE5\u4E0B\u8BED\u53E5\u662F\u7B26\u5408\u8981\u6C42\u7684\uFF1A"]}),"\n",(0,r.jsxs)(e.p,{children:["\u5206\u533A\u5B57\u6BB5\u5F15\u7528\u7684\u5217\u4EC5\u4F7F\u7528\u4E86 ",(0,r.jsx)(e.code,{children:"date_trunc"})," \u51FD\u6570\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv_1 BUILD IMMEDIATE REFRESH AUTO ON MANUAL   \npartition by (date_alias)   \nDISTRIBUTED BY RANDOM BUCKETS 2   \nPROPERTIES ('replication_num' = '1')   \nAS   \nSELECT   \n  l_linestatus,   \n  date_trunc(o_orderdate) as date_alias,   \n  o_shippriority   \nFROM   \n  orders   \n  LEFT JOIN lineitem ON l_orderkey = o_orderkey;\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u4EE5\u4E0B\u793A\u4F8B\u5219\u65E0\u6CD5\u521B\u5EFA\u5206\u533A\u7269\u5316\u89C6\u56FE\uFF0C\u56E0\u4E3A\u5206\u533A\u5B57\u6BB5\u5F15\u7528\u7684\u8868\u8FBE\u5F0F\u4F7F\u7528\u4E86 ",(0,r.jsx)(e.code,{children:"to_date"})," \u51FD\u6570\uFF1A"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv_1 BUILD IMMEDIATE REFRESH AUTO ON MANUAL   \npartition by (date_alias)   \nDISTRIBUTED BY RANDOM BUCKETS 2   \nPROPERTIES ('replication_num' = '1')   \nAS   \nSELECT   \n  l_linestatus,   \n  to_date(o_orderdate) as date_alias,   \n  o_shippriority   \nFROM   \n  orders   \n  LEFT JOIN lineitem ON l_orderkey = o_orderkey;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u7269\u5316\u89C6\u56FE\u4FEE\u6539",children:"\u7269\u5316\u89C6\u56FE\u4FEE\u6539"}),"\n",(0,r.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-statements/Data-Definition-Statements/Alter/ALTER-ASYNC-MATERIALIZED-VIEW",children:"ALTER ASYNC MATERIALIZED VIEW"})]}),"\n",(0,r.jsx)(e.h3,{id:"\u7269\u5316\u89C6\u56FE\u5220\u9664",children:"\u7269\u5316\u89C6\u56FE\u5220\u9664"}),"\n",(0,r.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-statements/Data-Definition-Statements/Drop/DROP-ASYNC-MATERIALIZED-VIEW",children:"DROP ASYNC MATERIALIZED VIEW"})]}),"\n",(0,r.jsx)(e.h3,{id:"\u5237\u65B0\u7269\u5316\u89C6\u56FE",children:"\u5237\u65B0\u7269\u5316\u89C6\u56FE"}),"\n",(0,r.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-statements/Utility-Statements/REFRESH-MATERIALIZED-VIEW/",children:"REFRESH MATERIALIZED VIEW"})]}),"\n",(0,r.jsx)(e.h3,{id:"\u6682\u505C\u7269\u5316\u89C6\u56FE",children:"\u6682\u505C\u7269\u5316\u89C6\u56FE"}),"\n",(0,r.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-statements/Utility-Statements/PAUSE-MATERIALIZED-VIEW",children:"PAUSE MATERIALIZED VIEW"})]}),"\n",(0,r.jsx)(e.h3,{id:"\u542F\u7528\u7269\u5316\u89C6\u56FE",children:"\u542F\u7528\u7269\u5316\u89C6\u56FE"}),"\n",(0,r.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-statements/Utility-Statements/RESUME-MATERIALIZED-VIEW",children:"RESUME MATERIALIZED VIEW"})]}),"\n",(0,r.jsx)(e.h3,{id:"\u53D6\u6D88\u7269\u5316\u89C6\u56FE\u5237\u65B0\u4EFB\u52A1",children:"\u53D6\u6D88\u7269\u5316\u89C6\u56FE\u5237\u65B0\u4EFB\u52A1"}),"\n",(0,r.jsxs)(e.p,{children:["\u8BE6\u60C5\u53C2\u8003 ",(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-statements/Utility-Statements/CANCEL-MATERIALIZED-VIEW-TASK",children:"CANCEL MATERIALIZED VIEW TASK"})]}),"\n",(0,r.jsx)(e.h2,{id:"\u5143\u6570\u636E\u67E5\u8BE2",children:"\u5143\u6570\u636E\u67E5\u8BE2"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u4FE1\u606F\uFF1A",(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-functions/table-valued-functions/mv-infos",children:"MV_INFOS"})]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["\u67E5\u8BE2 TASK \u4FE1\u606F\uFF1A",(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-functions/table-valued-functions/tasks?_highlight=task",children:"TASKS"})]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u5BF9\u5E94\u7684 JOB \u4FE1\u606F\uFF1A",(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-functions/table-valued-functions/jobs",children:"JOBS"})]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["\u67E5\u8BE2\u7269\u5316\u89C6\u56FE\u7684\u5206\u533A\u4FE1\u606F\uFF1A",(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-statements/Show-Statements/SHOW-PARTITIONS",children:"SHOW PARTITIONS"})]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["\u67E5\u770B\u7269\u5316\u89C6\u56FE\u8868\u7ED3\u6784\uFF1A",(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-statements/Utility-Statements/DESCRIBE",children:"DESCRIBE"})]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["\u67E5\u770B\u7269\u5316\u89C6\u56FE\u521B\u5EFA\u8BED\u53E5\uFF1A",(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-statements/Show-Statements/SHOW-CREATE-MATERIALIZED-VIEW/",children:"SHOW CREATE MATERIALIZED VIEW"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u6743\u9650\u8BF4\u660E",children:"\u6743\u9650\u8BF4\u660E"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u521B\u5EFA\u7269\u5316\u89C6\u56FE\uFF1A\u9700\u8981\u5177\u6709\u6709\u7269\u5316\u89C6\u56FE\u7684\u521B\u5EFA\u6743\u9650\uFF08\u4E0E\u5EFA\u8868\u6743\u9650\u76F8\u540C\uFF09\u4EE5\u53CA\u521B\u5EFA\u7269\u5316\u89C6\u56FE\u67E5\u8BE2\u8BED\u53E5\u7684\u67E5\u8BE2\u6743\u9650\uFF08\u4E0E SELECT \u6743\u9650\u76F8\u540C\uFF09\u3002"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u5220\u9664\u7269\u5316\u89C6\u56FE\uFF1A\u9700\u8981\u5177\u6709\u7269\u5316\u89C6\u56FE\u7684\u5220\u9664\u6743\u9650\uFF08\u4E0E\u5220\u9664\u8868\u6743\u9650\u76F8\u540C\uFF09\u3002"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u4FEE\u6539\u7269\u5316\u89C6\u56FE\uFF1A\u9700\u8981\u5177\u6709\u7269\u5316\u89C6\u56FE\u7684\u4FEE\u6539\u6743\u9650\uFF08\u4E0E\u4FEE\u6539\u8868\u6743\u9650\u76F8\u540C\uFF09\u3002"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u6682\u505C/\u6062\u590D/\u53D6\u6D88/\u5237\u65B0\u7269\u5316\u89C6\u56FE\uFF1A\u9700\u8981\u5177\u6709\u7269\u5316\u89C6\u56FE\u7684\u521B\u5EFA\u6743\u9650\u3002"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u7269\u5316\u5237\u65B0\u6570\u636E\u6E56\u652F\u6301\u60C5\u51B5",children:"\u7269\u5316\u5237\u65B0\u6570\u636E\u6E56\u652F\u6301\u60C5\u51B5"}),"\n",(0,r.jsx)(e.p,{children:"\u5BF9\u4E8E\u7269\u5316\u5237\u65B0\u6570\u636E\u6E56\u7684\u652F\u6301\u60C5\u51B5\uFF0C\u4E0D\u540C\u7C7B\u578B\u7684\u8868\u548C Catalog \u6709\u4E0D\u540C\u7684\u652F\u6301\u7A0B\u5EA6\uFF1A"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u8868\u7C7B\u578B"}),(0,r.jsx)(e.th,{children:"Catalog \u7C7B\u578B"}),(0,r.jsx)(e.th,{children:"\u5168\u91CF\u5237\u65B0"}),(0,r.jsx)(e.th,{children:"\u5206\u533A\u5237\u65B0"}),(0,r.jsx)(e.th,{children:"\u89E6\u53D1\u5237\u65B0"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u5185\u8868"}),(0,r.jsx)(e.td,{children:"Internal"}),(0,r.jsx)(e.td,{children:"2.1 \u652F\u6301"}),(0,r.jsx)(e.td,{children:"2.1 \u652F\u6301"}),(0,r.jsx)(e.td,{children:"2.1.4 \u652F\u6301"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u5916\u8868"}),(0,r.jsx)(e.td,{children:"Hive"}),(0,r.jsx)(e.td,{children:"2.1 \u652F\u6301"}),(0,r.jsx)(e.td,{children:"2.1 \u652F\u6301"}),(0,r.jsx)(e.td,{children:"\u4E0D\u652F\u6301"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Iceberg"}),(0,r.jsx)(e.td,{children:"\u652F\u6301"}),(0,r.jsx)(e.td,{children:"\u4E0D\u652F\u6301"}),(0,r.jsx)(e.td,{children:"\u4E0D\u652F\u6301"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Paimon"}),(0,r.jsx)(e.td,{children:"\u652F\u6301"}),(0,r.jsx)(e.td,{children:"\u4E0D\u652F\u6301"}),(0,r.jsx)(e.td,{children:"\u4E0D\u652F\u6301"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Hudi"}),(0,r.jsx)(e.td,{children:"\u652F\u6301"}),(0,r.jsx)(e.td,{children:"\u4E0D\u652F\u6301"}),(0,r.jsx)(e.td,{children:"\u4E0D\u652F\u6301"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"JDBC"}),(0,r.jsx)(e.td,{children:"\u652F\u6301"}),(0,r.jsx)(e.td,{children:"\u4E0D\u652F\u6301"}),(0,r.jsx)(e.td,{children:"\u4E0D\u652F\u6301"}),(0,r.jsx)(e.td,{})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"ES"}),(0,r.jsx)(e.td,{children:"\u652F\u6301"}),(0,r.jsx)(e.td,{children:"\u4E0D\u652F\u6301"}),(0,r.jsx)(e.td,{children:"\u4E0D\u652F\u6301"}),(0,r.jsx)(e.td,{})]})]})]}),"\n",(0,r.jsx)(e.h2,{id:"\u7269\u5316\u89C6\u56FE\u548C-olap-\u5185\u8868\u5173\u7CFB",children:"\u7269\u5316\u89C6\u56FE\u548C OLAP \u5185\u8868\u5173\u7CFB"}),"\n",(0,r.jsx)(e.div,{children:(0,r.jsx)(e.p,{children:"\u81EA 2.1.4 \u7248\u672C\u8D77\uFF0C\u7269\u5316\u89C6\u56FE\u652F\u6301 Duplicate \u6A21\u578B"})}),"\n",(0,r.jsx)(e.p,{children:"\u7269\u5316\u89C6\u56FE\u7684\u5E95\u5C42\u5B9E\u73B0\u662F\u4E00\u4E2A Duplicate \u6A21\u578B\u7684 OLAP \u8868\u3002\u8FD9\u610F\u5473\u7740\uFF0C\u7406\u8BBA\u4E0A\u7269\u5316\u89C6\u56FE\u652F\u6301 Duplicate \u6A21\u578B\u7684\u6240\u6709\u529F\u80FD\u3002\u7136\u800C\uFF0C\u4E3A\u4E86\u786E\u4FDD\u7269\u5316\u89C6\u56FE\u80FD\u591F\u6B63\u5E38\u4E14\u9AD8\u6548\u5730\u5237\u65B0\u6570\u636E\uFF0C\u5BF9\u5176\u529F\u80FD\u8FDB\u884C\u4E86\u4E00\u4E9B\u9650\u5236\uFF1A"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u7269\u5316\u89C6\u56FE\u7684\u5206\u533A\u662F\u57FA\u4E8E\u5176\u57FA\u8868\u81EA\u52A8\u521B\u5EFA\u548C\u7EF4\u62A4\u7684\uFF0C\u56E0\u6B64\u7528\u6237\u4E0D\u80FD\u5BF9\u7269\u5316\u89C6\u56FE\u8FDB\u884C\u5206\u533A\u64CD\u4F5C\u3002"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u7531\u4E8E\u7269\u5316\u89C6\u56FE\u80CC\u540E\u6709\u76F8\u5173\u7684\u4F5C\u4E1A\uFF08JOB\uFF09\u9700\u8981\u5904\u7406\uFF0C\u6240\u4EE5\u4E0D\u80FD\u4F7F\u7528\u5220\u9664\u8868\uFF08DELETE TABLE\uFF09\u6216\u91CD\u547D\u540D\u8868\uFF08RENAME TABLE\uFF09\u7684\u547D\u4EE4\u6765\u64CD\u4F5C\u7269\u5316\u89C6\u56FE\u3002\u76F8\u53CD\uFF0C\u9700\u8981\u4F7F\u7528\u7269\u5316\u89C6\u56FE\u81EA\u8EAB\u7684\u547D\u4EE4\u6765\u8FDB\u884C\u8FD9\u4E9B\u64CD\u4F5C\u3002"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u7269\u5316\u89C6\u56FE\u7684\u5217\u6570\u636E\u7C7B\u578B\u662F\u6839\u636E\u67E5\u8BE2\u8BED\u53E5\u63A8\u5BFC\u51FA\u6765\u7684\uFF0C\u56E0\u6B64\u8FD9\u4E9B\u6570\u636E\u7C7B\u578B\u4E0D\u80FD\u88AB\u4FEE\u6539\u3002\u5426\u5219\uFF0C\u53EF\u80FD\u4F1A\u5BFC\u81F4\u7269\u5316\u89C6\u56FE\u7684\u5237\u65B0\u4EFB\u52A1\u5931\u8D25\u3002"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u7269\u5316\u89C6\u56FE\u5177\u6709\u4E00\u4E9B Duplicate \u8868\u6CA1\u6709\u7684\u5C5E\u6027\uFF08property\uFF09\uFF0C\u8FD9\u4E9B\u5C5E\u6027\u9700\u8981\u901A\u8FC7\u7269\u5316\u89C6\u56FE\u7684\u547D\u4EE4\u8FDB\u884C\u4FEE\u6539\u3002\u800C\u5176\u4ED6\u516C\u7528\u7684\u5C5E\u6027\u5219\u9700\u8981\u4F7F\u7528 ALTER TABLE \u547D\u4EE4\u8FDB\u884C\u4FEE\u6539\u3002"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"DESC\u3001SHOW PARTITIONS \u7B49\u547D\u4EE4\u540C\u6837\u9002\u7528\u4E8E\u7269\u5316\u89C6\u56FE\uFF0C\u53EF\u4EE5\u7528\u4E8E\u67E5\u770B\u7269\u5316\u89C6\u56FE\u7684\u63CF\u8FF0\u4FE1\u606F\u548C\u5206\u533A\u4FE1\u606F\u3002"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u7269\u5316\u89C6\u56FE\u652F\u6301\u521B\u5EFA\u7D22\u5F15\u3002"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u7528\u6237\u53EF\u4EE5\u57FA\u4E8E\u4E00\u4E2A\u7269\u5316\u89C6\u56FE\u521B\u5EFA\u540C\u6B65\u7269\u5316\u89C6\u56FE\u3002"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u76F4\u67E5",children:"\u76F4\u67E5"}),"\n",(0,r.jsx)(e.p,{children:"\u5EFA\u8868\u8BED\u53E5\u5982\u4E0B\uFF1A"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"CREATE TABLE IF NOT EXISTS lineitem (\n    l_orderkey    integer not null,\n    l_partkey     integer not null,\n    l_suppkey     integer not null,\n    l_linenumber  integer not null,\n    l_quantity    decimalv3(15,2) not null,\n    l_extendedprice  decimalv3(15,2) not null,\n    l_discount    decimalv3(15,2) not null,\n    l_tax         decimalv3(15,2) not null,\n    l_returnflag  char(1) not null,\n    l_linestatus  char(1) not null,\n    l_shipdate    date not null,\n    l_commitdate  date not null,\n    l_receiptdate date not null,\n    l_shipinstruct char(25) not null,\n    l_shipmode     char(10) not null,\n    l_comment      varchar(44) not null\n    )\n    DUPLICATE KEY(l_orderkey, l_partkey, l_suppkey, l_linenumber)\n    PARTITION BY RANGE(l_shipdate)\n(FROM ('2023-10-17') TO ('2023-11-01') INTERVAL 1 DAY)\n    DISTRIBUTED BY HASH(l_orderkey) BUCKETS 3\n    PROPERTIES (\"replication_num\" = \"1\");\n\ninsert into lineitem values\n(1, 2, 3, 4, 5.5, 6.5, 7.5, 8.5, 'o', 'k', '2023-10-17', '2023-10-17', '2023-10-17', 'a', 'b', 'yyyyyyyyy'),\n(2, 4, 3, 4, 5.5, 6.5, 7.5, 8.5, 'o', 'k', '2023-10-18', '2023-10-18', '2023-10-18', 'a', 'b', 'yyyyyyyyy'),\n(3, 2, 4, 4, 5.5, 6.5, 7.5, 8.5, 'o', 'k', '2023-10-19', '2023-10-19', '2023-10-19', 'a', 'b', 'yyyyyyyyy');\nCREATE TABLE IF NOT EXISTS orders  (\n    o_orderkey       integer not null,\n    o_custkey        integer not null,\n    o_orderstatus    char(1) not null,\n    o_totalprice     decimalv3(15,2) not null,\n    o_orderdate      date not null,\n    o_orderpriority  char(15) not null,\n    o_clerk          char(15) not null,\n    o_shippriority   integer not null,\n    o_comment        varchar(79) not null\n    )\n    DUPLICATE KEY(o_orderkey, o_custkey)\n    PARTITION BY RANGE(o_orderdate)(\n    FROM ('2023-10-17') TO ('2023-11-01') INTERVAL 1 DAY)\n    DISTRIBUTED BY HASH(o_orderkey) BUCKETS 3\n    PROPERTIES (\"replication_num\" = \"1\");\n\n    insert into orders values\n    (1, 1, 'o', 9.5, '2023-10-17', 'a', 'b', 1, 'yy'),\n    (1, 1, 'o', 10.5, '2023-10-18', 'a', 'b', 1, 'yy'),\n    (2, 1, 'o', 11.5, '2023-10-19', 'a', 'b', 1, 'yy'),\n    (3, 1, 'o', 12.5, '2023-10-19', 'a', 'b', 1, 'yy');\n    CREATE TABLE IF NOT EXISTS partsupp (\n      ps_partkey     INTEGER NOT NULL,\n      ps_suppkey     INTEGER NOT NULL,\n      ps_availqty    INTEGER NOT NULL,\n      ps_supplycost  DECIMALV3(15,2)  NOT NULL,\n      ps_comment     VARCHAR(199) NOT NULL \n    )\n    DUPLICATE KEY(ps_partkey, ps_suppkey)\n    DISTRIBUTED BY HASH(ps_partkey) BUCKETS 3\n    PROPERTIES (\n      \"replication_num\" = \"1\"\n    );\n\n    insert into partsupp values\n    (2, 3, 9, 10.01, 'supply1'),\n    (4, 3, 10, 11.01, 'supply2'),\n    (2, 3, 10, 11.01, 'supply3');\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u7269\u5316\u89C6\u56FE\u53EF\u4EE5\u770B\u4F5C\u662F\u8868\uFF0C\u53EF\u4EE5\u50CF\u6B63\u5E38\u7684\u8868\u4E00\u6837\u76F4\u63A5\u67E5\u8BE2\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4E3E\u4F8B\u5982\u4E0B\uFF1A"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"1. \u7269\u5316\u89C6\u56FE\u7684\u5B9A\u4E49\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv1\nBUILD IMMEDIATE REFRESH AUTO ON SCHEDULE EVERY 1 hour\nDISTRIBUTED BY RANDOM BUCKETS 3\nPROPERTIES ('replication_num' = '1')\nAS\nSELECT t1.l_linenumber,\n       o_custkey,\n       o_orderdate\nFROM (SELECT * FROM lineitem WHERE l_linenumber > 1) t1\nLEFT OUTER JOIN orders\nON l_orderkey = o_orderkey;\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u8BE6\u60C5\u53EF\u53C2\u8003 ",(0,r.jsx)(e.a,{href:"../../../sql-manual/sql-statements/Data-Definition-Statements/Create/CREATE-ASYNC-MATERIALIZED-VIEW",children:"CREATE-ASYNC-MATERIALIZED-VIEW"})]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"2. \u67E5\u8BE2\u8BED\u53E5\uFF1A"})}),"\n",(0,r.jsx)(e.p,{children:"\u53EF\u4EE5\u5BF9\u7269\u5316\u89C6\u56FE\u6DFB\u52A0\u8FC7\u6EE4\u6761\u4EF6\u548C\u805A\u5408\u7B49\uFF0C\u8FDB\u884C\u76F4\u63A5\u67E5\u8BE2\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"SELECT\nl_linenumber,\no_custkey\nFROM mv1\nWHERE l_linenumber > 1 and o_orderdate = '2023-10-18';\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u67E5\u8BE2\u6539\u5199\u7684\u80FD\u529B\u8FB9\u754C",children:"\u67E5\u8BE2\u6539\u5199\u7684\u80FD\u529B\u8FB9\u754C"}),"\n",(0,r.jsx)(e.h3,{id:"\u6761\u4EF6\u8865\u507F",children:"\u6761\u4EF6\u8865\u507F"}),"\n",(0,r.jsxs)(e.p,{children:["\u5F53\u7269\u5316\u89C6\u56FE\u548C\u67E5\u8BE2\u7684 ",(0,r.jsx)(e.code,{children:"where"})," \u6761\u4EF6\u662F\u901A\u8FC7 ",(0,r.jsx)(e.code,{children:"and"})," \u8FDE\u63A5\u7684\u8868\u8FBE\u5F0F\u65F6\uFF1A"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"1. \u5F53\u67E5\u8BE2\u7684\u8868\u8FBE\u5F0F\u5305\u542B\u7269\u5316\u89C6\u56FE\u7684\u8868\u8FBE\u5F0F\u65F6\uFF1A"})}),"\n",(0,r.jsx)(e.p,{children:"\u53EF\u4EE5\u8FDB\u884C\u6761\u4EF6\u8865\u507F\u3002"}),"\n",(0,r.jsxs)(e.p,{children:["\u4F8B\u5982\uFF0C\u67E5\u8BE2\u662F ",(0,r.jsx)(e.code,{children:"a > 5 and b > 10 and c = 7"}),"\uFF0C\u7269\u5316\u7684\u6761\u4EF6\u662F ",(0,r.jsx)(e.code,{children:"a > 5 and b > 10"}),"\uFF0C\u7269\u5316\u89C6\u56FE\u7684\u6761\u4EF6\u662F\u67E5\u8BE2\u6761\u4EF6\u7684\u5B50\u96C6\uFF0C\u90A3\u4E48\u53EA\u9700\u8865\u507F ",(0,r.jsx)(e.code,{children:"c = 7"})," \u6761\u4EF6\u5373\u53EF\u3002"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"2. \u5F53\u67E5\u8BE2\u7684\u8868\u8FBE\u5F0F\u4E0D\u5B8C\u5168\u5305\u542B\u7269\u5316\u89C6\u56FE\u7684\u8868\u8FBE\u5F0F\u65F6\uFF1A"})}),"\n",(0,r.jsxs)(e.p,{children:["\u67E5\u8BE2\u7684\u6761\u4EF6\u53EF\u4EE5\u63A8\u5BFC\u51FA\u7269\u5316\u89C6\u56FE\u7684\u6761\u4EF6\u65F6\uFF08\u5E38\u89C1\u7684\u662F\u6BD4\u8F83\u548C\u8303\u56F4\u8868\u8FBE\u5F0F\uFF0C\u5982 ",(0,r.jsx)(e.code,{children:">"}),"\u3001",(0,r.jsx)(e.code,{children:"<"}),"\u3001",(0,r.jsx)(e.code,{children:"="}),"\u3001",(0,r.jsx)(e.code,{children:"in"})," \u7B49\uFF09\uFF0C\u4E5F\u53EF\u4EE5\u8FDB\u884C\u6761\u4EF6\u8865\u507F\u3002\u8865\u507F\u7ED3\u679C\u5C31\u662F\u67E5\u8BE2\u6761\u4EF6\u672C\u8EAB\u3002"]}),"\n",(0,r.jsxs)(e.p,{children:["\u4F8B\u5982\uFF0C\u67E5\u8BE2\u662F ",(0,r.jsx)(e.code,{children:"a > 5 and b = 10"}),"\uFF0C\u7269\u5316\u89C6\u56FE\u662F ",(0,r.jsx)(e.code,{children:"a > 1 and b > 8"}),"\uFF0C\u53EF\u89C1\u7269\u5316\u7684\u6761\u4EF6\u5305\u542B\u4E86\u67E5\u8BE2\u7684\u6761\u4EF6\uFF0C\u67E5\u8BE2\u7684\u6761\u4EF6\u53EF\u4EE5\u63A8\u5BFC\u51FA\u7269\u5316\u89C6\u56FE\u7684\u6761\u4EF6\uFF0C\u8FD9\u6837\u4E5F\u53EF\u4EE5\u8FDB\u884C\u8865\u507F\uFF0C\u8865\u507F\u7ED3\u679C\u5C31\u662F ",(0,r.jsx)(e.code,{children:"a > 5 and b = 10"}),"\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u6761\u4EF6\u8865\u507F\u4F7F\u7528\u9650\u5236\uFF1A"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["\u5BF9\u4E8E\u901A\u8FC7 ",(0,r.jsx)(e.code,{children:"or"})," \u8FDE\u63A5\u7684\u8868\u8FBE\u5F0F\uFF0C\u4E0D\u80FD\u8FDB\u884C\u6761\u4EF6\u8865\u507F\uFF0C\u5FC5\u987B\u4E00\u6837\u624D\u53EF\u4EE5\u6539\u5199\u6210\u529F\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:["\u5BF9\u4E8E ",(0,r.jsx)(e.code,{children:"like"})," \u8FD9\u79CD\u975E\u6BD4\u8F83\u548C\u8303\u56F4\u8868\u8FBE\u5F0F\uFF0C\u4E0D\u80FD\u8FDB\u884C\u6761\u4EF6\u8865\u507F\uFF0C\u5FC5\u987B\u4E00\u6837\u624D\u53EF\u4EE5\u6539\u5199\u6210\u529F\u3002"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"join-\u6539\u5199",children:"JOIN \u6539\u5199"}),"\n",(0,r.jsxs)(e.p,{children:["JOIN \u6539\u5199\u6307\u7684\u662F\u67E5\u8BE2\u548C\u7269\u5316\u4F7F\u7528\u7684\u8868\u76F8\u540C\uFF0C\u53EF\u4EE5\u5728\u7269\u5316\u89C6\u56FE\u548C\u67E5\u8BE2\u7684 JOIN \u8F93\u5165\u6216\u8005 JOIN \u7684\u5916\u5C42\u5199 ",(0,r.jsx)(e.code,{children:"where"}),"\uFF0C\u4F18\u5316\u5668\u5BF9\u6B64\u6A21\u5F0F\u7684\u67E5\u8BE2\u4F1A\u5C1D\u8BD5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u652F\u6301\u591A\u8868 JOIN\uFF0C\u652F\u6301\u7684 JOIN \u7C7B\u578B\u4E3A\uFF1A"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"INNER JOIN"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"LEFT OUTER JOIN"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"RIGHT OUTER JOIN"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"FULL OUTER JOIN"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"LEFT SEMI JOIN"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"RIGHT SEMI JOIN"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"LEFT ANTI JOIN"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"RIGHT ANTI JOIN"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"\u4E3E\u4F8B\u5982\u4E0B\uFF1A"}),"\n",(0,r.jsxs)(e.p,{children:["\u5982\u4E0B\u67E5\u8BE2\u53EF\u8FDB\u884C\u900F\u660E\u6539\u5199\uFF0C\u6761\u4EF6 ",(0,r.jsx)(e.code,{children:"l_linenumber > 1"})," \u53EF\u4EE5\u4E0A\u62C9\uFF0C\u4ECE\u800C\u8FDB\u884C\u900F\u660E\u6539\u5199\uFF0C\u4F7F\u7528\u7269\u5316\u89C6\u56FE\u7684\u9884\u8BA1\u7B97\u7ED3\u679C\u6765\u8868\u8FBE\u67E5\u8BE2\u3002"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"1. \u7269\u5316\u89C6\u56FE\u5B9A\u4E49\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv2\nBUILD IMMEDIATE REFRESH AUTO ON SCHEDULE EVERY 1 hour\nDISTRIBUTED BY RANDOM BUCKETS 3\nPROPERTIES ('replication_num' = '1')\nAS\nSELECT t1.l_linenumber,\n       o_custkey,\n       o_orderdate\nFROM (SELECT * FROM lineitem WHERE l_linenumber > 1) t1\nLEFT OUTER JOIN orders\nON l_orderkey = o_orderkey;\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"2. \u67E5\u8BE2\u8BED\u53E5\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"SELECT l_linenumber,\n       o_custkey\nFROM lineitem\nLEFT OUTER JOIN orders\nON l_orderkey = o_orderkey\nWHERE l_linenumber > 1 and o_orderdate = '2023-10-18';\n"})}),"\n",(0,r.jsx)(e.h3,{id:"join-\u884D\u751F",children:"JOIN \u884D\u751F"}),"\n",(0,r.jsx)(e.p,{children:"\u5F53\u67E5\u8BE2\u548C\u7269\u5316\u89C6\u56FE\u7684 JOIN \u7C7B\u578B\u4E0D\u4E00\u81F4\u65F6\uFF0C\u5982\u679C\u7269\u5316\u89C6\u56FE\u80FD\u591F\u63D0\u4F9B\u67E5\u8BE2\u6240\u9700\u7684\u6240\u6709\u6570\u636E\uFF0C\u90A3\u4E48\u901A\u8FC7\u5728 JOIN \u7684\u5916\u90E8\u8865\u507F\u8C13\u8BCD\uFF0C\u4E5F\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4E3E\u4F8B\u5982\u4E0B\uFF1A"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"1. \u7269\u5316\u89C6\u56FE\u5B9A\u4E49\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv3\nBUILD IMMEDIATE REFRESH AUTO ON SCHEDULE EVERY 1 hour\nDISTRIBUTED BY RANDOM BUCKETS 3\nPROPERTIES ('replication_num' = '1')\nAS\nSELECT\n    l_shipdate, l_suppkey, o_orderdate,\n    sum(o_totalprice) AS sum_total,\n    max(o_totalprice) AS max_total,\n    min(o_totalprice) AS min_total,\n    count(*) AS count_all,\n    count(distinct CASE WHEN o_shippriority > 1 AND o_orderkey IN (1, 3) THEN o_custkey ELSE null END) AS bitmap_union_basic\nFROM lineitem\nLEFT OUTER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey AND l_shipdate = o_orderdate\nGROUP BY\nl_shipdate,\nl_suppkey,\no_orderdate;\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"2. \u67E5\u8BE2\u8BED\u53E5\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"SELECT\n    l_shipdate, l_suppkey, o_orderdate,\n    sum(o_totalprice) AS sum_total,\n    max(o_totalprice) AS max_total,\n    min(o_totalprice) AS min_total,\n    count(*) AS count_all,\n    count(distinct CASE WHEN o_shippriority > 1 AND o_orderkey IN (1, 3) THEN o_custkey ELSE null END) AS bitmap_union_basic\nFROM lineitem\nINNER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey AND l_shipdate = o_orderdate\nWHERE o_orderdate = '2023-10-18' AND l_suppkey = 3\nGROUP BY\nl_shipdate,\nl_suppkey,\no_orderdate;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u805A\u5408\u6539\u5199",children:"\u805A\u5408\u6539\u5199"}),"\n",(0,r.jsx)(e.p,{children:"\u5F53\u67E5\u8BE2\u548C\u7269\u5316\u89C6\u56FE\u5B9A\u4E49\u4E2D\u7684 group \u7EF4\u5EA6\u4E00\u81F4\u65F6\uFF0C\u5982\u679C\u7269\u5316\u89C6\u56FE\u4F7F\u7528\u7684 group by \u7EF4\u5EA6\u548C\u67E5\u8BE2\u7684 group by \u7EF4\u5EA6\u76F8\u540C\uFF0C\u5E76\u4E14\u67E5\u8BE2\u4F7F\u7528\u7684\u805A\u5408\u51FD\u6570\u53EF\u4EE5\u4F7F\u7528\u7269\u5316\u89C6\u56FE\u7684\u805A\u5408\u51FD\u6570\u6765\u8868\u793A\uFF0C\u90A3\u4E48\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4E3E\u4F8B\u5982\u4E0B\uFF1A"}),"\n",(0,r.jsxs)(e.p,{children:["\u5982\u4E0B\u67E5\u8BE2\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\uFF0C\u56E0\u4E3A\u67E5\u8BE2\u548C\u7269\u5316\u89C6\u56FE\u4F7F\u7528\u7684\u805A\u5408\u7EF4\u5EA6\u4E00\u81F4\uFF0C\u53EF\u4EE5\u4F7F\u7528\u7269\u5316\u89C6\u56FE ",(0,r.jsx)(e.code,{children:"o_shippriority"})," \u5B57\u6BB5\u8FDB\u884C\u8FC7\u6EE4\u7ED3\u679C\u3002\u67E5\u8BE2\u4E2D\u7684 group by \u7EF4\u5EA6\u548C\u805A\u5408\u51FD\u6570\u53EF\u4EE5\u4F7F\u7528\u7269\u5316\u89C6\u56FE\u7684 group by \u7EF4\u5EA6\u548C\u805A\u5408\u51FD\u6570\u6765\u6539\u5199\u3002"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"1. \u7269\u5316\u89C6\u56FE\u5B9A\u4E49"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv4\nBUILD IMMEDIATE REFRESH AUTO ON SCHEDULE EVERY 1 hour\nDISTRIBUTED BY RANDOM BUCKETS 3\nPROPERTIES ('replication_num' = '1')\nAS\nSELECT\n    o_shippriority, o_comment,\n    count(distinct CASE WHEN o_shippriority > 1 AND o_orderkey IN (1, 3) THEN o_custkey ELSE null END) AS cnt_1,\n    count(distinct CASE WHEN O_SHIPPRIORITY > 2 AND o_orderkey IN (2) THEN o_custkey ELSE null END) AS cnt_2,\n    sum(o_totalprice),\n    max(o_totalprice),\n    min(o_totalprice),\n    count(*)\nFROM orders\nGROUP BY\no_shippriority,\no_comment;\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"2. \u67E5\u8BE2\u8BED\u53E5\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"SELECT \n    o_shippriority, o_comment,\n    count(distinct CASE WHEN o_shippriority > 1 AND o_orderkey IN (1, 3) THEN o_custkey ELSE null END) AS cnt_1,\n    count(distinct CASE WHEN O_SHIPPRIORITY > 2 AND o_orderkey IN (2) THEN o_custkey ELSE null END) AS cnt_2,\n    sum(o_totalprice),\n    max(o_totalprice),\n    min(o_totalprice),\n    count(*)\nFROM orders\nWHERE o_shippriority in (1, 2)\nGROUP BY\no_shippriority,\no_comment;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u805A\u5408\u6539\u5199\u4E0A\u5377",children:"\u805A\u5408\u6539\u5199\uFF08\u4E0A\u5377\uFF09"}),"\n",(0,r.jsxs)(e.p,{children:["\u5728\u67E5\u8BE2\u548C\u7269\u5316\u89C6\u56FE\u5B9A\u4E49\u4E2D\uFF0C\u5373\u4F7F\u805A\u5408\u7684\u7EF4\u5EA6\u4E0D\u4E00\u81F4\uFF0C\u4E5F\u53EF\u4EE5\u8FDB\u884C\u6539\u5199\u3002\u7269\u5316\u89C6\u56FE\u4F7F\u7528\u7684 ",(0,r.jsx)(e.code,{children:"group by"})," \u7EF4\u5EA6\u9700\u8981\u5305\u542B\u67E5\u8BE2\u7684 ",(0,r.jsx)(e.code,{children:"group by"})," \u7EF4\u5EA6\uFF0C\u800C\u67E5\u8BE2\u53EF\u4EE5\u6CA1\u6709 ",(0,r.jsx)(e.code,{children:"group by"}),"\u3002\u5E76\u4E14\uFF0C\u67E5\u8BE2\u4F7F\u7528\u7684\u805A\u5408\u51FD\u6570\u53EF\u4EE5\u7528\u7269\u5316\u89C6\u56FE\u7684\u805A\u5408\u51FD\u6570\u6765\u8868\u793A\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u4E3E\u4F8B\u5982\u4E0B\uFF1A"}),"\n",(0,r.jsxs)(e.p,{children:["\u4EE5\u4E0B\u67E5\u8BE2\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002\u67E5\u8BE2\u548C\u7269\u5316\u89C6\u56FE\u4F7F\u7528\u7684\u805A\u5408\u7EF4\u5EA6\u4E0D\u4E00\u81F4\uFF0C\u4F46\u7269\u5316\u89C6\u56FE\u4F7F\u7528\u7684\u7EF4\u5EA6\u5305\u542B\u4E86\u67E5\u8BE2\u7684\u7EF4\u5EA6\u3002\u67E5\u8BE2\u53EF\u4EE5\u4F7F\u7528\u7EF4\u5EA6\u4E2D\u7684\u5B57\u6BB5\u5BF9\u7ED3\u679C\u8FDB\u884C\u8FC7\u6EE4\u3002\u67E5\u8BE2\u4F1A\u5C1D\u8BD5\u4F7F\u7528\u7269\u5316\u89C6\u56FE ",(0,r.jsx)(e.code,{children:"SELECT"})," \u540E\u7684\u51FD\u6570\u8FDB\u884C\u4E0A\u5377\uFF0C\u4F8B\u5982\uFF0C\u7269\u5316\u89C6\u56FE\u7684 ",(0,r.jsx)(e.code,{children:"bitmap_union"})," \u6700\u540E\u4F1A\u4E0A\u5377\u6210 ",(0,r.jsx)(e.code,{children:"bitmap_union_count"}),"\uFF0C\u8FD9\u548C\u67E5\u8BE2\u4E2D\u7684 ",(0,r.jsx)(e.code,{children:"count(distinct)"})," \u7684\u8BED\u4E49\u4FDD\u6301\u4E00\u81F4\u3002"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"1. \u7269\u5316\u89C6\u56FE\u5B9A\u4E49\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv5\nBUILD IMMEDIATE REFRESH AUTO ON SCHEDULE EVERY 1 hour\nDISTRIBUTED BY RANDOM BUCKETS 3\nPROPERTIES ('replication_num' = '1')\nAS\nSELECT\n    l_shipdate, o_orderdate, l_partkey, l_suppkey,\n    sum(o_totalprice) AS sum_total,\n    max(o_totalprice) AS max_total,\n    min(o_totalprice) AS min_total,\n    count(*) AS count_all,\n    bitmap_union(to_bitmap(CASE WHEN o_shippriority > 1 AND o_orderkey IN (1, 3) THEN o_custkey ELSE null END)) AS bitmap_union_basic\nFROM lineitem\nLEFT OUTER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey AND l_shipdate = o_orderdate\nGROUP BY\nl_shipdate,\no_orderdate,\nl_partkey,\nl_suppkey;\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"2. \u67E5\u8BE2\u8BED\u53E5\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"SELECT\n    l_shipdate, l_suppkey,\n    sum(o_totalprice) AS sum_total,\n    max(o_totalprice) AS max_total,\n    min(o_totalprice) AS min_total,\n    count(*) AS count_all,\n    count(distinct CASE WHEN o_shippriority > 1 AND o_orderkey IN (1, 3) THEN o_custkey ELSE null END) AS bitmap_union_basic\nFROM lineitem\nLEFT OUTER JOIN orders ON lineitem.l_orderkey = orders.o_orderkey AND l_shipdate = o_orderdate\nWHERE o_orderdate = '2023-10-18' AND l_partkey = 3\nGROUP BY\nl_shipdate,\nl_suppkey;\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u76EE\u524D\u652F\u6301\u7684\u805A\u5408\u4E0A\u5377\u51FD\u6570\u5217\u8868\u5982\u4E0B\uFF1A"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u67E5\u8BE2\u4E2D\u51FD\u6570"}),(0,r.jsx)(e.th,{children:"\u7269\u5316\u89C6\u56FE\u4E2D\u51FD\u6570"}),(0,r.jsx)(e.th,{children:"\u51FD\u6570\u4E0A\u5377\u540E"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"max"}),(0,r.jsx)(e.td,{children:"max"}),(0,r.jsx)(e.td,{children:"max"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"min"}),(0,r.jsx)(e.td,{children:"min"}),(0,r.jsx)(e.td,{children:"min"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"sum"}),(0,r.jsx)(e.td,{children:"sum"}),(0,r.jsx)(e.td,{children:"sum"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"count"}),(0,r.jsx)(e.td,{children:"count"}),(0,r.jsx)(e.td,{children:"sum"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"count(distinct)"}),(0,r.jsx)(e.td,{children:"bitmap_union"}),(0,r.jsx)(e.td,{children:"bitmap_union_count"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"bitmap_union"}),(0,r.jsx)(e.td,{children:"bitmap_union"}),(0,r.jsx)(e.td,{children:"bitmap_union"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"bitmap_union_count"}),(0,r.jsx)(e.td,{children:"bitmap_union"}),(0,r.jsx)(e.td,{children:"bitmap_union_count"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"hll_union_agg, approx_count_distinct, hll_cardinality"}),(0,r.jsx)(e.td,{children:"hll_union \u6216\u8005 hll_raw_agg"}),(0,r.jsx)(e.td,{children:"hll_union_agg"})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"\u591A\u7EF4\u805A\u5408\u6539\u5199",children:"\u591A\u7EF4\u805A\u5408\u6539\u5199"}),"\n",(0,r.jsxs)(e.p,{children:["\u652F\u6301\u591A\u7EF4\u805A\u5408\u7684\u900F\u660E\u6539\u5199\uFF0C\u5373\u5982\u679C\u7269\u5316\u89C6\u56FE\u4E2D\u6CA1\u6709\u4F7F\u7528 ",(0,r.jsx)(e.code,{children:"GROUPING SETS"}),", ",(0,r.jsx)(e.code,{children:"CUBE"}),", ",(0,r.jsx)(e.code,{children:"ROLLUP"}),"\uFF0C\u800C\u67E5\u8BE2\u4E2D\u6709\u591A\u7EF4\u805A\u5408\uFF0C\u5E76\u4E14\u7269\u5316\u89C6\u56FE ",(0,r.jsx)(e.code,{children:"group by"})," \u540E\u7684\u5B57\u6BB5\u5305\u542B\u67E5\u8BE2\u4E2D\u591A\u7EF4\u805A\u5408\u7684\u6240\u6709\u5B57\u6BB5\uFF0C\u90A3\u4E48\u4E5F\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u4E3E\u4F8B\u5982\u4E0B\uFF1A"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"1. \u7269\u5316\u89C6\u56FE\u5B9A\u4E49\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv5_1\nBUILD IMMEDIATE REFRESH AUTO ON SCHEDULE EVERY 1 hour\nDISTRIBUTED BY RANDOM BUCKETS 3\nPROPERTIES ('replication_num' = '1')\nAS\nselect o_orderstatus, o_orderdate, o_orderpriority,\n       sum(o_totalprice) as sum_total,\n       max(o_totalprice) as max_total,\n       min(o_totalprice) as min_total,\n       count(*) as count_all\nfrom orders\ngroup by\no_orderstatus, o_orderdate, o_orderpriority;\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"2. \u67E5\u8BE2\u8BED\u53E5\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"select o_orderstatus, o_orderdate, o_orderpriority,\n       sum(o_totalprice),\n       max(o_totalprice),\n       min(o_totalprice),\n       count(*)\nfrom orders\ngroup by\nGROUPING SETS ((o_orderstatus, o_orderdate), (o_orderpriority), (o_orderstatus), ());\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u5206\u533A\u8865\u507F\u6539\u5199",children:"\u5206\u533A\u8865\u507F\u6539\u5199"}),"\n",(0,r.jsxs)(e.p,{children:["\u5F53\u5206\u533A\u7269\u5316\u89C6\u56FE\u4E0D\u8DB3\u4EE5\u63D0\u4F9B\u67E5\u8BE2\u7684\u6240\u6709\u6570\u636E\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528 ",(0,r.jsx)(e.code,{children:"union all"})," \u7684\u65B9\u5F0F\uFF0C\u5C06\u67E5\u8BE2\u539F\u8868\u548C\u7269\u5316\u89C6\u56FE\u7684\u6570\u636E ",(0,r.jsx)(e.code,{children:"union all"})," \u4F5C\u4E3A\u6700\u7EC8\u8FD4\u56DE\u7ED3\u679C\u3002"]}),"\n",(0,r.jsx)(e.p,{children:"\u4E3E\u4F8B\u5982\u4E0B\uFF1A"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"1. \u7269\u5316\u89C6\u56FE\u5B9A\u4E49\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv7\nBUILD IMMEDIATE REFRESH AUTO ON MANUAL\npartition by(l_shipdate)\nDISTRIBUTED BY RANDOM BUCKETS 2\nPROPERTIES ('replication_num' = '1') \nas\nselect l_shipdate, o_orderdate, l_partkey,\n       l_suppkey, sum(o_totalprice) as sum_total\nfrom lineitem\n         left join orders on lineitem.l_orderkey = orders.o_orderkey and l_shipdate = o_orderdate\ngroup by\n    l_shipdate,\n    o_orderdate,\n    l_partkey,\n    l_suppkey;\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u5F53\u57FA\u8868\u65B0\u589E\u5206\u533A ",(0,r.jsx)(e.code,{children:"2023-10-21"})," \u65F6\uFF0C\u5E76\u4E14\u7269\u5316\u89C6\u56FE\u8FD8\u672A\u5237\u65B0\u65F6\uFF0C\u53EF\u4EE5\u901A\u8FC7\u7269\u5316\u89C6\u56FE ",(0,r.jsx)(e.code,{children:"union all"})," \u539F\u8868\u7684\u65B9\u5F0F\u8FD4\u56DE\u7ED3\u679C\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"insert into lineitem values\n    (1, 2, 3, 4, 5.5, 6.5, 7.5, 8.5, 'o', 'k', '2023-10-21', '2023-10-21', '2023-10-21', 'a', 'b', 'yyyyyyyyy');\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"2. \u8FD0\u884C\u67E5\u8BE2\u8BED\u53E5\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"select l_shipdate, o_orderdate, l_partkey, l_suppkey, sum(o_totalprice) as sum_total\nfrom lineitem\n         left join orders on lineitem.l_orderkey = orders.o_orderkey and l_shipdate = o_orderdate\ngroup by\n    l_shipdate,\n    o_orderdate,\n    l_partkey,\n    l_suppkey;\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"3. \u6539\u5199\u7ED3\u679C\u793A\u610F\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"SELECT *\nFROM mv7\nunion all\nselect t1.l_shipdate, o_orderdate, t1.l_partkey, t1.l_suppkey, sum(o_totalprice) as sum_total\nfrom (select * from lineitem where l_shipdate = '2023-10-21') t1\n         left join orders on t1.l_orderkey = orders.o_orderkey and t1.l_shipdate = o_orderdate\ngroup by\n    t1.l_shipdate,\n    o_orderdate,\n    t1.l_partkey,\n    t1.l_suppkey;\n"})}),"\n",(0,r.jsxs)(e.admonition,{title:"\u6CE8\u610F",type:"caution",children:[(0,r.jsxs)(e.p,{children:["\u76EE\u524D\u652F\u6301\u5206\u533A\u8865\u507F\uFF0C\u6682\u65F6\u4E0D\u652F\u6301\u5E26\u6761\u4EF6\u7684 ",(0,r.jsx)(e.code,{children:"UNION ALL"})," \u8865\u507F\u3002"]}),(0,r.jsxs)(e.p,{children:["\u6BD4\u5982\uFF0C\u5982\u679C\u7269\u5316\u89C6\u56FE\u5E26\u6709 ",(0,r.jsx)(e.code,{children:"where"})," \u6761\u4EF6\uFF0C\u4EE5\u4E0A\u8FF0\u4E3A\u4F8B\uFF0C\u5982\u679C\u6784\u5EFA\u7269\u5316\u7684\u8FC7\u6EE4\u6761\u4EF6\u52A0\u4E0A ",(0,r.jsx)(e.code,{children:" WHERE l_shipdate > '2023-10-19'"}),"\uFF0C\u800C\u67E5\u8BE2\u662F ",(0,r.jsx)(e.code,{children:"WHERE l_shipdate > '2023-10-18'"}),"\uFF0C\u76EE\u524D\u8FD9\u79CD\u8FD8\u65E0\u6CD5\u901A\u8FC7 ",(0,r.jsx)(e.code,{children:"UNION ALL"})," \u8865\u507F\uFF0C\u5F85\u652F\u6301\u3002"]})]}),"\n",(0,r.jsx)(e.h3,{id:"\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u6539\u5199",children:"\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u6539\u5199"}),"\n",(0,r.jsx)(e.p,{children:"\u7269\u5316\u89C6\u56FE\u7684\u5B9A\u4E49 SQL \u53EF\u4EE5\u4F7F\u7528\u7269\u5316\u89C6\u56FE\uFF0C\u6B64\u7269\u5316\u89C6\u56FE\u79F0\u4E3A\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u3002\u5D4C\u5957\u7684\u5C42\u6570\u7406\u8BBA\u4E0A\u6CA1\u6709\u9650\u5236\uFF0C\u6B64\u7269\u5316\u89C6\u56FE\u65E2\u53EF\u4EE5\u76F4\u67E5\uFF0C\u4E5F\u53EF\u4EE5\u8FDB\u884C\u900F\u660E\u6539\u5199\u3002\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u540C\u6837\u53EF\u4EE5\u53C2\u4E0E\u900F\u660E\u6539\u5199\u3002"}),"\n",(0,r.jsx)(e.p,{children:"\u4E3E\u4F8B\u5982\u4E0B\uFF1A"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsxs)(e.strong,{children:["1. \u521B\u5EFA\u5185\u5C42\u7269\u5316\u89C6\u56FE ",(0,r.jsx)(e.code,{children:"mv8_0_inner_mv"}),"\uFF1A"]})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv8_0_inner_mv\nBUILD IMMEDIATE REFRESH COMPLETE ON MANUAL\nDISTRIBUTED BY RANDOM BUCKETS 2\nPROPERTIES ('replication_num' = '1')\nAS\nselect\nl_linenumber,\no_custkey,\no_orderkey,\no_orderstatus,\nl_partkey,\nl_suppkey,\nl_orderkey\nfrom lineitem\ninner join orders on lineitem.l_orderkey = orders.o_orderkey;\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsxs)(e.strong,{children:["2. \u521B\u5EFA\u5916\u5C42\u7269\u5316\u89C6\u56FE ",(0,r.jsx)(e.code,{children:"mv8_0"}),"\uFF1A"]})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"CREATE MATERIALIZED VIEW mv8_0\nBUILD IMMEDIATE REFRESH COMPLETE ON MANUAL\nDISTRIBUTED BY RANDOM BUCKETS 2\nPROPERTIES ('replication_num' = '1') \nAS\nselect\nl_linenumber,\no_custkey,\no_orderkey,\no_orderstatus,\nl_partkey,\nl_suppkey,\nl_orderkey,\nps_availqty\nfrom mv8_0_inner_mv\ninner join partsupp on l_partkey = ps_partkey AND l_suppkey = ps_suppkey;\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u5BF9\u4E8E\u4EE5\u4E0B\u67E5\u8BE2\uFF0C",(0,r.jsx)(e.code,{children:"mv8_0_inner_mv"})," \u548C ",(0,r.jsx)(e.code,{children:"mv8_0"})," \u90FD\u4F1A\u6210\u529F\u8FDB\u884C\u6539\u5199\uFF0C\u6700\u7EC8\u4EE3\u4EF7\u6A21\u578B\u4F1A\u9009\u62E9 ",(0,r.jsx)(e.code,{children:"mv8_0"}),"\uFF1A"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"select lineitem.l_linenumber\nfrom lineitem\ninner join orders on l_orderkey = o_orderkey\ninner join partsupp on  l_partkey = ps_partkey AND l_suppkey = ps_suppkey\nwhere o_orderstatus = 'o'\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u6CE8\u610F\uFF1A"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u7684\u5C42\u6570\u8D8A\u591A\uFF0C\u900F\u660E\u6539\u5199\u7684\u8017\u65F6\u4F1A\u76F8\u5E94\u589E\u52A0\u3002\u5EFA\u8BAE\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u5C42\u6570\u4E0D\u8981\u8D85\u8FC7 3 \u5C42\u3002"}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsx)(e.p,{children:"\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u900F\u660E\u6539\u5199\u9ED8\u8BA4\u5173\u95ED\uFF0C\u5F00\u542F\u65B9\u5F0F\u89C1\u4E0B\u9762\u7684\u5F00\u5173\u8BBE\u7F6E\u3002"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"explain-\u67E5\u8BE2\u900F\u660E\u6539\u5199\u60C5\u51B5",children:"Explain \u67E5\u8BE2\u900F\u660E\u6539\u5199\u60C5\u51B5"}),"\n",(0,r.jsx)(e.p,{children:"\u67E5\u8BE2\u900F\u660E\u6539\u5199\u547D\u4E2D\u60C5\u51B5\uFF0C\u7528\u4E8E\u67E5\u770B\u548C\u8C03\u8BD5\u3002"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"1. \u5982\u679C\u9700\u8981\u67E5\u770B\u7269\u5316\u89C6\u56FE\u7684\u900F\u660E\u6539\u5199\u547D\u4E2D\u60C5\u51B5\uFF0C\u8BE5\u8BED\u53E5\u4F1A\u5C55\u793A\u67E5\u8BE2\u900F\u660E\u6539\u5199\u7684\u7B80\u8981\u8FC7\u7A0B\u4FE1\u606F\u3002"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"explain <query_sql> \n"})}),"\n",(0,r.jsx)(e.p,{children:"\u8FD4\u56DE\u7684\u4FE1\u606F\u5982\u4E0B\uFF0C\u6B64\u5904\u622A\u53D6\u4E86\u4E0E\u7269\u5316\u89C6\u56FE\u76F8\u5173\u7684\u4FE1\u606F\uFF1A"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"| MaterializedView                                                                                                                                                                                                                                      |\n| MaterializedViewRewriteSuccessAndChose:                                                                                                                                                                                                               |\n|   Names: mv5                                                                                                                                                                                                                                          |\n| MaterializedViewRewriteSuccessButNotChose:                                                                                                                                                                                                            |\n|                                                                                                                                                                                                                                                       |\n| MaterializedViewRewriteFail:                                                                                                                                                                                                                          |\n|   Name: mv4                                                                                                                                                                                                                                           |\n|   FailSummary: Match mode is invalid, View struct info is invalid                                                                                                                                                                                     |\n|   Name: mv3                                                                                                                                                                                                                                           |\n|   FailSummary: Match mode is invalid, Rewrite compensate predicate by view fail, View struct info is invalid                                                                                                                                          |\n|   Name: mv1                                                                                                                                                                                                                                           |\n|   FailSummary: The columns used by query are not in view, View struct info is invalid                                                                                                                                                                 |\n|   Name: mv2                                                                                                                                                                                                                                           |\n|   FailSummary: The columns used by query are not in view, View struct info is invalid\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"MaterializedViewRewriteSuccessAndChose\uFF1A\u8868\u793A\u900F\u660E\u6539\u5199\u6210\u529F\uFF0C\u5E76\u4E14 CBO\uFF08Cost-Based Optimizer\uFF09\u9009\u62E9\u7684\u7269\u5316\u89C6\u56FE\u540D\u79F0\u5217\u8868\u3002"}),"\n",(0,r.jsx)(e.li,{children:"MaterializedViewRewriteSuccessButNotChose\uFF1A\u8868\u793A\u900F\u660E\u6539\u5199\u6210\u529F\uFF0C\u4F46\u662F\u6700\u7EC8 CBO \u6CA1\u6709\u9009\u62E9\u7684\u7269\u5316\u89C6\u56FE\u540D\u79F0\u5217\u8868\u3002"}),"\n",(0,r.jsx)(e.li,{children:"MaterializedViewRewriteFail\uFF1A\u5217\u4E3E\u900F\u660E\u6539\u5199\u5931\u8D25\u7684\u60C5\u51B5\u53CA\u539F\u56E0\u6458\u8981\u3002"}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"2. \u5982\u679C\u60F3\u4E86\u89E3\u7269\u5316\u89C6\u56FE\u7684\u5019\u9009\u3001\u6539\u5199\u4EE5\u53CA\u6700\u7EC8\u9009\u62E9\u60C5\u51B5\u7684\u8BE6\u7EC6\u8FC7\u7A0B\u4FE1\u606F\uFF0C\u53EF\u4EE5\u6267\u884C\u5982\u4E0B\u8BED\u53E5\uFF1A"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"explain memo plan <query_sql>\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u9644\u5F55",children:"\u9644\u5F55"}),"\n",(0,r.jsx)(e.h3,{id:"\u7269\u5316\u89C6\u56FE\u76F8\u5173\u5F00\u5173\u4ECB\u7ECD",children:"\u7269\u5316\u89C6\u56FE\u76F8\u5173\u5F00\u5173\u4ECB\u7ECD"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u5F00\u5173"}),(0,r.jsx)(e.th,{children:"\u8BF4\u660E"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"SET enable_nereids_planner = true;"}),(0,r.jsx)(e.td,{children:"\u5F02\u6B65\u7269\u5316\u89C6\u56FE\u53EA\u6709\u5728\u65B0\u4F18\u5316\u5668\u4E0B\u624D\u652F\u6301\uFF0C\u6240\u4EE5\u7269\u5316\u89C6\u56FE\u900F\u660E\u6539\u5199\u6CA1\u6709\u751F\u6548\u65F6\uFF0C\u9700\u8981\u5F00\u542F\u65B0\u4F18\u5316\u5668"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"SET enable_materialized_view_rewrite = true;"}),(0,r.jsx)(e.td,{children:"\u5F00\u542F\u6216\u8005\u5173\u95ED\u67E5\u8BE2\u900F\u660E\u6539\u5199\uFF0C\u9ED8\u8BA4\u5F00\u542F"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"SET materialized_view_rewrite_enable_contain_external_table = true;"}),(0,r.jsx)(e.td,{children:"\u53C2\u4E0E\u900F\u660E\u6539\u5199\u7684\u7269\u5316\u89C6\u56FE\u662F\u5426\u5141\u8BB8\u5305\u542B\u5916\u8868\uFF0C\u9ED8\u8BA4\u4E0D\u5141\u8BB8\uFF0C\u5982\u679C\u7269\u5316\u89C6\u56FE\u7684\u5B9A\u4E49 SQL \u4E2D\u5305\u542B\u5916\u8868\uFF0C\u4E5F\u60F3\u53C2\u4E0E\u5230\u900F\u660E\u6539\u5199\uFF0C\u53EF\u4EE5\u6253\u5F00\u6B64\u5F00\u5173\u3002"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"SET materialized_view_rewrite_success_candidate_num = 3;"}),(0,r.jsx)(e.td,{children:"\u900F\u660E\u6539\u5199\u6210\u529F\u7684\u7ED3\u679C\u96C6\u5408\uFF0C\u5141\u8BB8\u53C2\u4E0E\u5230 CBO \u5019\u9009\u7684\u6700\u5927\u6570\u91CF\uFF0C\u9ED8\u8BA4\u662F 3\u3002\u5982\u679C\u53D1\u73B0\u900F\u660E\u6539\u5199\u7684\u6027\u80FD\u5F88\u6162\uFF0C\u53EF\u4EE5\u8003\u8651\u628A\u8FD9\u4E2A\u503C\u8C03\u5C0F\u3002"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"SET enable_materialized_view_union_rewrite = true;"}),(0,r.jsx)(e.td,{children:"\u5F53\u5206\u533A\u7269\u5316\u89C6\u56FE\u4E0D\u8DB3\u4EE5\u63D0\u4F9B\u67E5\u8BE2\u7684\u5168\u90E8\u6570\u636E\u65F6\uFF0C\u662F\u5426\u5141\u8BB8\u57FA\u8868\u548C\u7269\u5316\u89C6\u56FE union all \u6765\u54CD\u5E94\u67E5\u8BE2\uFF0C\u9ED8\u8BA4\u5141\u8BB8\u3002\u5982\u679C\u53D1\u73B0\u547D\u4E2D\u7269\u5316\u89C6\u56FE\u65F6\u6570\u636E\u9519\u8BEF\uFF0C\u53EF\u4EE5\u628A\u6B64\u5F00\u5173\u5173\u95ED\u3002"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"SET enable_materialized_view_nest_rewrite = true;"}),(0,r.jsx)(e.td,{children:"\u662F\u5426\u5141\u8BB8\u5D4C\u5957\u6539\u5199\uFF0C\u9ED8\u8BA4\u4E0D\u5141\u8BB8\u3002\u5982\u679C\u67E5\u8BE2 SQL \u5F88\u590D\u6742\uFF0C\u9700\u8981\u6784\u5EFA\u5D4C\u5957\u7269\u5316\u89C6\u56FE\u624D\u53EF\u4EE5\u547D\u4E2D\uFF0C\u90A3\u4E48\u9700\u8981\u6253\u5F00\u6B64\u5F00\u5173\u3002"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"SET materialized_view_relation_mapping_max_count = 8;"}),(0,r.jsx)(e.td,{children:"\u900F\u660E\u6539\u5199\u8FC7\u7A0B\u4E2D\uFF0Crelation mapping \u6700\u5927\u5141\u8BB8\u6570\u91CF\uFF0C\u5982\u679C\u8D85\u8FC7\uFF0C\u8FDB\u884C\u622A\u53D6\u3002relation mapping \u901A\u5E38\u7531\u8868\u81EA\u5173\u8054\u4EA7\u751F\uFF0C\u6570\u91CF\u4E00\u822C\u4F1A\u662F\u7B1B\u5361\u5C14\u79EF\uFF0C\u6BD4\u5982 3 \u5F20\u8868\uFF0C\u53EF\u80FD\u4F1A\u4EA7\u751F 8 \u79CD\u7EC4\u5408\u3002\u9ED8\u8BA4\u662F 8\u3002\u5982\u679C\u53D1\u73B0\u900F\u660E\u6539\u5199\u65F6\u95F4\u5F88\u957F\uFF0C\u53EF\u4EE5\u628A\u8FD9\u4E2A\u503C\u8C03\u4F4E"})]})]})]})]})}function h(n={}){let{wrapper:e}={...(0,s.a)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(a,{...n})}):a(n)}},250065:function(n,e,l){l.d(e,{Z:function(){return t},a:function(){return d}});var i=l(667294);let r={},s=i.createContext(r);function d(n){let e=i.useContext(s);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:d(n.components),i.createElement(s.Provider,{value:e},n.children)}}}]);