"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["123031"],{366627:function(n,e,i){i.r(e),i.d(e,{metadata:()=>s,contentTitle:()=>o,default:()=>h,assets:()=>a,toc:()=>c,frontMatter:()=>l});var s=JSON.parse('{"id":"query-acceleration/tuning/tuning-plan/dml-tuning-plan","title":"DML Tuning Plan","description":"\x3c!--","source":"@site/docs/query-acceleration/tuning/tuning-plan/dml-tuning-plan.md","sourceDirName":"query-acceleration/tuning/tuning-plan","slug":"/query-acceleration/tuning/tuning-plan/dml-tuning-plan","permalink":"/docs/dev/query-acceleration/tuning/tuning-plan/dml-tuning-plan","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"DML Tuning Plan","language":"zh-CN"},"sidebar":"docs","previous":{"title":"Solving Unevenly Data Distribution","permalink":"/docs/dev/query-acceleration/tuning/tuning-plan/solving-unevenly-data-distribution"},"next":{"title":"Common Tuning Parameters","permalink":"/docs/dev/query-acceleration/tuning/faq"}}'),t=i("785893"),r=i("250065");let l={title:"DML Tuning Plan",language:"zh-CN"},o=void 0,a={},c=[{value:"Loading",id:"loading",level:2},{value:"Principles",id:"principles",level:3},{value:"Loading Optimization",id:"loading-optimization",level:3},{value:"Querying",id:"querying",level:2}];function d(n){let e={a:"a",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.a)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.p,{children:"DML Plan Tuning Includes Both Import Section (INSERT INTO SELECT) and Query Section (CREATE TABLE AS SELECT - CTAS). Next, will introduce the principles and tuning practices of these two parts separately."}),"\n",(0,t.jsx)(e.h2,{id:"loading",children:"Loading"}),"\n",(0,t.jsx)(e.h3,{id:"principles",children:"Principles"}),"\n",(0,t.jsx)(e.p,{children:"Apache Doris offers a variety of flexible data import solutions to meet data access needs in different scenarios. Doris supports importing data from the following data sources:"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Object storage (S3) and HDFS"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Local files"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Kafka"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Relational databases (such as MySQL, PostgreSQL, Oracle, SQLServer, etc.)"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Data sources connected via JDBC"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"JSON format data"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Doris provides the following main data import methods:"})}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Broker Load: Imports data from external storage systems through the Broker process"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Stream Load: Streams data from local files or in-memory data"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Routine Load: Continuously imports data from Kafka"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"INSERT INTO: Imports data through SQL insert statements"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"S3 Load: Directly imports data from object storage that supports the S3 protocol"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"MySQL Load: Uses MySQL clients to import local data"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Different import methods support slightly different data formats:"})}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Broker Load: Supports Parquet, ORC, CSV, and GZip formats"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Stream Load: Supports CSV, JSON, Parquet, and ORC formats"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Routine Load: Supports CSV and JSON formats"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"MySQL Load: Supports CSV format"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Data import has the following mechanisms:"})}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Atomicity guarantee: Each import job acts as a complete transaction, ensuring atomic data writes."}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Import label: Each import job is assigned a unique label to ensure At-Most-Once semantics."}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Synchronous/Asynchronous mode: Synchronous mode returns results immediately, while asynchronous mode requires separate querying of job status."}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Array type support: Array type data can be imported using CAST and array functions."}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Execution engine: Users can choose whether to use the Pipeline engine to execute import tasks based on configuration."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"In practicality, the following considerations are necessary:"})}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Reasonable selection of import methods: Choose the most appropriate import method for different data sources."}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Utilization of label mechanism: Achieve Exactly-Once semantics guarantee."}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Proper configuration of parallelism: Adjust the number of parallel imports based on cluster resources."}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Monitoring of import status: For asynchronous imports, check the job's progress timely."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["By flexibly using the various import functions provided by Doris, data from various sources can be efficiently imported into Doris for analysis. For more details, please refer to the ",(0,t.jsx)(e.a,{href:"../../../data-operate/import/import-way/load-manual",children:"Data Loading Overview"}),"."]}),"\n",(0,t.jsx)(e.h3,{id:"loading-optimization",children:"Loading Optimization"}),"\n",(0,t.jsx)(e.p,{children:"The Pipeline engine is a new query execution engine in Doris, designed to improve the efficiency of queries and data processing. During data import, the Pipeline engine can also be enabled to enhance overall performance. By default, the Pipeline engine is disabled during data import, but users can enable it through relevant configurations."}),"\n",(0,t.jsx)(e.p,{children:"To enable the Pipeline engine during data import, configure the following variables:"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"1. FE Configuration Item: enable_pipeline_load"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Location: In the configuration file of the FE (Frontend)"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Function: When enabled, import tasks such as Stream Load will attempt to execute using the Pipeline engine"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"2. Session Variable: enable_nereids_dml_with_pipeline"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Location: Set at session level"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Function: When enabled, INSERT INTO statements will attempt to execute using the Pipeline engine"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"3. Session Variable: enable_pipeline_engine"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Location: Set at session level"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"Function: Controls whether the Pipeline engine is actually enabled"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"querying",children:"Querying"}),"\n",(0,t.jsxs)(e.p,{children:["For details, please refer to other sections on ",(0,t.jsx)(e.a,{href:"../../../query-acceleration/tuning/tuning-plan/optimizing-table-schema",children:"plan tuning"}),"."]})]})}function h(n={}){let{wrapper:e}={...(0,r.a)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},250065:function(n,e,i){i.d(e,{Z:function(){return o},a:function(){return l}});var s=i(667294);let t={},r=s.createContext(t);function l(n){let e=s.useContext(r);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:l(n.components),s.createElement(r.Provider,{value:e},n.children)}}}]);