"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["660636"],{622270:function(e,n,i){i.r(n),i.d(n,{metadata:()=>t,contentTitle:()=>s,default:()=>h,assets:()=>c,toc:()=>d,frontMatter:()=>l});var t=JSON.parse('{"id":"install/source-install/compilation-with-ldb-toolchain","title":"Compiling with LDB toolchain","description":"\x3c!--","source":"@site/versioned_docs/version-1.2/install/source-install/compilation-with-ldb-toolchain.md","sourceDirName":"install/source-install","slug":"/install/source-install/compilation-with-ldb-toolchain","permalink":"/docs/1.2/install/source-install/compilation-with-ldb-toolchain","draft":false,"unlisted":false,"tags":[],"version":"1.2","frontMatter":{"title":"Compiling with LDB toolchain","language":"en"},"sidebar":"docs","previous":{"title":"General Compilation","permalink":"/docs/1.2/install/source-install/compilation-general"},"next":{"title":"Compilation With Arm","permalink":"/docs/1.2/install/source-install/compilation-arm"}}'),o=i("785893"),r=i("250065");let l={title:"Compiling with LDB toolchain",language:"en"},s="Compile With ldb-toolchain",c={},d=[{value:"Prepare the Environment",id:"prepare-the-environment",level:2},{value:"Compile Doris",id:"compile-doris",level:2},{value:"Precompile the Third-Party Binaries",id:"precompile-the-third-party-binaries",level:2}];function a(e){let n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"compile-with-ldb-toolchain",children:"Compile With ldb-toolchain"})}),"\n",(0,o.jsx)(n.p,{children:"This topic is about how to compile Doris using the LDB toolchain. This method is an alternative to the Docker method so developers and users without a Docker environment can compile Doris from source."}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["You can still compile the latest code using the Docker development image: ",(0,o.jsx)(n.code,{children:"apache/doris:build-env-ldb-toolchain-latest"})]}),"\n"]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["Special thanks to ",(0,o.jsx)(n.a,{href:"https://github.com/amosbird",children:"Amos Bird"})," for the contribution."]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"prepare-the-environment",children:"Prepare the Environment"}),"\n",(0,o.jsx)(n.p,{children:"This works for most Linux distributions (CentOS, Ubuntu, etc.)."}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Download ",(0,o.jsx)(n.code,{children:"ldb_toolchain_gen.sh"})]}),"\n",(0,o.jsxs)(n.p,{children:["The latest ",(0,o.jsx)(n.code,{children:"ldb_toolchain_gen.sh"})," can be downloaded from ",(0,o.jsx)(n.a,{href:"https://github.com/amosbird/ldb_toolchain_gen/releases",children:"here"}),". This script is used to generate the ldb toolchain."]}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsxs)(n.p,{children:["For more information, you can visit ",(0,o.jsx)(n.a,{href:"https://github.com/amosbird/ldb_toolchain_gen",children:"https://github.com/amosbird/ldb_toolchain_gen"})]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Execute the following command to generate the ldb toolchain."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"sh ldb_toolchain_gen.sh /path/to/ldb_toolchain/\n"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"/path/to/ldb_toolchain/"})," is the directory where the toolchain is installed."]}),"\n",(0,o.jsxs)(n.p,{children:["After execution, the following directory structure will be created under ",(0,o.jsx)(n.code,{children:"/path/to/ldb_toolchain/"}),"."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"\u251C\u2500\u2500 bin\n\u251C\u2500\u2500 include\n\u251C\u2500\u2500 lib\n\u251C\u2500\u2500 share\n\u251C\u2500\u2500 test\n\u2514\u2500\u2500 usr\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Download and install other compilation packages"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://doris-thirdparty-repo.bj.bcebos.com/thirdparty/jdk-8u131-linux-x64.tar.gz",children:"Java8"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://doris-thirdparty-repo.bj.bcebos.com/thirdparty/apache-maven-3.6.3-bin.tar.gz",children:"Apache Maven 3.6.3"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://doris-thirdparty-repo.bj.bcebos.com/thirdparty/node-v12.13.0-linux-x64.tar.gz",children:"Node v12.13.0"})}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Different Linux distributions might contain different packages, so you may need to install additional packages. The following instructions describe how to set up a minimal CentOS 6 box to compile Doris. It should work similarly for other Linux distros."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"# install required system packages\nsudo yum install -y byacc patch automake libtool make which file ncurses-devel gettext-devel unzip bzip2 zip util-linux wget git python2\n\n# install autoconf-2.69\nwget http://ftp.gnu.org/gnu/autoconf/autoconf-2.69.tar.gz && \\\n    tar zxf autoconf-2.69.tar.gz && \\\n    cd autoconf-2.69 && \\\n    ./configure && \\\n    make && \\\n    make install\n\n# install bison-3.0.4\nwget http://ftp.gnu.org/gnu/bison/bison-3.0.4.tar.gz && \\\n    tar xzf bison-3.0.4.tar.gz && \\\n    cd bison-3.0.4 && \\\n    ./configure && \\\n    make && \\\n    make install\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Download Doris source code"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"git clone https://github.com/apache/doris.git\n"})}),"\n",(0,o.jsxs)(n.p,{children:["After downloading, create the ",(0,o.jsx)(n.code,{children:"custom_env.sh"}),", file under the Doris source directory, and set the PATH environment variable:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"export JAVA_HOME=/path/to/java/\nexport PATH=$JAVA_HOME/bin:$PATH\nexport PATH=/path/to/maven/bin:$PATH\nexport PATH=/path/to/node/bin:$PATH\nexport PATH=/path/to/ldb_toolchain/bin:$PATH\n"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"compile-doris",children:"Compile Doris"}),"\n",(0,o.jsx)(n.p,{children:"Enter the Doris source code directory and execute:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"$ cat /proc/cpuinfo | grep avx2\n"})}),"\n",(0,o.jsx)(n.p,{children:"Check whether the compilation machine supports the avx2 instruction set."}),"\n",(0,o.jsx)(n.p,{children:"If it is not supported, use the following command to compile:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"$ USE_AVX2=0 sh build.sh\n"})}),"\n",(0,o.jsxs)(n.p,{children:["If supported, execute ",(0,o.jsx)(n.code,{children:"sh build.sh"})," directly."]}),"\n",(0,o.jsxs)(n.p,{children:["This script will compile the third-party libraries first and then the Doris components (FE, BE) later. The compiled output will be in the ",(0,o.jsx)(n.code,{children:"output/"})," directory."]}),"\n",(0,o.jsx)(n.h2,{id:"precompile-the-third-party-binaries",children:"Precompile the Third-Party Binaries"}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"build.sh"})," script will first compile the third-party dependencies. You can also directly download the precompiled three-party binaries:"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"https://github.com/apache/doris-thirdparty/releases"})}),"\n",(0,o.jsx)(n.p,{children:"Here we provide precompiled third-party binaries for Linux X86(with AVX2) and MacOS(X86 Chip). If it is consistent with your compiling and running environment, you can download and use it directly."}),"\n",(0,o.jsxs)(n.p,{children:["After downloading, you will get an ",(0,o.jsx)(n.code,{children:"installed/"})," directory after decompression, copy this directory to the ",(0,o.jsx)(n.code,{children:"thirdparty/"})," directory, and then run ",(0,o.jsx)(n.code,{children:"build.sh"}),"."]})]})}function h(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},250065:function(e,n,i){i.d(n,{Z:function(){return s},a:function(){return l}});var t=i(667294);let o={},r=t.createContext(o);function l(e){let n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);