"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["109924"],{221714:function(e,a,t){t.r(a),t.d(a,{metadata:()=>n,contentTitle:()=>i,default:()=>h,assets:()=>l,toc:()=>c,frontMatter:()=>o});var n=JSON.parse('{"id":"data-operate/import/import-scenes/kafka-load","title":"Kafka Data Subscription","description":"\x3c!--","source":"@site/versioned_docs/version-1.2/data-operate/import/import-scenes/kafka-load.md","sourceDirName":"data-operate/import/import-scenes","slug":"/data-operate/import/import-scenes/kafka-load","permalink":"/docs/1.2/data-operate/import/import-scenes/kafka-load","draft":false,"unlisted":false,"tags":[],"version":"1.2","frontMatter":{"title":"Kafka Data Subscription","language":"en"},"sidebar":"docs","previous":{"title":"External storage data import","permalink":"/docs/1.2/data-operate/import/import-scenes/external-storage-load"},"next":{"title":"Synchronize data through external table","permalink":"/docs/1.2/data-operate/import/import-scenes/external-table-load"}}'),s=t("785893"),r=t("250065");let o={title:"Kafka Data Subscription",language:"en"},i="Subscribe to Kafka logs",l={},c=[{value:"Subscribe to Kafka messages",id:"subscribe-to-kafka-messages",level:2},{value:"Accessing SSL-authenticated Kafka clusters",id:"accessing-ssl-authenticated-kafka-clusters",level:3},{value:"Create a routine import job",id:"create-a-routine-import-job",level:3},{value:"View import job status",id:"view-import-job-status",level:3},{value:"Modify job properties",id:"modify-job-properties",level:3},{value:"Job Control",id:"job-control",level:3},{value:"more help",id:"more-help",level:2}];function d(e){let a={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.header,{children:(0,s.jsx)(a.h1,{id:"subscribe-to-kafka-logs",children:"Subscribe to Kafka logs"})}),"\n",(0,s.jsx)(a.p,{children:"Users can directly subscribe to message data in Kafka by submitting routine import jobs to synchronize data in near real-time."}),"\n",(0,s.jsxs)(a.p,{children:["Doris itself can ensure that messages in Kafka are subscribed without loss or weight, that is, ",(0,s.jsx)(a.code,{children:"Exactly-Once"})," consumption semantics."]}),"\n",(0,s.jsx)(a.h2,{id:"subscribe-to-kafka-messages",children:"Subscribe to Kafka messages"}),"\n",(0,s.jsx)(a.p,{children:"Subscribing to Kafka messages uses the Routine Load feature in Doris."}),"\n",(0,s.jsxs)(a.p,{children:["The user first needs to create a ",(0,s.jsx)(a.strong,{children:"routine import job"}),". The job will send a series of ",(0,s.jsx)(a.strong,{children:"tasks"})," continuously through routine scheduling, and each task will consume a certain number of messages in Kafka."]}),"\n",(0,s.jsx)(a.p,{children:"Please note the following usage restrictions:"}),"\n",(0,s.jsxs)(a.ol,{children:["\n",(0,s.jsx)(a.li,{children:"Support unauthenticated Kafka access and SSL-authenticated Kafka clusters."}),"\n",(0,s.jsxs)(a.li,{children:["The supported message formats are as follows:\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsxs)(a.li,{children:["csv text format. Each message is a line, and the end of the line ",(0,s.jsx)(a.strong,{children:"does not contain"})," a newline."]}),"\n",(0,s.jsxs)(a.li,{children:["Json format, see ",(0,s.jsx)(a.a,{href:"/docs/1.2/data-operate/import/import-way/load-json-format",children:"Import Json Format Data"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(a.li,{children:"Only supports Kafka 0.10.0.0 (inclusive) and above."}),"\n"]}),"\n",(0,s.jsx)(a.h3,{id:"accessing-ssl-authenticated-kafka-clusters",children:"Accessing SSL-authenticated Kafka clusters"}),"\n",(0,s.jsx)(a.p,{children:"The routine import feature supports unauthenticated Kafka clusters, as well as SSL-authenticated Kafka clusters."}),"\n",(0,s.jsxs)(a.p,{children:["Accessing an SSL-authenticated Kafka cluster requires the user to provide a certificate file (ca.pem) for authenticating the Kafka Broker public key. If client authentication is also enabled in the Kafka cluster, the client's public key (client.pem), key file (client.key), and key password must also be provided. The files required here need to be uploaded to Doris through the ",(0,s.jsx)(a.code,{children:"CREAE FILE"})," command, and the catalog name is ",(0,s.jsx)(a.code,{children:"kafka"}),". The specific help of the ",(0,s.jsx)(a.code,{children:"CREATE FILE"})," command can be found in the ",(0,s.jsx)(a.a,{href:"/docs/1.2/sql-manual/sql-reference/Data-Definition-Statements/Create/CREATE-FILE",children:"CREATE FILE"})," command manual . Here is an example:"]}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsxs)(a.li,{children:["\n",(0,s.jsx)(a.p,{children:"upload files"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:'CREATE FILE "ca.pem" PROPERTIES("url" = "https://example_url/kafka-key/ca.pem", "catalog" = "kafka");\nCREATE FILE "client.key" PROPERTIES("url" = "https://example_urlkafka-key/client.key", "catalog" = "kafka");\nCREATE FILE "client.pem" PROPERTIES("url" = "https://example_url/kafka-key/client.pem", "catalog" = "kafka");\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(a.p,{children:["After the upload is complete, you can view the uploaded files through the ",(0,s.jsx)(a.a,{href:"/docs/1.2/sql-manual/sql-reference/Show-Statements/SHOW-FILE",children:"SHOW FILES"})," command."]}),"\n",(0,s.jsx)(a.h3,{id:"create-a-routine-import-job",children:"Create a routine import job"}),"\n",(0,s.jsxs)(a.p,{children:["For specific commands to create routine import tasks, see ",(0,s.jsx)(a.a,{href:"/docs/1.2/sql-manual/sql-reference/Data-Manipulation-Statements/Load/CREATE-ROUTINE-LOAD",children:"ROUTINE LOAD"})," command manual. Here is an example:"]}),"\n",(0,s.jsxs)(a.ol,{children:["\n",(0,s.jsxs)(a.li,{children:["\n",(0,s.jsx)(a.p,{children:"Access the Kafka cluster without authentication"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:'CREATE ROUTINE LOAD demo.my_first_routine_load_job ON test_1\nCOLUMNS TERMINATED BY ","\nPROPERTIES\n(\n    "max_batch_interval" = "20",\n    "max_batch_rows" = "300000",\n    "max_batch_size" = "209715200",\n)\nFROM KAFKA\n(\n    "kafka_broker_list" = "broker1:9092,broker2:9092,broker3:9092",\n    "kafka_topic" = "my_topic",\n    "property.group.id" = "xxx",\n    "property.client.id" = "xxx",\n    "property.kafka_default_offsets" = "OFFSET_BEGINNING"\n);\n'})}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsxs)(a.li,{children:[(0,s.jsx)(a.code,{children:"max_batch_interval/max_batch_rows/max_batch_size"})," is used to control the running period of a subtask. The running period of a subtask is determined by the longest running time, the maximum number of rows consumed, and the maximum amount of data consumed."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(a.li,{children:["\n",(0,s.jsx)(a.p,{children:"Access an SSL-authenticated Kafka cluster"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-sql",children:'CREATE ROUTINE LOAD demo.my_first_routine_load_job ON test_1\nCOLUMNS TERMINATED BY ",",\nPROPERTIES\n(\n    "max_batch_interval" = "20",\n    "max_batch_rows" = "300000",\n    "max_batch_size" = "209715200",\n)\nFROM KAFKA\n(\n   "kafka_broker_list"= "broker1:9091,broker2:9091",\n   "kafka_topic" = "my_topic",\n   "property.security.protocol" = "ssl",\n   "property.ssl.ca.location" = "FILE:ca.pem",\n   "property.ssl.certificate.location" = "FILE:client.pem",\n   "property.ssl.key.location" = "FILE:client.key",\n   "property.ssl.key.password" = "abcdefg"\n);\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(a.h3,{id:"view-import-job-status",children:"View import job status"}),"\n",(0,s.jsxs)(a.p,{children:["See ",(0,s.jsx)(a.a,{href:"/docs/1.2/sql-manual/sql-reference/Show-Statements/SHOW-ROUTINE-LOAD",children:"SHOW ROUTINE LOAD"})," for specific commands and examples for checking the status of a ",(0,s.jsx)(a.strong,{children:"job"})," ) command documentation."]}),"\n",(0,s.jsxs)(a.p,{children:["See ",(0,s.jsx)(a.a,{href:"/docs/1.2/sql-manual/sql-reference/Show-Statements/SHOW-ROUTINE-LOAD-TASK",children:"SHOW ROUTINE LOAD TASK"})," command documentation."]}),"\n",(0,s.jsx)(a.p,{children:"Only the currently running tasks can be viewed, and the completed and unstarted tasks cannot be viewed."}),"\n",(0,s.jsx)(a.h3,{id:"modify-job-properties",children:"Modify job properties"}),"\n",(0,s.jsxs)(a.p,{children:["The user can modify some properties of the job that has been created. For details, please refer to the ",(0,s.jsx)(a.a,{href:"/docs/1.2/sql-manual/sql-reference/Data-Manipulation-Statements/Load/ALTER-ROUTINE-LOAD",children:"ALTER ROUTINE LOAD"})," command manual."]}),"\n",(0,s.jsx)(a.h3,{id:"job-control",children:"Job Control"}),"\n",(0,s.jsxs)(a.p,{children:["The user can control the stop, pause and restart of the job through the ",(0,s.jsx)(a.code,{children:"STOP/PAUSE/RESUME"})," three commands."]}),"\n",(0,s.jsxs)(a.p,{children:["For specific commands, please refer to ",(0,s.jsx)(a.a,{href:"/docs/1.2/sql-manual/sql-reference/Data-Manipulation-Statements/Load/STOP-ROUTINE-LOAD",children:"STOP ROUTINE LOAD"})," , ",(0,s.jsx)(a.a,{href:"/docs/1.2/sql-manual/sql-reference/Data-Manipulation-Statements/Load/PAUSE-ROUTINE-LOAD",children:"PAUSE ROUTINE LOAD"}),", ",(0,s.jsx)(a.a,{href:"/docs/1.2/sql-manual/sql-reference/Data-Manipulation-Statements/Load/RESUME-ROUTINE-LOAD",children:"RESUME ROUTINE LOAD"})," command documentation."]}),"\n",(0,s.jsx)(a.h2,{id:"more-help",children:"more help"}),"\n",(0,s.jsxs)(a.p,{children:["For more detailed syntax and best practices for ROUTINE LOAD, see ",(0,s.jsx)(a.a,{href:"/docs/1.2/sql-manual/sql-reference/Data-Manipulation-Statements/Load/CREATE-ROUTINE-LOAD",children:"ROUTINE LOAD"})," command manual."]})]})}function h(e={}){let{wrapper:a}={...(0,r.a)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},250065:function(e,a,t){t.d(a,{Z:function(){return i},a:function(){return o}});var n=t(667294);let s={},r=n.createContext(s);function o(e){let a=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function i(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(r.Provider,{value:a},e.children)}}}]);