"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["546978"],{846927:function(e,t,n){n.r(t),n.d(t,{metadata:()=>s,contentTitle:()=>c,default:()=>d,assets:()=>i,toc:()=>l,frontMatter:()=>u});var s=JSON.parse('{"id":"compute-storage-decoupled/managing-compute-cluster","title":"Managing Compute Groups","description":"\x3c!--","source":"@site/versioned_docs/version-3.0/compute-storage-decoupled/managing-compute-cluster.md","sourceDirName":"compute-storage-decoupled","slug":"/compute-storage-decoupled/managing-compute-cluster","permalink":"/docs/3.0/compute-storage-decoupled/managing-compute-cluster","draft":false,"unlisted":false,"tags":[],"version":"3.0","frontMatter":{"title":"Managing Compute Groups","language":"en"},"sidebar":"docs","previous":{"title":"Managing Storage Vault","permalink":"/docs/3.0/compute-storage-decoupled/managing-storage-vault"},"next":{"title":"File Cache","permalink":"/docs/3.0/compute-storage-decoupled/file-cache"}}'),o=n("785893"),r=n("250065");let u={title:"Managing Compute Groups",language:"en"},c=void 0,i={},l=[{value:"Viewing All Compute Groups",id:"viewing-all-compute-groups",level:2},{value:"Adding Compute Groups",id:"adding-compute-groups",level:2},{value:"Granting Compute Group Access",id:"granting-compute-group-access",level:2},{value:"Revoking Compute Group Access",id:"revoking-compute-group-access",level:2},{value:"Setting Default Compute Group",id:"setting-default-compute-group",level:2},{value:"Default Compute Group Selection Mechanism",id:"default-compute-group-selection-mechanism",level:2},{value:"Switching Compute Groups",id:"switching-compute-groups",level:2},{value:"Scaling Compute Groups",id:"scaling-compute-groups",level:2}];function a(e){let t={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.p,{children:"In a compute-storage decoupled architecture, one or more compute nodes (BE) can be grouped into a Compute Group. This document describes how to use compute groups, including operations such as:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Viewing all compute groups"}),"\n",(0,o.jsx)(t.li,{children:"Granting compute group access"}),"\n",(0,o.jsxs)(t.li,{children:["Binding compute groups at the user level (",(0,o.jsx)(t.code,{children:"default_compute_group"}),") for user-level isolation"]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.em,{children:"Note"}),"\nIn versions prior to 3.0.2, this was referred to as a Compute Cluster."]}),"\n",(0,o.jsx)(t.h2,{id:"viewing-all-compute-groups",children:"Viewing All Compute Groups"}),"\n",(0,o.jsxs)(t.p,{children:["You can view all compute groups owned by the current repository using ",(0,o.jsx)(t.code,{children:"SHOW COMPUTE GROUPS"}),"."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"SHOW COMPUTE GROUPS;\n"})}),"\n",(0,o.jsx)(t.h2,{id:"adding-compute-groups",children:"Adding Compute Groups"}),"\n",(0,o.jsxs)(t.p,{children:["Using ",(0,o.jsx)(t.a,{href:"/docs/3.0/sql-manual/sql-statements/cluster-management/instance-management/ADD-BACKEND",children:"Add BE "})," to add a BE into a compute group, for example:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:'ALTER SYSTEM ADD BACKEND \'host:9050\' PROPERTIES ("tag.compute_group_name" = "new_group");\n'})}),"\n",(0,o.jsxs)(t.p,{children:["The above sql will add ",(0,o.jsx)(t.code,{children:"host:9050"})," to compute group ",(0,o.jsx)(t.code,{children:"new_group"}),". The BE will be added to compute group ",(0,o.jsx)(t.code,{children:"default_compute_group"})," if you omit PROPERTIES statement, for example:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"ALTER SYSTEM ADD BACKEND 'host:9050';\n"})}),"\n",(0,o.jsx)(t.h2,{id:"granting-compute-group-access",children:"Granting Compute Group Access"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"GRANT USAGE_PRIV ON COMPUTE GROUP {compute_group_name} TO {user}\n"})}),"\n",(0,o.jsx)(t.h2,{id:"revoking-compute-group-access",children:"Revoking Compute Group Access"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"REVOKE USAGE_PRIV ON COMPUTE GROUP {compute_group_name} FROM {user}\n"})}),"\n",(0,o.jsx)(t.h2,{id:"setting-default-compute-group",children:"Setting Default Compute Group"}),"\n",(0,o.jsx)(t.p,{children:"To set the default compute group for the current user:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"SET PROPERTY 'default_compute_group' = '{clusterName}';\n"})}),"\n",(0,o.jsx)(t.p,{children:"To set the default compute group for other users (this operation requires Admin privileges):"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"SET PROPERTY FOR {user} 'default_compute_group' = '{clusterName}';\n"})}),"\n",(0,o.jsxs)(t.p,{children:["To view the current user's default compute group, the value of ",(0,o.jsx)(t.code,{children:"default_compute_group"})," in the returned result is the default compute group:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"SHOW PROPERTY;\n"})}),"\n",(0,o.jsxs)(t.p,{children:["To view the default compute group of other users, this operation requires the current user to have relevant permissions, and the value of ",(0,o.jsx)(t.code,{children:"default_compute_group"})," in the returned result is the default compute group:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"SHOW PROPERTY FOR {user};\n"})}),"\n",(0,o.jsx)(t.p,{children:"To view all available compute groups in the current repository:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"SHOW COMPUTE GROUPS;\n"})}),"\n",(0,o.jsx)(t.admonition,{title:"Note",type:"info",children:(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["If the current user has an Admin role, for example: ",(0,o.jsx)(t.code,{children:"CREATE USER jack IDENTIFIED BY '123456' DEFAULT ROLE \"admin\""}),", then:\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"They can set the default compute group for themselves and other users;"}),"\n",(0,o.jsxs)(t.li,{children:["They can view their own and other users' ",(0,o.jsx)(t.code,{children:"PROPERTY"}),"."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["If the current user does not have an Admin role, for example: ",(0,o.jsx)(t.code,{children:"CREATE USER jack1 IDENTIFIED BY '123456'"}),", then:\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"They can set the default compute group for themselves;"}),"\n",(0,o.jsxs)(t.li,{children:["They can view their own ",(0,o.jsx)(t.code,{children:"PROPERTY"}),";"]}),"\n",(0,o.jsxs)(t.li,{children:["They cannot view all compute groups, as this operation requires ",(0,o.jsx)(t.code,{children:"GRANT ADMIN"})," privileges."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.li,{children:["If the current user has not configured a default compute group, the existing system will trigger an error when performing data read/write operations. To resolve this issue, the user can execute the ",(0,o.jsx)(t.code,{children:"use @cluster"})," command to specify the compute group used by the current context, or use the ",(0,o.jsx)(t.code,{children:"SET PROPERTY"})," statement to set the default compute group."]}),"\n",(0,o.jsxs)(t.li,{children:["If the current user has configured a default compute group, but that cluster is subsequently deleted, an error will also be triggered during data read/write operations. The user can execute the ",(0,o.jsx)(t.code,{children:"use @cluster"})," command to re-specify the compute group used by the current context, or use the ",(0,o.jsx)(t.code,{children:"SET PROPERTY"})," statement to update the default cluster settings."]}),"\n"]})}),"\n",(0,o.jsx)(t.h2,{id:"default-compute-group-selection-mechanism",children:"Default Compute Group Selection Mechanism"}),"\n",(0,o.jsx)(t.p,{children:"When a user has not explicitly set a default compute group, the system will automatically select a compute group with Active BE that the user has usage permissions for. Once the default compute group is determined in a specific session, it will remain unchanged during that session unless the user explicitly changes the default setting."}),"\n",(0,o.jsx)(t.p,{children:"In different sessions, if the following situations occur, the system may automatically change the user's default compute group:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"The user has lost usage permissions for the default compute group selected in the last session"}),"\n",(0,o.jsx)(t.li,{children:"A compute group has been added or removed"}),"\n",(0,o.jsx)(t.li,{children:"The previously selected default compute group no longer has Active BE"}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"Situations one and two will definitely lead to a change in the automatically selected default compute group, while situation three may lead to a change."}),"\n",(0,o.jsx)(t.h2,{id:"switching-compute-groups",children:"Switching Compute Groups"}),"\n",(0,o.jsx)(t.p,{children:"Users can specify the database and compute group to use in a compute-storage decoupled architecture."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.strong,{children:"Syntax"})}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-sql",children:"USE { [catalog_name.]database_name[@compute_group_name] | @compute_group_name }\n"})}),"\n",(0,o.jsx)(t.p,{children:"If the database or compute group name contains reserved keywords, the corresponding name must be enclosed in backticks ```."}),"\n",(0,o.jsx)(t.h2,{id:"scaling-compute-groups",children:"Scaling Compute Groups"}),"\n",(0,o.jsxs)(t.p,{children:["You can scale compute groups by adding or removing BE using ",(0,o.jsx)(t.code,{children:"ALTER SYSTEM ADD BACKEND"})," and ",(0,o.jsx)(t.code,{children:"ALTER SYSTEM DECOMMISION BACKEND"}),"."]})]})}function d(e={}){let{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},250065:function(e,t,n){n.d(t,{Z:function(){return c},a:function(){return u}});var s=n(667294);let o={},r=s.createContext(o);function u(e){let t=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:u(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);