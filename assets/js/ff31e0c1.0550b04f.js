"use strict";(self.webpackChunkdoris_website=self.webpackChunkdoris_website||[]).push([["419173"],{907677:function(n,e,i){i.r(e),i.d(e,{metadata:()=>l,contentTitle:()=>o,default:()=>h,assets:()=>a,toc:()=>d,frontMatter:()=>t});var l=JSON.parse('{"id":"install/source-install/compilation-arm","title":"Compilation With Arm","description":"\x3c!--","source":"@site/versioned_docs/version-1.2/install/source-install/compilation-arm.md","sourceDirName":"install/source-install","slug":"/install/source-install/compilation-arm","permalink":"/docs/1.2/install/source-install/compilation-arm","draft":false,"unlisted":false,"tags":[],"version":"1.2","frontMatter":{"title":"Compilation With Arm","language":"en"},"sidebar":"docs","previous":{"title":"Compiling with LDB toolchain","permalink":"/docs/1.2/install/source-install/compilation-with-ldb-toolchain"},"next":{"title":"Compilation on Windows","permalink":"/docs/1.2/install/source-install/compilation-win"}}'),s=i("785893"),r=i("250065");let t={title:"Compilation With Arm",language:"en"},o="Compile With ARM",a={},d=[{value:"KylinOS",id:"kylinos",level:2},{value:"Software and Hardware Environment",id:"software-and-hardware-environment",level:3},{value:"Compile With ldb-toolchain",id:"compile-with-ldb-toolchain",level:3},{value:"CentOS &amp; Ubuntu",id:"centos--ubuntu",level:2},{value:"Hardware Environment",id:"hardware-environment",level:3},{value:"Software Environment",id:"software-environment",level:3},{value:"Software Environment List",id:"software-environment-list",level:4},{value:"Software Environment Installation Command",id:"software-environment-installation-command",level:4},{value:"CentOS 8.4",id:"centos-84",level:5},{value:"Ubuntu 20.04",id:"ubuntu-2004",level:5},{value:"Download Source Code",id:"download-source-code",level:4},{value:"Install and Deploy",id:"install-and-deploy",level:4},{value:"Check if the AVX2 instruction set is supported",id:"check-if-the-avx2-instruction-set-is-supported",level:5},{value:"Execute compilation",id:"execute-compilation",level:5},{value:"FAQ",id:"faq",level:3}];function c(n){let e={a:"a",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"compile-with-arm",children:"Compile With ARM"})}),"\n",(0,s.jsx)(e.p,{children:"This topic is about how to compile Doris on the ARM64 platform."}),"\n",(0,s.jsx)(e.p,{children:"Note that this is for reference only. Other errors may occur when compiling in different environments."}),"\n",(0,s.jsx)(e.h2,{id:"kylinos",children:"KylinOS"}),"\n",(0,s.jsx)(e.h3,{id:"software-and-hardware-environment",children:"Software and Hardware Environment"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"KylinOS Version\uFF1A"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"$> cat /etc/.kyinfo\nname=Kylin-Server\nmilestone=10-SP1-Release-Build04-20200711\narch=arm64\nbeta=False\ntime=2020-07-11 17:16:54\ndist_id=Kylin-Server-10-SP1-Release-Build04-20200711-arm64-2020-07-11 17:16:54\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"CPU Model:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"$> cat /proc/cpuinfo\nmodel name  : Phytium,FT-2000+/64\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"compile-with-ldb-toolchain",children:"Compile With ldb-toolchain"}),"\n",(0,s.jsxs)(e.p,{children:["This method works for Doris versions after ",(0,s.jsx)(e.a,{href:"https://github.com/apache/doris/commit/7f3564cca62de49c9f2ea67fcf735921dbebb4d1",children:"commit 7f3564"}),"."]}),"\n",(0,s.jsxs)(e.p,{children:["Download ",(0,s.jsx)(e.a,{href:"https://github.com/amosbird/ldb_toolchain_gen/releases/download/v0.9.1/ldb_toolchain_gen.aarch64.sh",children:"ldb_toolchain_gen.aarch64.sh"})]}),"\n",(0,s.jsxs)(e.p,{children:["For detailed instructions, please refer to ",(0,s.jsx)(e.a,{href:"/docs/1.2/install/source-install/compilation-with-ldb-toolchain",children:"Compile with ldb-toolchain"})]}),"\n",(0,s.jsx)(e.p,{children:"Note that you need to download the corresponding aarch64 versions of jdk and nodejs:"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://doris-thirdparty-repo.bj.bcebos.com/thirdparty/jdk-8u291-linux-aarch64.tar.gz",children:"Java8-aarch64"})}),"\n",(0,s.jsx)(e.li,{children:(0,s.jsx)(e.a,{href:"https://doris-thirdparty-repo.bj.bcebos.com/thirdparty/node-v16.3.0-linux-arm64.tar.xz",children:"Node v12.13.0-aarch64"})}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"centos--ubuntu",children:"CentOS & Ubuntu"}),"\n",(0,s.jsx)(e.h3,{id:"hardware-environment",children:"Hardware Environment"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"System Version: CentOS 8.4, Ubuntu 20.04"}),"\n",(0,s.jsx)(e.li,{children:"System Architecture: ARM X64"}),"\n",(0,s.jsx)(e.li,{children:"CPU: 4C"}),"\n",(0,s.jsx)(e.li,{children:"Memory: 16 GB"}),"\n",(0,s.jsx)(e.li,{children:"Hard Disk: 40GB (SSD), 100GB (SSD)"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"software-environment",children:"Software Environment"}),"\n",(0,s.jsx)(e.h4,{id:"software-environment-list",children:"Software Environment List"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"Component Name"}),(0,s.jsx)(e.th,{children:"Component Version"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Git"}),(0,s.jsx)(e.td,{children:"2.0+"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"JDK"}),(0,s.jsx)(e.td,{children:"1.8.0"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Maven"}),(0,s.jsx)(e.td,{children:"3.6.3"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"NodeJS"}),(0,s.jsx)(e.td,{children:"16.3.0"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"LDB-Toolchain"}),(0,s.jsx)(e.td,{children:"0.9.1"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsxs)(e.td,{children:["Commonly Used Components",(0,s.jsx)(e.br,{}),"byacc",(0,s.jsx)(e.br,{}),"patch",(0,s.jsx)(e.br,{}),"automake",(0,s.jsx)(e.br,{}),"libtool",(0,s.jsx)(e.br,{}),"make",(0,s.jsx)(e.br,{}),"which",(0,s.jsx)(e.br,{}),"file",(0,s.jsx)(e.br,{}),"ncurses-devel",(0,s.jsx)(e.br,{}),"gettext-devel",(0,s.jsx)(e.br,{}),"unzip",(0,s.jsx)(e.br,{}),"bzip2",(0,s.jsx)(e.br,{}),"zip",(0,s.jsx)(e.br,{}),"util-linux",(0,s.jsx)(e.br,{}),"wget",(0,s.jsx)(e.br,{}),"git",(0,s.jsx)(e.br,{}),"python2"]}),(0,s.jsx)(e.td,{children:"yum install or apt-get install"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"autoconf"}),(0,s.jsx)(e.td,{children:"2.69"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"bison"}),(0,s.jsx)(e.td,{children:"3.0.4"})]})]})]}),"\n",(0,s.jsx)(e.h4,{id:"software-environment-installation-command",children:"Software Environment Installation Command"}),"\n",(0,s.jsx)(e.h5,{id:"centos-84",children:"CentOS 8.4"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Create root directories"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# Create root directory for software download and installation packages\nmkdir /opt/tools\n# Create root directory for software installation\nmkdir /opt/software\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Git"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# yum install (save the trouble of compilation)\nyum install -y git\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"JDK8 (2 methods)"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# 1. yum install, which can avoid additional download and configuration. Installing the devel package is to get tools such as the jps command.\nyum install -y java-1.8.0-openjdk java-1.8.0-openjdk-devel\n\n# 2. Download the installation package of the arm64 architecture, decompress it, and configure the environment variables.\ncd /opt/tools\nwget https://doris-thirdparty-repo.bj.bcebos.com/thirdparty/jdk-8u291-linux-aarch64.tar.gz && \\\ntar -zxvf jdk-8u291-linux-aarch64.tar.gz && \\\nmv jdk1.8.0_291 /opt/software/jdk8\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Maven"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"cd /opt/tools\n# Download the wget tool, decompress it, and configure the environment variables.\nwget https://dlcdn.apache.org/maven/maven-3/3.6.3/binaries/apache-maven-3.6.3-bin.tar.gz && \\\ntar -zxvf apache-maven-3.6.3-bin.tar.gz && \\\nmv apache-maven-3.6.3 /opt/software/maven\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"NodeJS"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"cd /opt/tools\n# Download the installation package of the arm64 architecture\nwget https://doris-thirdparty-repo.bj.bcebos.com/thirdparty/node-v16.3.0-linux-arm64.tar.xz && \\\ntar -xvf node-v16.3.0-linux-arm64.tar.xz && \\\nmv node-v16.3.0-linux-arm64 /opt/software/nodejs\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"ldb-toolchain"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"cd /opt/tools\n# Download ldb-toolchain ARM version\nwget https://github.com/amosbird/ldb_toolchain_gen/releases/download/v0.9.1/ldb_toolchain_gen.aarch64.sh && \\\nsh ldb_toolchain_gen.aarch64.sh /opt/software/ldb_toolchain/\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Configure environment variables"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:'# Configure environment variables\nvim /etc/profile.d/doris.sh\nexport JAVA_HOME=/opt/software/jdk8\nexport MAVEN_HOME=/opt/software/maven\nexport NODE_JS_HOME=/opt/software/nodejs\nexport LDB_HOME=/opt/software/ldb_toolchain\nexport PATH=$JAVA_HOME/bin:$MAVEN_HOME/bin:$NODE_JS_HOME/bin:$LDB_HOME/bin:$PATH\n\n# Save, exit, and refresh environment variables\nsource /etc/profile.d/doris.sh\n\n# Test\njava -version\n> java version "1.8.0_291"\nmvn -version\n> Apache Maven 3.6.3\nnode --version\n> v16.3.0\ngcc --version\n> gcc-11\n'})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Install other environments and components"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# Install required system packages\nsudo yum install -y byacc patch automake libtool make which file ncurses-devel gettext-devel unzip bzip2 bison zip util-linux wget git python2\n\n# Install autoconf-2.69\ncd /opt/tools\nwget http://ftp.gnu.org/gnu/autoconf/autoconf-2.69.tar.gz && \\\n    tar zxf autoconf-2.69.tar.gz && \\\n    mv autoconf-2.69 /opt/software/autoconf && \\\n    cd /opt/software/autoconf && \\\n    ./configure && \\\n    make && \\\n    make install\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h5,{id:"ubuntu-2004",children:"Ubuntu 20.04"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Update apt-get repository"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"apt-get update\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Check the shell command set"}),"\n",(0,s.jsx)(e.p,{children:"The Ubuntu shell installs dash instead of bash by default. It needs to be switched to bash for proper execution. Run the following command to view the details of sh and confirm which program corresponds to the shell:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"ls -al /bin/sh\n"})}),"\n",(0,s.jsx)(e.p,{children:"The shell can be switched back to bash by:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"sudo dpkg-reconfigure dash\n"})}),"\n",(0,s.jsx)(e.p,{children:"Then select no to confirm."}),"\n",(0,s.jsx)(e.p,{children:"After these steps, dash will no longer be the default shell tool."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Create root directories"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# Create root directory for software download and installation packages\nmkdir /opt/tools\n# Create root directory for software installation\nmkdir /opt/software\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Git"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# apt-get install, which can save the trouble of compilation\napt-get -y install git\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"JDK8"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# Download the installation package of the ARM64 architecture, decompress it, and configure environment variables.\ncd /opt/tools\nwget https://doris-thirdparty-repo.bj.bcebos.com/thirdparty/jdk-8u291-linux-aarch64.tar.gz && \\\ntar -zxvf jdk-8u291-linux-aarch64.tar.gz && \\\nmv jdk1.8.0_291 /opt/software/jdk8\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Maven"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"cd /opt/tools\n# Download the wget tool, decompress it, and configure the environment variables.\nwget https://dlcdn.apache.org/maven/maven-3/3.6.3/binaries/apache-maven-3.6.3-bin.tar.gz && \\\ntar -zxvf apache-maven-3.6.3-bin.tar.gz && \\\nmv apache-maven-3.6.3 /opt/software/maven\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"NodeJS"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"cd /opt/tools\n# Download the installation package of ARM64 architecture.\nwget https://doris-thirdparty-repo.bj.bcebos.com/thirdparty/node-v16.3.0-linux-arm64.tar.xz && \\\ntar -xvf node-v16.3.0-linux-arm64.tar.xz && \\\nmv node-v16.3.0-linux-arm64 /opt/software/nodejs\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"ldb-toolchain"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"cd /opt/tools\n# Download ldb-toolchain ARM version\nwget https://github.com/amosbird/ldb_toolchain_gen/releases/download/v0.9.1/ldb_toolchain_gen.aarch64.sh && \\\nsh ldb_toolchain_gen.aarch64.sh /opt/software/ldb_toolchain/\n"})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Configure environment variables"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:'# Configure environment variables\nvim /etc/profile.d/doris.sh\nexport JAVA_HOME=/opt/software/jdk8\nexport MAVEN_HOME=/opt/software/maven\nexport NODE_JS_HOME=/opt/software/nodejs\nexport LDB_HOME=/opt/software/ldb_toolchain\nexport PATH=$JAVA_HOME/bin:$MAVEN_HOME/bin:$NODE_JS_HOME/bin:$LDB_HOME/bin:$PATH\n\n# Save, exit, and refresh environment variables\nsource /etc/profile.d/doris.sh\n\n# Test\njava -version\n> java version "1.8.0_291"\nmvn -version\n> Apache Maven 3.6.3\nnode --version\n> v16.3.0\ngcc --version\n   > gcc-11\n'})}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Install other environments and components"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# Install required system packages\nsudo apt install -y build-essential cmake flex automake bison binutils-dev libiberty-dev zip libncurses5-dev curl ninja-build\nsudo apt-get install -y make\nsudo apt-get install -y unzip\nsudo apt-get install -y python2\nsudo apt-get install -y byacc\nsudo apt-get install -y automake\nsudo apt-get install -y libtool\nsudo apt-get install -y bzip2\nsudo add-apt-repository ppa:ubuntu-toolchain-r/ppa\nsudo apt update\nsudo apt install gcc-11 g++-11\nsudo apt-get -y install autoconf autopoint\n\n# Install autoconf-2.69\ncd /opt/tools\nwget http://ftp.gnu.org/gnu/autoconf/autoconf-2.69.tar.gz && \\\n    tar zxf autoconf-2.69.tar.gz && \\\n    mv autoconf-2.69 /opt/software/autoconf && \\\n    cd /opt/software/autoconf && \\\n    ./configure && \\\n    make && \\\n    make install\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(e.h4,{id:"download-source-code",children:"Download Source Code"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"cd /opt\ngit clone https://github.com/apache/doris.git\n"})}),"\n",(0,s.jsx)(e.h4,{id:"install-and-deploy",children:"Install and Deploy"}),"\n",(0,s.jsx)(e.h5,{id:"check-if-the-avx2-instruction-set-is-supported",children:"Check if the AVX2 instruction set is supported"}),"\n",(0,s.jsx)(e.p,{children:"If there is data returned, that means AVX2 is supported; otherwise, AVX2 is not supported."}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"cat /proc/cpuinfo | grep avx2\n"})}),"\n",(0,s.jsx)(e.h5,{id:"execute-compilation",children:"Execute compilation"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# For machines that support the AVX2 instruction set, compile directly\nsh build.sh\n# For machines that do not support the AVX2 instruction set, use the following command to compile\nUSE_AVX2=OFF sh build.sh\n"})}),"\n",(0,s.jsx)(e.h3,{id:"faq",children:"FAQ"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"File not found when compiling the third-party library libhdfs3.a."}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Problem Description"}),"\n",(0,s.jsx)(e.p,{children:"During the compilation and installation process, the following error occurrs:"}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"not found lib/libhdfs3.a file or directory"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Cause"}),"\n",(0,s.jsx)(e.p,{children:"The third-party library dependency is improperly downloaded."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Solution"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Use a third-party download repository"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"export REPOSITORY_URL=https://doris-thirdparty-repo.bj.bcebos.com/thirdparty\nsh /opt/doris/thirdparty/build-thirdparty.sh\n"})}),"\n",(0,s.jsx)(e.p,{children:"REPOSITORY_URL contains all third-party library source packages and their historical versions."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"python command not found"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Problem Description"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"An exception is thrown when executing build.sh"}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"/opt/doris/env.sh: line 46: python: command not found"}),"\n",(0,s.jsx)(e.p,{children:"Python 2.7.18"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Cause"}),"\n",(0,s.jsxs)(e.p,{children:["The system uses ",(0,s.jsx)(e.code,{children:"python2.7"}),", ",(0,s.jsx)(e.code,{children:"python3.6"}),", ",(0,s.jsx)(e.code,{children:"python2"}),", ",(0,s.jsx)(e.code,{children:"python3"})," by default to execute python commands. Doris only requires python 2.7+ to install dependencies, so you just need to add a command  ",(0,s.jsx)(e.code,{children:"python"})," to connect."]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Solution"}),"\n",(0,s.jsxs)(e.p,{children:["Establish a soft link to the ",(0,s.jsx)(e.code,{children:"python"})," command in ",(0,s.jsx)(e.code,{children:"\\usr\\bin"})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# View python installation directory\nwhereis python\n# Establish soft connection\nsudo ln -s /usr/bin/python2.7 /usr/bin/python\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"There is no output directory after compilation"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Problem Description"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Cannot find the output folder in the directory after the execution of build.sh."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Cause"}),"\n",(0,s.jsx)(e.p,{children:"Compilation fails. Try again."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Solution"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"sh build.sh --clean\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"spark-dpp compilation fails"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Problem Description"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"After compiling build.sh, compiling to Spark-DPP fails with an error"}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Failed to execute goal on project spark-dpp"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Cause"}),"\n",(0,s.jsxs)(e.p,{children:["This error message is caused by download failure (connection to the ",(0,s.jsx)(e.code,{children:"repo.maven.apache.org"})," central repository fails)."]}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsxs)(e.p,{children:["Could not transfer artifact org.apache.spark:spark-sql_2.12:jar:2.4.6 from/to central (",(0,s.jsx)(e.a,{href:"https://repo.maven.apache.org/maven2",children:"https://repo.maven.apache.org/maven2"}),"): Transfer failed for ",(0,s.jsx)(e.a,{href:"https://repo",children:"https://repo"})," .maven.apache.org/maven2/org/apache/spark/spark-sql_2.12/2.4.6/spark-sql_2.12-2.4.6.jar: Unknown host repo.maven.apache.org"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Solution"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Rebuild"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"No space left, compilation fails"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Problem Description"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Failed to build CXX object during compilation, error message showing no space left"}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"fatal error: error writing to /tmp/ccKn4nPK.s: No space left on device\n1112 | } // namespace doris::vectorized\ncompilation terminated."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Cause"}),"\n",(0,s.jsx)(e.p,{children:"Insufficient free space on the device"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Solution"}),"\n",(0,s.jsx)(e.p,{children:"Expand the free space on the device by deleting files you don't need, etc."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Failed to start FE, transaction error -20"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Problem Description"}),"\n",(0,s.jsx)(e.p,{children:"When starting FE, a transaction error 20 is reported with UNKNOWN status."}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"[BDBEnvironment.setup():198] error to open replicated environment. will exit.\ncom.sleepycat.je.rep.ReplicaWriteException: (JE 18.3.12) Problem closing transaction 20. The current state is:UNKNOWN. The node transitioned to this state at:Fri Apr 22 12:48:08 CST 2022"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Cause"}),"\n",(0,s.jsx)(e.p,{children:"Insufficient hard disk space"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Solution"}),"\n",(0,s.jsx)(e.p,{children:"Free up hard disk space or mount a new hard disk"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Abnormal BDB environment setting, disk search error"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Problem Description"}),"\n",(0,s.jsx)(e.p,{children:"An exception is reported when starting FE after migrating the drive letter where FE is located"}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"2022-04-22 16:21:44,092 ERROR (MASTER 172.28.7.231_9010_1650606822109(-1)|1) [BDBJEJournal.open():306] catch an exception when setup bdb environment. will exit.\ncom.sleepycat.je.DiskLimitException: (JE 18.3.12) Disk usage is not within je.maxDisk or je.freeDisk limits and write operations are prohibited: maxDiskLimit=0 freeDiskLimit=5,368,709,120 adjustedMaxDiskLimit=0 maxDiskOverage=0 freeDiskShortage=1,536,552,960 diskFreeSpace =3,832,156,160 availableLogSize=-1,536,552,960 totalLogSize=4,665 activeLogSize=4,665 reservedLogSize=0 protectedLogSize=0 protectedLogSizeMap={}"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Cause"}),"\n",(0,s.jsx)(e.p,{children:"FE has been migrated to another location, which doesn't match the hard disk information stored in the metadata; or the hard disk is damaged or not mounted"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Solution"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Check if the hard disk is normal, initialized and mounted correctly"}),"\n",(0,s.jsx)(e.li,{children:"Fix FE metadata"}),"\n",(0,s.jsx)(e.li,{children:"If it is a test machine, you can delete the metadata directory and restart"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Could not find pkg.m4 file in pkg.config"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Problem Description"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:'A "file not found" error occurrs during compilation:'}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"Couldn't find pkg.m4 from pkg-config. Install the appropriate package for your distribution or set ACLOCAL_PATH to the directory containing pkg.m4."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Cause"}),"\n",(0,s.jsxs)(e.p,{children:["There is something wrong with the compilation of the third-party library ",(0,s.jsx)(e.code,{children:"libxml2"})," ."]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.em,{children:(0,s.jsx)(e.strong,{children:"Possible Reasons:"})})}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"An exception occurs when the Ubuntu system loads the environment variables so the index under the ldb directory is not successfully loaded."}),"\n",(0,s.jsx)(e.li,{children:"The retrieval of environment variables during libxml2 compilation fails, so the ldb/aclocal directory is not retrieved."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Solution"}),"\n",(0,s.jsxs)(e.p,{children:["Copy the ",(0,s.jsx)(e.code,{children:"pkg.m4"})," file in the ldb/aclocal directory into the libxml2/m4 directory, and recompile the third-party library."]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"cp /opt/software/ldb_toolchain/share/aclocal/pkg.m4 /opt/incubator-doris/thirdparty/src/libxml2-v2.9.10/m4\nsh /opt/incubator-doris/thirdparty/build-thirdparty.sh\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Failed to execute test CURL_HAS_TLS_PROXY"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Problem Description"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"An error is reported during the compilation process of the third-party package:"}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:'-- Performing Test CURL_HAS_TLS_PROXY - Failed\nCMake Error at cmake/dependencies.cmake:15 (get_property):\nINTERFACE_LIBRARY targets may only have whitelisted properties. The\nproperty "LINK_LIBRARIES_ALL" is not allowed.'}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsxs)(e.p,{children:["The log shows: curl ",(0,s.jsx)(e.code,{children:"No such file or directory"})]}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"fatal error: curl/curl.h: No such file or directory\n2 | #include <curl/curl.h>\ncompilation terminated.\nninja: build stopped: subcommand failed."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Cause"}),"\n",(0,s.jsx)(e.p,{children:"There is an error in the compilation environment. The gcc is of version 9.3.0 that comes with the system, so it is not compiled with ldb, so you need to configure the ldb environment variable."}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Solution"}),"\n",(0,s.jsx)(e.p,{children:"Configure ldb environment variables"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-shell",children:"# Configure environment variables\nvim /etc/profile.d/ldb.sh\nexport LDB_HOME=/opt/software/ldb_toolchain\nexport PATH=$LDB_HOME/bin:$PATH\n# Save, exit, and refresh environment variables\nsource /etc/profile.d/ldb.sh\n# Test\ngcc --version\n> gcc-11\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Other problems"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Problem Description"}),"\n",(0,s.jsx)(e.p,{children:"The follow error prompts are all due to one root cause."}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["bison related\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"fseterr.c error when installing bison-3.0.4"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["flex related\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"flex command not found"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["cmake related\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"cmake command not found"}),"\n",(0,s.jsx)(e.li,{children:"cmake cannot find the dependent library"}),"\n",(0,s.jsx)(e.li,{children:"cmake cannot find CMAKE_ROOT"}),"\n",(0,s.jsx)(e.li,{children:"Compiler set not found in cmake environment variable CXX"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["boost related\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Boost.Build build engine failed"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["mysql related\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"Could not find mysql client dependency a file"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["gcc related\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"GCC version requires 11+"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Cause"}),"\n",(0,s.jsx)(e.p,{children:"Not compiled with ldb-toolschain"}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:["\n",(0,s.jsx)(e.p,{children:"Solution"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"Check if the ldb-toolschain environment variable is configured"}),"\n",(0,s.jsxs)(e.li,{children:["Check if gcc version is ",(0,s.jsx)(e.code,{children:"gcc-11"})]}),"\n",(0,s.jsxs)(e.li,{children:["Delete the ldb directory after the ",(0,s.jsx)(e.code,{children:"ldb-toolschain.sh"})," script is executed, re-execute and configure the environment variables, and verify the gcc version"]}),"\n"]}),"\n"]}),"\n"]})]})}function h(n={}){let{wrapper:e}={...(0,r.a)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(c,{...n})}):c(n)}},250065:function(n,e,i){i.d(e,{Z:function(){return o},a:function(){return t}});var l=i(667294);let s={},r=l.createContext(s);function t(n){let e=l.useContext(r);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:t(n.components),l.createElement(r.Provider,{value:e},n.children)}}}]);